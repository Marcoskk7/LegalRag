"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[519],{21889:function($t,Se,g){var se=g(75271),fe=g(86678),Ue=g(60606),ye=g(50165),O=g(52676);var Pe=function(de){var w=de.index,K=(0,se.useRef)(null),j=100,he=[5195493,12951641,16777215,9647082],X=(0,se.useMemo)(function(){return he[Math.floor(Math.random()*he.length)]},[]),k=(0,se.useMemo)(function(){return Math.random()*.4+.1},[]),ge=(0,se.useMemo)(function(){return{offset:Math.random()*100,speed:Math.random()*.005+.002,radius:Math.random()*4+2,freq:Math.random()*.5+.2}},[]),Ee=(0,se.useMemo)(function(){return new Float32Array(j*3)},[]),Z=(0,se.useRef)(null);return(0,fe.F)(function(Ce){if(K.current&&Z.current){for(var Ye=Ce.clock.getElapsedTime()*10,Ve=ge.offset,Me=ge.speed,Te=ge.radius,Qe=ge.freq,te=Ye*Me+Ve,Ne=Z.current.attributes.position.array,b=0;b<j;b++){var re=b/j,Be=re*Math.PI*2+te,Je=Math.cos(Be)*Te+Math.sin(te*.5+w)*2,Ze=Math.sin(Be*Qe)*(Te*.5)+Math.cos(te+w)*1,qe=Math.sin(Be+te)*2-re*5;Ne[b*3]=Je,Ne[b*3+1]=Ze,Ne[b*3+2]=qe}Z.current.attributes.position.needsUpdate=!0,K.current.rotation.z+=.001,K.current.rotation.y+=5e-4}}),(0,O.jsxs)("line",{ref:K,children:[(0,O.jsx)("bufferGeometry",{ref:Z,children:(0,O.jsx)("bufferAttribute",{attach:"attributes-position",args:[Ee,3]})}),(0,O.jsx)("lineBasicMaterial",{color:X,transparent:!0,opacity:k,blending:ye.AdditiveBlending})]})},Ke=function(){var de=40,w=(0,se.useMemo)(function(){return Array.from({length:de},function(K,j){return j})},[]);return(0,O.jsx)(O.Fragment,{children:w.map(function(K){return(0,O.jsx)(Pe,{index:K},K)})})},Re=function(){var de=(0,fe.D)(),w=de.camera,K=de.pointer;return(0,fe.F)(function(){var j=K.x*2,he=-K.y*2;w.position.x+=(j-w.position.x)*.05,w.position.y+=(he-w.position.y)*.05,w.lookAt(0,0,0)}),null},Xe=function(){return(0,O.jsx)("div",{className:"absolute inset-0 z-0 bg-[#020617]",children:(0,O.jsxs)(Ue.Xz,{camera:{position:[0,0,10],fov:45},dpr:[1,2],children:[(0,O.jsx)("ambientLight",{intensity:.5}),(0,O.jsx)(Ke,{}),(0,O.jsx)(Re,{})]})})};Se.Z=Xe},85166:function($t,Se,g){g.r(Se),g.d(Se,{default:function(){return Kt}});var se=g(15558),fe=g.n(se),Ue=g(335),ye=g.n(Ue),O=g(82092),Pe=g.n(O),Ke=g(26068),Re=g.n(Ke),Xe=g(90228),y=g.n(Xe),de=g(87999),w=g.n(de),K=g(48305),j=g.n(K),he=g(21889),X=g(43953),k=g(31707),ge=g(58979),Ee=g(49598),Z=g(97150),Ce=g(74139),Ye=g(45011),Ve=g(5902),Me=g(29963),Te=g(96988),Qe=g(71392),te=g(82290),Ne=g(14774),b=g(75271),re="http://127.0.0.1:8080",Be="".concat(re,"/api/v1/upload"),Je=function(){var S=w()(y()().mark(function v(m){return y()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,X.request)("".concat(re,"/api/v1/documents/").concat(m,"/risks/status"),{method:"GET"});case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),console.error("Fetch status error:",r.t0),r.abrupt("return",null);case 10:case"end":return r.stop()}},v,null,[[0,6]])}));return function(m){return S.apply(this,arguments)}}(),Ze=function(){var S=w()(y()().mark(function v(m){var F;return y()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.prev=0,E.next=3,(0,X.request)("".concat(re,"/api/v1/documents/").concat(m,"/content"),{method:"GET"});case 3:return F=E.sent,E.abrupt("return",F);case 7:return E.prev=7,E.t0=E.catch(0),console.error("Fetch document content error:",E.t0),E.abrupt("return",null);case 11:case"end":return E.stop()}},v,null,[[0,7]])}));return function(m){return S.apply(this,arguments)}}(),qe=function(){var S=w()(y()().mark(function v(m){return y()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,X.request)("".concat(re,"/api/v1/documents/").concat(m,"/risks"),{method:"GET"});case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),console.error("Fetch risks error:",r.t0),r.abrupt("return",null);case 10:case"end":return r.stop()}},v,null,[[0,6]])}));return function(m){return S.apply(this,arguments)}}(),_e=function(){var S=w()(y()().mark(function v(m,F){var r;return y()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(m){d.next=2;break}return d.abrupt("return",null);case 2:return d.prev=2,d.next=5,(0,X.request)("".concat(re,"/api/v1/documents/").concat(m,"/risks/").concat(F),{method:"GET"});case 5:return r=d.sent,d.abrupt("return",r);case 9:return d.prev=9,d.t0=d.catch(2),console.error("Fetch risk detail error:",d.t0),d.abrupt("return",null);case 13:case"end":return d.stop()}},v,null,[[2,9]])}));return function(m,F){return S.apply(this,arguments)}}(),ct=function(){var S=w()(y()().mark(function v(m){var F,r=arguments;return y()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return F=r.length>1&&r[1]!==void 0?r[1]:1,d.prev=1,d.next=4,(0,X.request)("".concat(re,"/api/v1/documents/").concat(m,"/risks/analyze"),{method:"POST",data:{top_k:F}});case 4:return d.abrupt("return",d.sent);case 7:return d.prev=7,d.t0=d.catch(1),console.error("Trigger analysis error:",d.t0),d.abrupt("return",null);case 11:case"end":return d.stop()}},v,null,[[1,7]])}));return function(m){return S.apply(this,arguments)}}(),Lt=function(){var S=w()(y()().mark(function v(m){return y()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,X.request)("".concat(re,"/api/v1/history/").concat(m),{method:"GET"});case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),console.error("Fetch history detail error:",r.t0),r.abrupt("return",null);case 10:case"end":return r.stop()}},v,null,[[0,6]])}));return function(m){return S.apply(this,arguments)}}(),Ot=function(){var S=w()(y()().mark(function v(m){var F,r;return y()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return F=new FormData,F.append("file",m),d.next=4,fetch(Be,{method:"POST",body:F});case 4:if(r=d.sent,r.ok){d.next=7;break}throw new Error("HTTP ".concat(r.status));case 7:return d.next=9,r.json();case 9:return d.abrupt("return",d.sent);case 10:case"end":return d.stop()}},v)}));return function(m){return S.apply(this,arguments)}}(),z=function(v){return v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},ot=function(v){var m=function(r){return String(r).padStart(2,"0")};return"".concat(v.getFullYear(),"-").concat(m(v.getMonth()+1),"-").concat(m(v.getDate())," ").concat(m(v.getHours()),":").concat(m(v.getMinutes()))},Wt=function(v,m){var F=fe()(m).sort(function(W,Q){return W.range.start-Q.range.start}),r="",E=0,d=ye()(F),R;try{for(d.s();!(R=d.n()).done;){var f=R.value;f.range.start<E||f.range.start<0||f.range.end>v.length||f.range.end<=f.range.start||(r+=z(v.substring(E,f.range.start)),r+='<mark class="hl '.concat(f.type,'">').concat(z(v.substring(f.range.start,f.range.end)),"</mark>"),E=f.range.end)}}catch(W){d.e(W)}finally{d.f()}return r+=z(v.substring(E)),r},vt=function(v,m){var F,r=[],E=[],d=[],R=(F=m!=null?m:v.raw_content)!==null&&F!==void 0?F:"";return v.risks.forEach(function(f){var W,Q,G="risk-".concat(f.identifier),J=f.detected_issue||"",ce=J.match(/^(.{0,25})/),ie=ce?ce[1]+(J.length>25?"...":""):"\u98CE\u9669\u63D0\u793A",L=f.legal_basis.map(function(_,le){return{id:"legal-".concat(f.identifier,"-").concat(le),lawName:_.law_name,article:_.order,content:_.content,score:_.relevance_score,explanation:void 0,relatedRange:f.highlight_range}});L.forEach(function(_){E.find(function(le){return le.lawName===_.lawName&&le.article===_.article})||E.push(_)});var je={id:G,identifier:f.identifier,level:f.level,title:ie,content:J,suggestion:f.suggestions,highlightRange:f.highlight_range,legalBasis:L};r.push(je);var Y=(W=f==null?void 0:f.suggested_revision)!==null&&W!==void 0?W:f==null?void 0:f.revised_text,u=f==null?void 0:f.original_text,Fe=(Q=f==null?void 0:f.revision_rationale)!==null&&Q!==void 0?Q:f==null?void 0:f.suggestion_reason;if(Y){var q="";if(R&&f.highlight_range){var oe=f.highlight_range,ne=oe.start,ve=oe.end;ne>=0&&ve<=R.length&&(q=R.substring(ne,ve))}u&&(q=u),q?q.length>100&&(q=q.substring(0,100)+"..."):q=J.substring(0,50)+(J.length>50?"...":""),d.push({id:"sug-".concat(f.identifier),original:q,revised:Y,reason:Fe||"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(ie),highlightRange:f.highlight_range})}}),{contractText:R||void 0,risks:r,suggestions:d,legalBasis:E}},Gt=function(v,m,F){var r=(m!=null?m:[]).filter(function(I){return F[I.id]==="accepted"}),E=fe()(r).filter(function(I){return(I==null?void 0:I.highlightRange)&&Number.isFinite(I.highlightRange.start)&&Number.isFinite(I.highlightRange.end)&&I.highlightRange.end>I.highlightRange.start}).sort(function(I,me){return I.highlightRange.start-me.highlightRange.start}),d="",R=0,f=[],W=[],Q=[],G=-1,J=ye()(E),ce;try{for(J.s();!(ce=J.n()).done;){var ie,L=ce.value,je=L.highlightRange,Y=je.start,u=je.end;if(Y<0||u>v.length||u<=Y){W.push(L.id);continue}if(Y<G){W.push(L.id);continue}if(Y>R){var Fe=d.length;d+=v.slice(R,Y);var q=d.length;Q.push({kind:"copy",baseStart:R,baseEnd:Y,outStart:Fe,outEnd:q})}var oe=d.length,ne=(ie=L.revised)!==null&&ie!==void 0?ie:"";d+=ne;var ve=d.length;Q.push({kind:"replace",suggestionId:L.id,baseStart:Y,baseEnd:u,outStart:oe,outEnd:ve}),f.push({suggestionId:L.id,range:{start:oe,end:ve}}),R=u,G=u}}catch(I){J.e(I)}finally{J.f()}if(R<v.length){var _=d.length;d+=v.slice(R);var le=d.length;Q.push({kind:"copy",baseStart:R,baseEnd:v.length,outStart:_,outEnd:le})}return{text:d,appliedEdits:f,skippedIds:W,segments:Q}},e=g(52676),Ut=function(){var v=(0,X.useSearchParams)(),m=j()(v,1),F=m[0],r=F.get("fileId"),E=F.get("topK"),d=F.get("fromHistory")==="true",R=E?parseInt(E,10):1,f=(0,b.useState)(!0),W=j()(f,2),Q=W[0],G=W[1],J=(0,b.useState)("init"),ce=j()(J,2),ie=ce[0],L=ce[1],je=(0,b.useState)(null),Y=j()(je,2),u=Y[0],Fe=Y[1],q=(0,b.useState)(""),oe=j()(q,2),ne=oe[0],ve=oe[1],_=(0,b.useState)(""),le=j()(_,2),I=le[0],me=le[1],Xt=(0,b.useState)(!1),ft=j()(Xt,2),Yt=ft[0],ze=ft[1],Vt=(0,b.useState)(null),ht=j()(Vt,2),Ie=ht[0],et=ht[1],Qt=(0,b.useState)("risk"),gt=j()(Qt,2),Ae=gt[0],tt=gt[1],Jt=(0,b.useState)(!1),mt=j()(Jt,2),qt=mt[0],rt=mt[1],_t=(0,b.useState)(["risks","suggestions","contract"]),pt=j()(_t,2),xt=pt[0],er=pt[1],tr=(0,b.useState)(!0),bt=j()(tr,2),yt=bt[0],rr=bt[1],nr=(0,b.useState)(null),Et=j()(nr,2),M=Et[0],nt=Et[1],ar=(0,b.useState)(null),jt=j()(ar,2),x=jt[0],we=jt[1],sr=(0,b.useState)(!1),Ft=j()(sr,2),He=Ft[0],De=Ft[1],ir=(0,b.useState)({}),wt=j()(ir,2),Ct=wt[0],at=wt[1],lr=(0,b.useState)([]),Nt=j()(lr,2),st=Nt[0],$e=Nt[1],ur=(0,b.useState)([]),Bt=j()(ur,2),dr=Bt[0],At=Bt[1],Dt=(0,b.useRef)(null),kt="contractAnalysis:leftPanePercent",St=function(n,a,s){return Math.min(s,Math.max(a,n))},cr=(0,b.useState)(function(){try{var c=localStorage.getItem(kt),n=c?Number(c):NaN;if(Number.isFinite(n))return St(n,25,75)}catch(a){}return 50}),Pt=j()(cr,2),it=Pt[0],or=Pt[1],Le=(0,b.useRef)(null);(0,b.useEffect)(function(){try{localStorage.setItem(kt,String(it))}catch(c){}},[it]);var vr=(0,b.useRef)(null),ke=(0,b.useRef)(null),fr=function(n){if(!(n.pointerType==="mouse"&&n.button!==0)){Le.current={dragging:!0};try{n.currentTarget.setPointerCapture(n.pointerId)}catch(a){}document.body.style.cursor="col-resize",document.body.style.userSelect="none"}},hr=function(n){var a;if((a=Le.current)!==null&&a!==void 0&&a.dragging){var s=Dt.current;if(s){var t=s.getBoundingClientRect();if(t.width){var l=(n.clientX-t.left)/t.width*100;or(St(l,25,75))}}}},Rt=function(){var n;(n=Le.current)!==null&&n!==void 0&&n.dragging&&(Le.current=null,document.body.style.cursor="",document.body.style.userSelect="")},gr=function(){var c=w()(y()().mark(function n(){var a,s,t,l,h,i,T,P,U,V,H;return y()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(r){C.next=2;break}return C.abrupt("return");case 2:return C.next=4,Promise.all([Ze(r),qe(r)]);case 4:if(a=C.sent,s=j()(a,2),t=s[0],l=s[1],t!=null&&t.raw_content&&ve(t.raw_content),!(l&&l.status==="success")){C.next=20;break}if(i=vt(l,(h=t==null?void 0:t.raw_content)!==null&&h!==void 0?h:ne),Fe(i),!(l.risks&&l.risks.length>0)){C.next=18;break}return P=(T=l.risks.find(function(ue){return ue.identifier==="0"}))!==null&&T!==void 0?T:l.risks[0],C.next=16,_e(r,P.identifier);case 16:U=C.sent,U&&(nt(U),V="risk-".concat(P.identifier),me(V),H=document.getElementById(V),H&&H.scrollIntoView({behavior:"smooth",block:"center"}));case 18:C.next=21;break;case 20:k.ZP.error("\u83B7\u53D6\u5206\u6790\u7ED3\u679C\u5931\u8D25");case 21:G(!1);case 22:case"end":return C.stop()}},n)}));return function(){return c.apply(this,arguments)}}(),mr=function c(){ke.current&&clearTimeout(ke.current),r&&(ke.current=setTimeout(w()(y()().mark(function n(){var a;return y()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Je(r);case 2:if(a=t.sent,a){t.next=6;break}return c(),t.abrupt("return");case 6:if(a.status!=="success"){t.next=13;break}return L("success"),k.ZP.success("\u5206\u6790\u5B8C\u6210\uFF01"),t.next=11,gr();case 11:t.next=14;break;case 13:a.status==="failed"?(L("failed"),G(!1),k.ZP.error(a.error||"\u5206\u6790\u5931\u8D25")):c();case 14:case"end":return t.stop()}},n)})),2e3))},Mt=function(){var c=w()(y()().mark(function n(){var a;return y()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return L("analyzing"),t.next=5,ct(r,R);case 5:if(a=t.sent,a){t.next=13;break}return console.log("First analysis trigger failed, retrying in 1s..."),t.next=10,new Promise(function(l){setTimeout(l,1e3)});case 10:return t.next=12,ct(r,R);case 12:a=t.sent;case 13:a&&a.status==="analyzing"?(k.ZP.info("\u5F00\u59CB\u667A\u80FD\u5206\u6790..."),mr()):(L("failed"),G(!1),k.ZP.error("\u89E6\u53D1\u5206\u6790\u5931\u8D25\uFF0C\u53EF\u80FD\u662F\u6587\u6863\u5C1A\u672A\u51C6\u5907\u597D\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"));case 14:case"end":return t.stop()}},n)}));return function(){return c.apply(this,arguments)}}(),pr=function(){var c=w()(y()().mark(function n(){var a,s,t,l;return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(G(!0),!(d&&r)){i.next=18;break}return i.next=4,Lt(r);case 4:if(a=i.sent,!(a&&a.status==="success")){i.next=18;break}if(L("success"),s=a.raw_content||"",s){i.next=13;break}return i.next=11,Ze(r);case 11:t=i.sent,t!=null&&t.raw_content&&(s=t.raw_content);case 13:return ve(s),l=vt(a,s),Fe(l),G(!1),i.abrupt("return");case 18:return i.next=20,Mt();case 20:case"end":return i.stop()}},n)}));return function(){return c.apply(this,arguments)}}();(0,b.useEffect)(function(){if(!r){k.ZP.error("\u7F3A\u5C11\u6587\u4EF6ID\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"),X.history.push("/");return}return we(null),De(!1),at({}),$e([]),pr(),function(){ke.current&&clearTimeout(ke.current)}},[r]);var xr=function(){var c=w()(y()().mark(function n(){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(r){s.next=2;break}return s.abrupt("return");case 2:return G(!0),s.next=5,Mt();case 5:case"end":return s.stop()}},n)}));return function(){return c.apply(this,arguments)}}(),br=function(){X.history.push("/")},Tt=function(n){tt("risk"),et(n),ze(!0)},yr=function(n){tt("suggestion"),et(n),ze(!0)},Er=function(n){tt("legal"),et(n),ze(!0)},Zt=function(n,a){if(r){if(n==="risk"){var s=u==null?void 0:u.risks.find(function(h){return h.id===a});s&&(me(a),_e(r,s.identifier).then(function(h){h&&nt(h)}),Tt(s))}else if(n==="suggestion"){me(a);var t=u==null?void 0:u.suggestions.find(function(h){return h.id===a});t&&yr(t)}else if(n==="legal"){me(a);var l=u==null?void 0:u.legalBasis.find(function(h){return h.id===a});l&&Er(l)}}},jr=function(){if(!u||!u.contractText)return ne?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:ne}):(0,e.jsx)("div",{className:"text-gray-400 text-center py-10",children:"\u6682\u65E0\u5408\u540C\u6587\u672C\u5185\u5BB9"});var n=u.contractText,a=u.risks,s=u.legalBasis,t=[];a.forEach(function(i){t.push({range:i.highlightRange,type:"risk",id:i.id,riskLevel:i.level})}),s.forEach(function(i){t.push({range:i.relatedRange,type:"legal",id:i.id})}),t.sort(function(i,T){return i.range.start-T.range.start});var l=[],h=0;return t.forEach(function(i,T){i.range.start<h||i.range.end>n.length||(i.range.start>h&&l.push((0,e.jsx)("span",{children:n.substring(h,i.range.start)},"text-".concat(T))),l.push((0,e.jsx)("mark",{className:"highlight ".concat(i.type," ").concat(i.type==="risk"&&i.riskLevel?"risk-".concat(i.riskLevel):""," ").concat(I===i.id?"active":""),id:i.id,onClick:function(){return Zt(i.type,i.id)},children:n.substring(i.range.start,i.range.end)},"highlight-".concat(i.id))),h=i.range.end)}),h<n.length&&l.push((0,e.jsx)("span",{children:n.substring(h)},"text-end")),l},Oe=function(){return x!=null?x:(u==null?void 0:u.contractText)||ne||""},lt=function(){return(u==null?void 0:u.contractText)||ne||""},Fr=function(){var n=Oe();if(!n){k.ZP.warning("\u6682\u65E0\u53EF\u7F16\u8F91\u7684\u5408\u540C\u6587\u672C");return}we(n),De(!0)},wr=function(){De(!1),k.ZP.success("\u5DF2\u5728\u9875\u9762\u4E2D\u4FDD\u5B58\u4FEE\u6539\uFF08\u672A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF09")},zt=function(){we(null),De(!1),$e([]),at({}),k.ZP.info("\u5DF2\u64A4\u9500\u4FEE\u6539")},Cr=function(n){var a;return(a=Ct[n])!==null&&a!==void 0?a:"undecided"},Nr=function(n){var a=lt();if(!(!u||!a)){var s=Gt(a,u.suggestions,n),t=s.text,l=s.appliedEdits,h=s.skippedIds,i=s.segments;we(t),De(!1),$e(l),At(i),h.length&&k.ZP.warning("\u6709 ".concat(h.length," \u6761\u5EFA\u8BAE\u56E0\u8303\u56F4\u91CD\u53E0/\u5F02\u5E38\u672A\u80FD\u5E94\u7528"))}},ut=function(n,a){if(u){if(He){k.ZP.warning("\u8BF7\u5148\u70B9\u51FB\u201C\u5B8C\u6210/\u64A4\u9500\u201D\u9000\u51FA\u624B\u52A8\u7F16\u8F91\uFF0C\u518D\u8FDB\u884C\u5EFA\u8BAE\u91C7\u7EB3");return}var s=Re()(Re()({},Ct),{},Pe()({},n,a));at(s);var t=Object.values(s).some(function(l){return l==="accepted"});if(!t){At([]),we(null),$e([]);return}Nr(s)}},Br=function(){var n,a;if(!x)return null;if(!st.length){var s=lt();if(!s||s===x)return(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:x});for(var t=Math.min(s.length,x.length),l=0;l<t&&s[l]===x[l];)l+=1;for(var h=0;h<t-l&&s[s.length-1-h]===x[x.length-1-h];)h+=1;var i=l,T=x.length-h;return T<=i?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:x}):(0,e.jsxs)("div",{className:"whitespace-pre-wrap",children:[(0,e.jsx)("span",{children:x.slice(0,i)}),(0,e.jsx)("mark",{className:"highlight edit",children:x.slice(i,T)}),(0,e.jsx)("span",{children:x.slice(T)})]})}var P=function(o){var B=ye()(dr),$;try{for(B.s();!($=B.n()).done;){var A=$.value;if(!(o<A.baseStart||o>A.baseEnd)){if(A.kind!=="copy")return null;var ae=o-A.baseStart,ee=A.outStart+ae;return ee<A.outStart||ee>A.outEnd?null:ee}}}catch(be){B.e(be)}finally{B.f()}return null},U=function(o){var B=P(o.start),$=P(o.end);return B===null||$===null||$<=B?null:{start:B,end:$}},V=function(o,B){return o.start<B.end&&B.start<o.end},H=function(o,B){var $=[],A=o.start,ae=ye()(B),ee;try{for(ae.s();!(ee=ae.n()).done;){var be=ee.value;if(!(be.end<=A)){if(be.start>=o.end)break;if(V({start:A,end:o.end},be)){var Ht=Math.min(be.start,o.end);if(Ht>A&&$.push({start:A,end:Ht}),A=Math.max(A,be.end),A>=o.end)break}}}}catch(Ge){ae.e(Ge)}finally{ae.f()}return A<o.end&&$.push({start:A,end:o.end}),$.filter(function(Ge){return Ge.end>Ge.start})},D=fe()(st).map(function(p){return p.range}).filter(function(p){return p.end>p.start}).sort(function(p,o){return p.start-o.start}),C=[];st.forEach(function(p){p.range.end<=p.range.start||C.push({key:"edit-".concat(p.suggestionId),range:p.range,type:"edit",id:"edit-".concat(p.suggestionId),suggestionId:p.suggestionId})});var ue=(n=u==null?void 0:u.risks)!==null&&n!==void 0?n:[],pe=(a=u==null?void 0:u.legalBasis)!==null&&a!==void 0?a:[];ue.forEach(function(p){var o=U(p.highlightRange);if(o){var B=H(o,D);B.forEach(function($,A){C.push({key:"".concat(p.id,"__").concat(A),range:$,type:"risk",id:p.id,riskLevel:p.level})})}}),pe.forEach(function(p){var o=U(p.relatedRange);if(o){var B=H(o,D);B.forEach(function($,A){C.push({key:"".concat(p.id,"__").concat(A),range:$,type:"legal",id:p.id})})}}),C.sort(function(p,o){return p.range.start!==o.range.start?p.range.start-o.range.start:p.type==="edit"&&o.type!=="edit"?-1:o.type==="edit"&&p.type!=="edit"?1:p.range.end-o.range.end});for(var xe=[],N=0,dt=function(){var o=C[We];if(o.range.start<N||o.range.end>x.length)return 0;if(o.range.start>N&&xe.push((0,e.jsx)("span",{children:x.slice(N,o.range.start)},"mix-text-".concat(We))),o.type==="edit"){var B=o.suggestionId;xe.push((0,e.jsx)("mark",{id:"edit-".concat(B),className:"highlight edit ".concat(I==="edit-".concat(B)?"active":""),onClick:function(){me("edit-".concat(B));var A=B.replace(/^sug-/,""),ae=u==null?void 0:u.risks.find(function(ee){return ee.identifier===A});ae&&(_e(r||"",ae.identifier).then(function(ee){ee&&nt(ee)}),Tt(ae))},children:x.slice(o.range.start,o.range.end)},"mix-edit-".concat(B)))}else xe.push((0,e.jsx)("mark",{className:"highlight ".concat(o.type," ").concat(o.type==="risk"&&o.riskLevel?"risk-".concat(o.riskLevel):""," ").concat(I===o.id?"active":""),id:o.id,onClick:function(){return Zt(o.type,o.id)},children:x.slice(o.range.start,o.range.end)},o.key));N=o.range.end},It,We=0;We<C.length;We+=1)It=dt();return N<x.length&&xe.push((0,e.jsx)("span",{children:x.slice(N)},"mix-text-end")),(0,e.jsx)("div",{className:"whitespace-pre-wrap",children:xe})},Ar=function(){var c=w()(y()().mark(function n(){var a,s,t,l;return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=x,a){i.next=4;break}return k.ZP.warning("\u8BF7\u5148\u7F16\u8F91\u6216\u5E94\u7528\u5EFA\u8BAE"),i.abrupt("return");case 4:return i.prev=4,G(!0),t=new File([a],"edited-".concat(r||"contract",".txt"),{type:"text/plain"}),i.next=9,Ot(t);case 9:if(l=i.sent,!(l!=null&&l.success&&l!==null&&l!==void 0&&(s=l.data)!==null&&s!==void 0&&s.uuid)){i.next=14;break}return k.ZP.success("\u5DF2\u4E0A\u4F20\u4FEE\u6539\u7248\uFF0C\u5F00\u59CB\u91CD\u65B0\u5206\u6790"),X.history.push("/contract-analysis?fileId=".concat(l.data.uuid)),i.abrupt("return");case 14:G(!1),k.ZP.error((l==null?void 0:l.message)||"\u4E0A\u4F20\u5931\u8D25"),i.next=23;break;case 18:i.prev=18,i.t0=i.catch(4),console.error(i.t0),G(!1),k.ZP.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 23:case"end":return i.stop()}},n,null,[[4,18]])}));return function(){return c.apply(this,arguments)}}(),Dr=function(){if(!u)return[];var n=u.risks,a=u.suggestions,s=u.legalBasis,t=[];return n.forEach(function(l){t.push({range:l.highlightRange,type:"risk",id:l.id})}),a.forEach(function(l){t.push({range:l.highlightRange,type:"suggestion",id:l.id})}),s.forEach(function(l){t.push({range:l.relatedRange,type:"legal",id:l.id})}),t.sort(function(l,h){return l.range.start-h.range.start}),t},kr=function(){var n,a,s,t=new Date,l=Oe(),h=yt&&!x,i=new Set(xt),T=i.has("contract"),P=i.has("risks"),U=i.has("suggestions"),V=i.has("legal"),H="\u5408\u540C\u5206\u6790\u7ED3\u679C\uFF08\u5BFC\u51FA\uFF09",D="\u5BFC\u51FA\u65F6\u95F4\uFF1A".concat(ot(t)).concat(r?" \xB7 \u6587\u4EF6ID\uFF1A".concat(z(r)):""),C=P?((n=u==null?void 0:u.risks)!==null&&n!==void 0?n:[]).map(function(N){var dt=N.level==="high"?"\u9AD8\u98CE\u9669":N.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669";return`
              <div class="item">
                <div class="item-title">
                  <span class="badge `.concat(z(N.level),'">').concat(dt,`</span>
                  <span class="item-head">`).concat(z(N.title),`</span>
                </div>
                <div class="item-body">`).concat(z(N.content),`</div>
                `).concat(N.suggestion?'<div class="item-sub"><span class="muted">\u5EFA\u8BAE\uFF1A</span>'.concat(z(N.suggestion),"</div>"):"",`
              </div>
            `)}).join(""):"",ue=U?((a=u==null?void 0:u.suggestions)!==null&&a!==void 0?a:[]).map(function(N){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge info">\u4FEE\u6539\u5EFA\u8BAE</span>
                  <span class="item-head">`.concat(z(N.reason||"\u5EFA\u8BAE"),`</span>
                </div>
                <div class="diff">
                  <div class="diff-row">
                    <div class="diff-label">\u539F\u6587</div>
                    <div class="diff-content original">`).concat(z(N.original),`</div>
                  </div>
                  <div class="diff-row">
                    <div class="diff-label">\u4FEE\u6539\u4E3A</div>
                    <div class="diff-content revised">`).concat(z(N.revised),`</div>
                  </div>
                </div>
              </div>
            `)}).join(""):"",pe=V?((s=u==null?void 0:u.legalBasis)!==null&&s!==void 0?s:[]).map(function(N){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge legal">\u6CD5\u5F8B\u4F9D\u636E</span>
                  <span class="item-head">`.concat(z(N.lawName)," ").concat(z(N.article),`</span>
                </div>
                <div class="item-body">`).concat(z(N.content),`</div>
                <div class="item-sub"><span class="muted">\u76F8\u5173\u5EA6\uFF1A</span>`).concat((N.score*100).toFixed(0),`%</div>
              </div>
            `)}).join(""):"",xe=T?h&&u?'<div class="contract-text"><div class="contract-pre">'.concat(Wt(l,Dr()).replace(/\n/g,"<br/>"),"</div></div>"):'<div class="contract-text"><div class="contract-pre">'.concat(z(l).replace(/\n/g,"<br/>"),"</div></div>"):"";return`
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>`.concat(z(H),`</title>
    <style>
      @page { margin: 16mm 14mm; }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
        color: #111827;
        line-height: 1.55;
      }
      .header { margin-bottom: 14px; }
      .title { font-size: 18px; font-weight: 700; margin: 0 0 4px 0; }
      .subtitle { font-size: 12px; color: #6b7280; margin: 0; }
      .section { margin-top: 14px; }
      .section-title { font-size: 13px; font-weight: 700; margin: 0 0 8px 0; }
      .divider { height: 1px; background: #e5e7eb; margin: 10px 0; }
      .item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px 12px; margin: 10px 0; break-inside: avoid; }
      .item-title { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
      .item-head { font-weight: 700; }
      .item-body { font-size: 12px; color: #111827; }
      .item-sub { font-size: 12px; color: #374151; margin-top: 6px; }
      .muted { color: #6b7280; }
      .badge { display: inline-block; font-size: 11px; padding: 2px 8px; border-radius: 999px; border: 1px solid #e5e7eb; background: #f9fafb; color: #111827; }
      .badge.high { background: #fff1f2; border-color: #fecdd3; color: #9f1239; }
      .badge.medium { background: #fff7ed; border-color: #fed7aa; color: #9a3412; }
      .badge.low { background: #f0fdf4; border-color: #bbf7d0; color: #166534; }
      .badge.info { background: #eff6ff; border-color: #bfdbfe; color: #1d4ed8; }
      .badge.legal { background: #f5f3ff; border-color: #ddd6fe; color: #5b21b6; }
      .diff { margin-top: 6px; }
      .diff-row { display: flex; gap: 10px; margin-top: 6px; }
      .diff-label { width: 52px; font-size: 12px; color: #6b7280; flex: 0 0 auto; }
      .diff-content { font-size: 12px; padding: 8px 10px; border-radius: 6px; border: 1px solid #e5e7eb; width: 100%; }
      .diff-content.original { background: #fff1f2; border-color: #fecdd3; }
      .diff-content.revised { background: #f0fdf4; border-color: #bbf7d0; }
      .contract-text { margin-top: 8px; }
      .contract-pre { font-size: 12px; white-space: normal; word-break: break-word; }
      mark.hl { padding: 0 2px; border-radius: 3px; }
      mark.hl.risk { background: #ffe4e6; }
      mark.hl.suggestion { background: #dbeafe; }
      mark.hl.legal { background: #ede9fe; }
      .print-hint { font-size: 12px; color: #6b7280; margin-top: 10px; }
      .footer { position: fixed; bottom: 0; left: 0; right: 0; font-size: 10px; color: #9ca3af; }
      .footer-inner { display: flex; justify-content: space-between; }
      @media print {
        .no-print { display: none !important; }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="title">`).concat(z(H),`</div>
      <p class="subtitle">`).concat(D,`</p>
      <div class="print-hint no-print">\u63D0\u793A\uFF1A\u5728\u6253\u5370\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002</div>
      <div class="divider"></div>
    </div>

    `).concat(P?'<div class="section"><div class="section-title">\u98CE\u9669\u6458\u8981</div>'.concat(C||'<div class="muted">\u6682\u65E0\u98CE\u9669</div>',"</div>"):"",`
    `).concat(U?'<div class="section"><div class="section-title">\u4FEE\u6539\u5EFA\u8BAE</div>'.concat(ue||'<div class="muted">\u6682\u65E0\u4FEE\u6539\u5EFA\u8BAE</div>',"</div>"):"",`
    `).concat(V?'<div class="section"><div class="section-title">\u6CD5\u5F8B\u4F9D\u636E</div>'.concat(pe||'<div class="muted">\u6682\u65E0\u6CD5\u5F8B\u4F9D\u636E</div>',"</div>"):"",`
    `).concat(T?'<div class="section"><div class="section-title">\u5408\u540C\u6B63\u6587</div>'.concat(xe||'<div class="muted">\u6682\u65E0\u6B63\u6587</div>',"</div>"):"",`

    <div class="footer">
      <div class="footer-inner">
        <span>LegalRag</span>
        <span>`).concat(ot(t),`</span>
      </div>
    </div>
  </body>
</html>
    `).trim()},Sr=function(){var n,a=Oe();if(!a){k.ZP.error("\u6682\u65E0\u53EF\u5BFC\u51FA\u7684\u5408\u540C\u6587\u672C");return}var s=kr(),t=document.createElement("iframe");t.style.position="fixed",t.style.right="0",t.style.bottom="0",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);var l=t.contentDocument||((n=t.contentWindow)===null||n===void 0?void 0:n.document);if(!l){k.ZP.error("\u65E0\u6CD5\u521B\u5EFA\u6253\u5370\u6587\u6863"),document.body.removeChild(t);return}l.open(),l.write(s),l.close(),t.onload=function(){setTimeout(function(){try{if(!t.contentWindow)return;t.contentWindow.focus(),t.contentWindow.print()}catch(h){console.error("Print error:",h),k.ZP.error("\u6253\u5370\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}finally{setTimeout(function(){document.body.contains(t)&&document.body.removeChild(t)},1e3)}},300)}},Pr=function(){if(!Ie)return null;if(Ae==="risk"){var n,a,s=Ie,t=(n=s.legalBasis)!==null&&n!==void 0?n:[],l=t.length>0,h="sug-".concat(s.identifier),i=u==null||(a=u.suggestions)===null||a===void 0?void 0:a.find(function(D){return D.id===h}),T=(M==null?void 0:M.identifier)===s.identifier&&M!==null&&M!==void 0&&M.suggested_revision?{id:h,original:function(){var D=lt(),C=s.highlightRange||{start:0,end:0},ue=C.start,pe=C.end;return D&&ue>=0&&pe>ue&&pe<=D.length?D.slice(ue,pe):""}(),revised:M.suggested_revision,reason:"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(s.title),highlightRange:s.highlightRange}:null,P=T!=null?T:i,U=P?Cr(P.id):"undecided";return(0,e.jsxs)("div",{className:"detail-modal dark-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(ge.Z,{className:"!border-none !px-4 !py-1 !rounded-full",color:s.level==="high"?"#f5222d":s.level==="medium"?"#fa8c16":"#52c41a",children:s.level==="high"?"\u9AD8\u98CE\u9669":s.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u98CE\u9669\u63CF\u8FF0"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:s.content})]}),s.suggestion&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u5EFA\u8BAE\u63AA\u65BD"}),(0,e.jsx)("div",{className:"section-content !bg-brand-500/10 !text-brand-100 !border-brand-500/20 !rounded-xl !p-4",children:s.suggestion})]}),P?(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u5177\u4F53\u4FEE\u6539\u65B9\u6848"}),(0,e.jsxs)("div",{className:"diff-display",style:{marginBottom:16},children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original !bg-red-500/10 !text-red-200 !border-red-500/20 !rounded-lg",children:P.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised !bg-green-500/10 !text-green-200 !border-green-500/20 !rounded-lg",children:P.revised})]})]}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:(0,e.jsxs)(Ee.Z,{wrap:!0,children:[(0,e.jsx)(Z.ZP,{size:"middle",className:U==="accepted"?"!h-10 !px-6 !rounded-xl !bg-brand-600 !text-white !border-none shadow-lg shadow-brand-600/20":"!h-10 !px-6 !rounded-xl !bg-white/5 !text-slate-300 !border-white/10 hover:!bg-white/10 hover:!border-brand-500/50",onClick:function(){ut(P.id,U==="accepted"?"undecided":"accepted")},children:"\u91C7\u7EB3\u5EFA\u8BAE"}),(0,e.jsx)(Z.ZP,{size:"middle",className:U==="rejected"?"!h-10 !px-6 !rounded-xl !bg-slate-700 !text-white !border-none":"!h-10 !px-6 !rounded-xl !bg-white/5 !text-slate-300 !border-white/10 hover:!bg-white/10 hover:!border-red-500/50",onClick:function(){ut(P.id,U==="rejected"?"undecided":"rejected")},children:"\u4E0D\u91C7\u7EB3"}),(0,e.jsx)(Z.ZP,{size:"middle",ghost:!0,className:"!h-10 !px-6 !rounded-xl !text-slate-500 !border-white/5 hover:!text-slate-300",onClick:function(){ut(P.id,"undecided")},children:"\u6E05\u9664\u9009\u62E9"})]})})]}):null,l&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content space-y-3 !bg-transparent !p-0",children:t.map(function(D){return(0,e.jsxs)("div",{className:"!bg-white/5 !border !border-white/10 !rounded-xl !p-4",children:[(0,e.jsxs)("div",{className:"text-slate-200 font-semibold mb-2",children:[D.lawName," ",D.article]}),(0,e.jsx)("div",{className:"text-slate-400 text-sm leading-relaxed mb-3",children:D.content}),(0,e.jsxs)("div",{className:"legal-score flex items-center",children:[(0,e.jsx)(Ce.Z,{disabled:!0,allowHalf:!0,value:D.score*5,style:{fontSize:12,color:"#fadb14"}}),(0,e.jsxs)("span",{className:"ml-3 text-xs text-slate-500",children:["\u76F8\u5173\u5EA6: ",(D.score*100).toFixed(0),"%"]})]})]},D.id)})})]})]})}if(Ae==="suggestion"){var V=Ie;return(0,e.jsxs)("div",{className:"detail-modal dark-modal",children:[(0,e.jsxs)("div",{className:"diff-display",children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original !bg-red-500/10 !text-red-200 !border-red-500/20 !rounded-lg",children:V.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised !bg-green-500/10 !text-green-200 !border-green-500/20 !rounded-lg",children:V.revised})]})]}),V.reason&&(0,e.jsxs)("div",{className:"modal-section mt-4",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u4FEE\u6539\u7406\u7531"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:V.reason})]})]})}if(Ae==="legal"){var H=Ie;return(0,e.jsxs)("div",{className:"detail-modal dark-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u6CD5\u5F8B\u540D\u79F0"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:H.lawName})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u6761\u6B3E"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:H.article})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u6CD5\u6761\u5185\u5BB9"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:H.content})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u76F8\u5173\u5EA6\u8BC4\u5206"}),(0,e.jsxs)("div",{className:"legal-score flex items-center p-2",children:[(0,e.jsx)(Ce.Z,{disabled:!0,allowHalf:!0,value:H.score*5,style:{color:"#fadb14"}}),(0,e.jsxs)("span",{className:"ml-4 text-slate-400",children:[(H.score*100).toFixed(0),"%"]})]})]}),H.explanation&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u9002\u7528\u8BF4\u660E"}),(0,e.jsx)("div",{className:"section-content !bg-brand-500/10 !text-brand-100 !border-brand-500/20 !rounded-xl !p-4",children:H.explanation})]})]})}},Rr=function(){return Ae==="risk"?"\u98CE\u9669\u8BE6\u60C5":Ae==="suggestion"?"\u4FEE\u6539\u5EFA\u8BAE\u8BE6\u60C5":"\u6CD5\u5F8B\u4F9D\u636E\u8BE6\u60C5"};return Q?(0,e.jsxs)("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center px-4",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:10},children:[(0,e.jsx)(he.Z,{}),(0,e.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-2xl bg-white/5 border border-white/10 shadow-2xl px-8 py-10 text-center space-y-4 backdrop-blur-xl",children:[(0,e.jsx)("div",{className:"bg-brand-600/20 border border-brand-500/30 inline-flex items-center justify-center rounded-full px-4 py-1 text-xs font-medium text-brand-300",children:ie==="analyzing"?"Quantum Flux Processing...":"Initializing System..."}),(0,e.jsx)("p",{className:"text-sm text-slate-400",children:"\u6211\u4EEC\u6B63\u5728\u4E3A\u60A8\u89E3\u6790\u5408\u540C\u6761\u6B3E\u5E76\u751F\u6210\u98CE\u9669\u63D0\u793A\u3001\u4FEE\u6539\u610F\u89C1\u4E0E\u6CD5\u5F8B\u4F9D\u636E\uFF0C\u8BF7\u7A0D\u5019\u3002"}),(0,e.jsx)("div",{className:"flex justify-center pt-2",children:(0,e.jsx)(Ye.Z,{size:"large",tip:(0,e.jsx)("span",{className:"text-slate-400 mt-2 block",children:ie==="analyzing"?"\u6B63\u5728\u5206\u6790\u5408\u540C...":"\u6B63\u5728\u52A0\u8F7D..."})})})]})]}):(0,e.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#020617",overflow:"hidden",zIndex:1},children:[(0,e.jsx)(he.Z,{}),(0,e.jsx)("div",{style:{position:"relative",zIndex:1,padding:"24px 24px 48px",height:"100%",overflowX:"hidden",overflowY:"auto"},children:(0,e.jsxs)("div",{className:"mx-auto max-w-7xl",children:[(0,e.jsxs)("div",{className:"sexy-card mb-6 px-6 py-4 flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-xs font-semibold tracking-wide text-brand-200/80 uppercase",children:"LegalRag"}),(0,e.jsx)("p",{className:"text-xl font-bold text-white tracking-tight",children:"\u5408\u540C\u5206\u6790\u7ED3\u679C"})]}),(0,e.jsxs)(Ee.Z,{children:[(0,e.jsx)("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-brand-100 backdrop-blur-md",children:"\u98CE\u9669\u63D0\u793A \xB7 \u4FEE\u6539\u610F\u89C1 \xB7 \u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)(Z.ZP,{ghost:!0,size:"small",onClick:function(){return X.history.push("/history")},style:{color:"rgba(255,255,255,0.8)",borderColor:"rgba(255,255,255,0.3)"},children:"\u5386\u53F2"}),(0,e.jsx)(Z.ZP,{ghost:!0,size:"small",onClick:br,style:{color:"rgba(255,255,255,0.8)",borderColor:"rgba(255,255,255,0.3)"},children:"\u8FD4\u56DE"})]})]}),(0,e.jsx)("div",{className:"contract-analysis",children:(0,e.jsxs)("div",{className:"analysis-content !p-0",children:[(0,e.jsxs)("div",{className:"flex justify-end mb-4 gap-3",children:[(0,e.jsx)(Z.ZP,{className:"sexy-card !border-white/20 !text-white hover:!bg-white/10 hover:!border-white/40 !h-9 !px-4 !bg-transparent",onClick:function(){return rt(!0)},children:"\u5BFC\u51FA PDF"}),(0,e.jsx)(Z.ZP,{type:"primary",className:"!bg-brand-600 hover:!bg-brand-500 !border-none !h-9 !px-4 !rounded-lg",onClick:xr,children:"\u91CD\u65B0\u5206\u6790"})]}),u&&(0,e.jsx)("div",{className:"analysis-content-inner",children:(0,e.jsxs)("div",{className:"split-grid",ref:Dt,style:Pe()({},"--left-pane","".concat(it,"%")),children:[(0,e.jsx)("div",{className:"split-left",children:(0,e.jsxs)("div",{className:"sexy-card h-full flex flex-col overflow-hidden",children:[(0,e.jsxs)("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-white/5",children:[(0,e.jsx)("span",{className:"text-white font-semibold",children:"\u5408\u540C\u6587\u672C"}),(0,e.jsxs)(Ee.Z,{children:[He?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Z.ZP,{size:"small",type:"primary",onClick:wr,className:"!bg-brand-600",children:"\u5B8C\u6210"}),(0,e.jsx)(Z.ZP,{size:"small",ghost:!0,onClick:zt,className:"!text-white/80 !border-white/20",children:"\u64A4\u9500"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Z.ZP,{size:"small",ghost:!0,onClick:Fr,className:"!text-white/80 !border-white/20 hover:!border-brand-400 hover:!text-brand-400",children:"\u7F16\u8F91"}),x?(0,e.jsx)(Z.ZP,{size:"small",danger:!0,ghost:!0,onClick:zt,className:"!border-red-500/30 hover:!bg-red-500/10",children:"\u64A4\u9500\u4FEE\u6539\u7248"}):null]}),x&&!He?(0,e.jsx)(Z.ZP,{size:"small",type:"primary",ghost:!0,onClick:Ar,children:"\u7528\u4FEE\u6539\u7248\u91CD\u65B0\u5206\u6790"}):null]})]}),(0,e.jsx)("div",{className:"contract-text-panel flex-1",ref:vr,children:He?(0,e.jsxs)("div",{className:"space-y-2 h-full flex flex-col",children:[(0,e.jsx)("div",{className:"text-xs text-slate-400",children:"\u63D0\u793A\uFF1A\u7F16\u8F91/\u5E94\u7528\u5EFA\u8BAE\u540E\uFF0C\u672C\u9875\u9AD8\u4EAE\u5B9A\u4F4D\u5C06\u4E0D\u518D\u51C6\u786E\u3002"}),(0,e.jsx)(Ve.Z.TextArea,{className:"!bg-black/20 !text-slate-200 !border-white/10 placeholder:!text-slate-600 flex-1",value:x!=null?x:Oe(),onChange:function(n){return we(n.target.value)},style:{resize:"none",height:"100%"}})]}):x?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-xs text-slate-400",children:"\u5DF2\u751F\u6210\u4FEE\u6539\u7248\u6B63\u6587\uFF08\u7EFF\u8272\u9AD8\u4EAE\u4E3A\u5DF2\u91C7\u7EB3\u7684\u4FEE\u6539\u5185\u5BB9\uFF09\u3002"}),Br()]}):jr()})]})}),(0,e.jsx)("div",{className:"split-resizer",role:"separator","aria-orientation":"vertical","aria-label":"\u8C03\u6574\u5408\u540C\u6587\u672C\u533A\u57DF\u5BBD\u5EA6",onPointerDown:fr,onPointerMove:hr,onPointerUp:Rt,onPointerCancel:Rt}),(0,e.jsx)("div",{className:"split-right",children:(0,e.jsx)("div",{className:"analysis-panel h-full",children:(0,e.jsxs)("div",{className:"sexy-card h-full flex flex-col overflow-hidden",children:[(0,e.jsx)("div",{className:"p-4 border-b border-white/10 bg-white/5",children:(0,e.jsx)("span",{className:"text-white font-semibold",children:"\u98CE\u9669\u8BE6\u60C5"})}),(0,e.jsx)("div",{className:"p-5 flex-1 overflow-y-auto",children:M?(0,e.jsxs)("div",{className:"detail-container",children:[(0,e.jsxs)("div",{className:"modal-section",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,e.jsx)("span",{className:"text-white text-lg font-semibold",children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(ge.Z,{className:"!border-none",color:M.level==="high"?"#f5222d":M.level==="medium"?"#fa8c16":"#52c41a",style:{padding:"4px 16px",fontSize:14,borderRadius:12,marginRight:0},children:M.level==="high"?"\u9AD8\u98CE\u9669":M.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsxs)("div",{className:"mb-4 rounded-lg bg-red-500/10 border border-red-500/20 overflow-hidden",children:[(0,e.jsx)("div",{className:"px-3 py-2 bg-red-500/20 border-b border-red-500/20 text-red-300 text-sm font-semibold flex items-center gap-2",children:(0,e.jsx)("span",{children:"\u{1F6A8} \u98CE\u9669\u63CF\u8FF0"})}),(0,e.jsx)("div",{className:"p-3 text-slate-200 text-sm leading-relaxed",children:M.detected_issue})]}),M.suggestions&&(0,e.jsxs)("div",{className:"mb-4 rounded-lg bg-yellow-500/10 border border-yellow-500/20 overflow-hidden",children:[(0,e.jsx)("div",{className:"px-3 py-2 bg-yellow-500/20 border-b border-yellow-500/20 text-yellow-300 text-sm font-semibold flex items-center gap-2",children:(0,e.jsx)("span",{children:"\u{1F4A1} \u5EFA\u8BAE\u63AA\u65BD"})}),(0,e.jsx)("div",{className:"p-3 text-slate-200 text-sm leading-relaxed",children:M.suggestions})]}),M.legal_basis&&M.legal_basis.length>0&&(0,e.jsxs)("div",{className:"modal-section mt-6",children:[(0,e.jsx)("div",{className:"section-title text-white mb-3 font-semibold",children:"\u2696\uFE0F \u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content space-y-3",children:M.legal_basis.map(function(c,n){return(0,e.jsxs)("div",{className:"rounded-lg bg-white/5 border border-white/10 p-3 hover:bg-white/10 transition-colors",children:[(0,e.jsxs)("div",{className:"text-slate-200 font-medium mb-1",children:[c.law_name," ",c.order]}),(0,e.jsx)("div",{className:"text-slate-400 text-sm mb-2 leading-relaxed",children:c.content}),(0,e.jsxs)("div",{className:"legal-score flex items-center",children:[(0,e.jsx)(Ce.Z,{disabled:!0,allowHalf:!0,value:(c.relevance_score||0)*5,style:{fontSize:12,color:"#fadb14"}}),(0,e.jsxs)("span",{className:"ml-2 text-xs text-slate-500",children:["\u76F8\u5173\u5EA6:"," ",((c.relevance_score||0)*100).toFixed(0),"%"]})]})]},n)})})]})]}):(0,e.jsxs)("div",{className:"text-slate-500 text-center py-12 flex flex-col items-center justify-center h-full",children:[(0,e.jsx)("div",{className:"text-4xl mb-4 opacity-50",children:"\u{1F4CB}"}),(0,e.jsx)("div",{className:"text-lg",children:"\u6682\u65E0\u98CE\u9669\u8BE6\u60C5"}),(0,e.jsx)("div",{className:"text-sm mt-2 opacity-60",children:"\u70B9\u51FB\u5DE6\u4FA7\u5408\u540C\u5185\u5BB9\u7684\u6807\u8BB0\u5904\u67E5\u770B"})]})})]})})})]})})]})}),(0,e.jsx)(Me.Z,{title:Rr(),open:Yt,onCancel:function(){return ze(!1)},footer:null,width:700,className:"dark-modal",children:Pr()}),(0,e.jsxs)(Me.Z,{title:"\u5BFC\u51FA PDF",open:qt,onCancel:function(){return rt(!1)},okText:"\u5F00\u59CB\u5BFC\u51FA",cancelText:"\u53D6\u6D88",className:"dark-modal",onOk:function(){rt(!1),Sr()},children:[(0,e.jsx)(Te.Z.Paragraph,{style:{marginBottom:10,color:"rgba(255,255,255,0.5)"},children:"\u70B9\u51FB\u201C\u5F00\u59CB\u5BFC\u51FA\u201D\u540E\u5C06\u81EA\u52A8\u5F39\u51FA\u6253\u5370\u5BF9\u8BDD\u6846\uFF0C\u5728\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002"}),(0,e.jsx)(Qe.Z,{style:{margin:"12px 0",borderColor:"rgba(255,255,255,0.1)"}}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsx)("div",{style:{fontWeight:600,marginBottom:8,color:"#fff"},children:"\u5BFC\u51FA\u5185\u5BB9"}),(0,e.jsx)(te.Z.Group,{value:xt,onChange:function(n){var a=n;a.includes("contract")||a.push("contract"),er(Array.from(new Set(a)))},children:(0,e.jsxs)(Ee.Z,{wrap:!0,children:[(0,e.jsx)(te.Z,{value:"contract",className:"!text-slate-300",children:"\u5408\u540C\u6B63\u6587"}),(0,e.jsx)(te.Z,{value:"risks",className:"!text-slate-300",children:"\u98CE\u9669\u6458\u8981"}),(0,e.jsx)(te.Z,{value:"suggestions",className:"!text-slate-300",children:"\u4FEE\u6539\u5EFA\u8BAE"}),(0,e.jsx)(te.Z,{value:"legal",className:"!text-slate-300",children:"\u6CD5\u5F8B\u4F9D\u636E"})]})})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,e.jsx)("div",{style:{fontWeight:600,color:"#fff"},children:"\u6B63\u6587\u5305\u542B\u9AD8\u4EAE"}),(0,e.jsx)(Ne.Z,{checked:x?!1:yt,disabled:!!x,onChange:rr}),(0,e.jsx)("span",{style:{color:"rgba(255,255,255,0.4)",fontSize:12},children:x?"\u5DF2\u4FEE\u6539\u6B63\u6587\uFF1A\u9AD8\u4EAE\u4F1A\u56E0\u4F4D\u7F6E\u504F\u79FB\u800C\u5931\u6548":"\u98CE\u9669/\u5EFA\u8BAE/\u6CD5\u6761\u4F1A\u4EE5\u4E0D\u540C\u5E95\u8272\u6807\u8BB0"})]})]})]})})]})},Kt=Ut}}]);
