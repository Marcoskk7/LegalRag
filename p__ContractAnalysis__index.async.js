"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[519],{82194:function(Dt,We,v){v.r(We),v.d(We,{default:function(){return Ln}});var Fn=v(82092),Oe=v.n(Fn),Cn=v(26068),Ge=v.n(Cn),Bn=v(90228),j=v.n(Bn),Sn=v(87999),U=v.n(Sn),wn=v(48305),S=v.n(wn),An=v(335),ye=v.n(An),Nn=v(15558),Ae=v.n(Nn),Dn=v(86980),Q=v(43953),w=v(31707),Ue=v(58979),K=v(97150),Ne=v(74139),kn=v(45011),ve=v(15572),Ve=v(49598),Pn=v(27374),Ye=v(34991),zn=v(96988),Zn=v(71392),he=v(82290),Tn=v(14774),m=v(75271),e=v(52676),de="http://api.legalrag.studio",Rn="".concat(de,"/api/v1/upload"),D=function(x){return x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},Ke=function(x){var z=function(p){return String(p).padStart(2,"0")};return"".concat(x.getFullYear(),"-").concat(z(x.getMonth()+1),"-").concat(z(x.getDate())," ").concat(z(x.getHours()),":").concat(z(x.getMinutes()))},Hn=function(x,z){var X=Ae()(z).sort(function(M,$){return M.range.start-$.range.start}),p="",W=0,C=ye()(X),k;try{for(C.s();!(k=C.n()).done;){var d=k.value;d.range.start<W||d.range.start<0||d.range.end>x.length||d.range.end<=d.range.start||(p+=D(x.substring(W,d.range.start)),p+='<mark class="hl '.concat(d.type,'">').concat(D(x.substring(d.range.start,d.range.end)),"</mark>"),W=d.range.end)}}catch(M){C.e(M)}finally{C.f()}return p+=D(x.substring(W)),p},In=function(x,z){var X,p=[],W=[],C=[],k=(X=z!=null?z:x.raw_content)!==null&&X!==void 0?X:"";return x.risks.forEach(function(d){var M,$,re="risk-".concat(d.identifier),H=d.detected_issue||"",ae=H.match(/^(.{0,25})/),q=ae?ae[1]+(H.length>25?"...":""):"\u98CE\u9669\u63D0\u793A",l=d.legal_basis.map(function(Z,te){return{id:"legal-".concat(d.identifier,"-").concat(te),lawName:Z.law_name,article:Z.order,content:Z.content,score:Z.relevance_score,explanation:void 0,relatedRange:d.highlight_range}});l.forEach(function(Z){W.find(function(te){return te.lawName===Z.lawName&&te.article===Z.article})||W.push(Z)});var oe={id:re,identifier:d.identifier,level:d.level,title:q,content:H,suggestion:d.suggestions,highlightRange:d.highlight_range,legalBasis:l};p.push(oe);var O=(M=d==null?void 0:d.suggested_revision)!==null&&M!==void 0?M:d==null?void 0:d.revised_text,V=d==null?void 0:d.original_text,_=($=d==null?void 0:d.revision_rationale)!==null&&$!==void 0?$:d==null?void 0:d.suggestion_reason;if(O){var G="";if(k&&d.highlight_range){var ie=d.highlight_range,se=ie.start,ee=ie.end;se>=0&&ee<=k.length&&(G=k.substring(se,ee))}V&&(G=V),G?G.length>100&&(G=G.substring(0,100)+"..."):G=H.substring(0,50)+(H.length>50?"...":""),C.push({id:"sug-".concat(d.identifier),original:G,revised:O,reason:_||"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(q),highlightRange:d.highlight_range})}}),{contractText:k||void 0,risks:p,suggestions:C,legalBasis:W}},Mn=function(x,z,X){var p=(z!=null?z:[]).filter(function(T){return X[T.id]==="accepted"}),W=Ae()(p).filter(function(T){return(T==null?void 0:T.highlightRange)&&Number.isFinite(T.highlightRange.start)&&Number.isFinite(T.highlightRange.end)&&T.highlightRange.end>T.highlightRange.start}).sort(function(T,De){return T.highlightRange.start-De.highlightRange.start}),C="",k=0,d=[],M=[],$=[],re=-1,H=ye()(W),ae;try{for(H.s();!(ae=H.n()).done;){var q,l=ae.value,oe=l.highlightRange,O=oe.start,V=oe.end;if(O<0||V>x.length||V<=O){M.push(l.id);continue}if(O<re){M.push(l.id);continue}if(O>k){var _=C.length;C+=x.slice(k,O);var G=C.length;$.push({kind:"copy",baseStart:k,baseEnd:O,outStart:_,outEnd:G})}var ie=C.length,se=(q=l.revised)!==null&&q!==void 0?q:"";C+=se;var ee=C.length;$.push({kind:"replace",suggestionId:l.id,baseStart:O,baseEnd:V,outStart:ie,outEnd:ee}),d.push({suggestionId:l.id,range:{start:ie,end:ee}}),k=V,re=V}}catch(T){H.e(T)}finally{H.f()}if(k<x.length){var Z=C.length;C+=x.slice(k);var te=C.length;$.push({kind:"copy",baseStart:k,baseEnd:x.length,outStart:Z,outEnd:te})}return{text:C,appliedEdits:d,skippedIds:M,segments:$}},$n=function(){var x=(0,Q.useSearchParams)(),z=S()(x,1),X=z[0],p=X.get("fileId"),W=(0,m.useState)(!0),C=S()(W,2),k=C[0],d=C[1],M=(0,m.useState)("init"),$=S()(M,2),re=$[0],H=$[1],ae=(0,m.useState)(null),q=S()(ae,2),l=q[0],oe=q[1],O=(0,m.useState)(""),V=S()(O,2),_=V[0],G=V[1],ie=(0,m.useState)(""),se=S()(ie,2),ee=se[0],Z=se[1],te=(0,m.useState)(!1),T=S()(te,2),De=T[0],be=T[1],Wn=(0,m.useState)(null),Xe=S()(Wn,2),Ee=Xe[0],ke=Xe[1],On=(0,m.useState)("risk"),Je=S()(On,2),me=Je[0],Pe=Je[1],Gn=(0,m.useState)(!1),Qe=S()(Gn,2),Un=Qe[0],ze=Qe[1],Vn=(0,m.useState)(["risks","suggestions","contract"]),qe=S()(Vn,2),_e=qe[0],Yn=qe[1],Kn=(0,m.useState)(!0),en=S()(Kn,2),nn=en[0],Xn=en[1],Jn=(0,m.useState)(null),tn=S()(Jn,2),N=tn[0],Ze=tn[1],Qn=(0,m.useState)(null),rn=S()(Qn,2),g=rn[0],fe=rn[1],qn=(0,m.useState)(!1),an=S()(qn,2),je=an[0],pe=an[1],_n=(0,m.useState)({}),sn=S()(_n,2),ln=sn[0],Te=sn[1],et=(0,m.useState)([]),un=S()(et,2),Re=un[0],Fe=un[1],nt=(0,m.useState)([]),cn=S()(nt,2),tt=cn[0],dn=cn[1],on=(0,m.useRef)(null),fn="contractAnalysis:leftPanePercent",vn=function(t,a,n){return Math.min(n,Math.max(a,t))},rt=(0,m.useState)(function(){try{var s=localStorage.getItem(fn),t=s?Number(s):NaN;if(Number.isFinite(t))return vn(t,25,75)}catch(a){}return 50}),hn=S()(rt,2),He=hn[0],at=hn[1],Ce=(0,m.useRef)(null);(0,m.useEffect)(function(){try{localStorage.setItem(fn,String(He))}catch(s){}},[He]);var it=(0,m.useRef)(null),xe=(0,m.useRef)(null),st=function(t){if(!(t.pointerType==="mouse"&&t.button!==0)){Ce.current={dragging:!0};try{t.currentTarget.setPointerCapture(t.pointerId)}catch(a){}document.body.style.cursor="col-resize",document.body.style.userSelect="none"}},lt=function(t){var a;if((a=Ce.current)!==null&&a!==void 0&&a.dragging){var n=on.current;if(n){var r=n.getBoundingClientRect();if(r.width){var i=(t.clientX-r.left)/r.width*100;at(vn(i,25,75))}}}},gn=function(){var t;(t=Ce.current)!==null&&t!==void 0&&t.dragging&&(Ce.current=null,document.body.style.cursor="",document.body.style.userSelect="")},ut=function(){var s=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(p,"/risks/status"),{method:"GET"});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Fetch status error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},t,null,[[0,6]])}));return function(){return s.apply(this,arguments)}}(),ct=function(){var s=U()(j()().mark(function t(){var a;return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(p,"/content"),{method:"GET"});case 3:return a=r.sent,a!=null&&a.raw_content&&G(a.raw_content),r.abrupt("return",a);case 8:return r.prev=8,r.t0=r.catch(0),console.error("Fetch document content error:",r.t0),r.abrupt("return",null);case 12:case"end":return r.stop()}},t,null,[[0,8]])}));return function(){return s.apply(this,arguments)}}(),dt=function(){var s=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(p,"/risks"),{method:"GET"});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Fetch risks error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},t,null,[[0,6]])}));return function(){return s.apply(this,arguments)}}(),Ie=function(){var s=U()(j()().mark(function t(a){var n;return j()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(p){i.next=2;break}return i.abrupt("return",null);case 2:return i.prev=2,i.next=5,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(p,"/risks/").concat(a),{method:"GET"});case 5:return n=i.sent,i.abrupt("return",n);case 9:return i.prev=9,i.t0=i.catch(2),console.error("Fetch risk detail error:",i.t0),w.ZP.error("\u83B7\u53D6\u98CE\u9669\u8BE6\u60C5\u5931\u8D25"),i.abrupt("return",null);case 14:case"end":return i.stop()}},t,null,[[2,9]])}));return function(a){return s.apply(this,arguments)}}(),mn=function(){var s=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(p,"/risks/analyze"),{method:"POST",data:{top_k:1}});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Trigger analysis error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},t,null,[[0,6]])}));return function(){return s.apply(this,arguments)}}(),ot=function(){var s=U()(j()().mark(function t(){var a,n,r,i,o,u,A,f,I,L,P;return j()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,Promise.all([ct(),dt()]);case 2:if(a=F.sent,n=S()(a,2),r=n[0],i=n[1],!(i&&i.status==="success")){F.next=17;break}if(u=In(i,(o=r==null?void 0:r.raw_content)!==null&&o!==void 0?o:_),oe(u),!(i.risks&&i.risks.length>0)){F.next=15;break}return f=(A=i.risks.find(function(ne){return ne.identifier==="0"}))!==null&&A!==void 0?A:i.risks[0],F.next=13,Ie(f.identifier);case 13:I=F.sent,I&&(Ze(I),L="risk-".concat(f.identifier),Z(L),P=document.getElementById(L),P&&P.scrollIntoView({behavior:"smooth",block:"center"}));case 15:F.next=18;break;case 17:w.ZP.error("\u83B7\u53D6\u5206\u6790\u7ED3\u679C\u5931\u8D25");case 18:d(!1);case 19:case"end":return F.stop()}},t)}));return function(){return s.apply(this,arguments)}}(),ft=function s(){xe.current&&clearTimeout(xe.current),xe.current=setTimeout(U()(j()().mark(function t(){var a;return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ut();case 2:if(a=r.sent,a){r.next=6;break}return s(),r.abrupt("return");case 6:if(a.status!=="success"){r.next=13;break}return H("success"),w.ZP.success("\u5206\u6790\u5B8C\u6210\uFF01"),r.next=11,ot();case 11:r.next=14;break;case 13:a.status==="failed"?(H("failed"),d(!1),w.ZP.error(a.error||"\u5206\u6790\u5931\u8D25")):s();case 14:case"end":return r.stop()}},t)})),2e3)},pn=function(){var s=U()(j()().mark(function t(){var a;return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return H("analyzing"),r.next=3,mn();case 3:if(a=r.sent,a){r.next=11;break}return console.log("First analysis trigger failed, retrying in 1s..."),r.next=8,new Promise(function(i){setTimeout(i,1e3)});case 8:return r.next=10,mn();case 10:a=r.sent;case 11:a&&a.status==="analyzing"?(w.ZP.info("\u5F00\u59CB\u667A\u80FD\u5206\u6790..."),ft()):(H("failed"),d(!1),w.ZP.error("\u89E6\u53D1\u5206\u6790\u5931\u8D25\uFF0C\u53EF\u80FD\u662F\u6587\u6863\u5C1A\u672A\u51C6\u5907\u597D\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"));case 12:case"end":return r.stop()}},t)}));return function(){return s.apply(this,arguments)}}(),vt=function(){var s=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d(!0),n.next=3,pn();case 3:case"end":return n.stop()}},t)}));return function(){return s.apply(this,arguments)}}();(0,m.useEffect)(function(){if(!p){w.ZP.error("\u7F3A\u5C11\u6587\u4EF6ID\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"),Q.history.push("/");return}return fe(null),pe(!1),Te({}),Fe([]),vt(),function(){xe.current&&clearTimeout(xe.current)}},[p]);var ht=function(){var s=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(p){n.next=2;break}return n.abrupt("return");case 2:return d(!0),n.next=5,pn();case 5:case"end":return n.stop()}},t)}));return function(){return s.apply(this,arguments)}}(),gt=function(){Q.history.push("/")},xn=function(t){Pe("risk"),ke(t),be(!0)},mt=function(t){Pe("suggestion"),ke(t),be(!0)},pt=function(t){Pe("legal"),ke(t),be(!0)},yn=function(t,a){if(t==="risk"){var n=l==null?void 0:l.risks.find(function(o){return o.id===a});n&&(Z(a),Ie(n.identifier).then(function(o){o&&Ze(o)}),xn(n))}else if(t==="suggestion"){Z(a);var r=l==null?void 0:l.suggestions.find(function(o){return o.id===a});r&&mt(r)}else if(t==="legal"){Z(a);var i=l==null?void 0:l.legalBasis.find(function(o){return o.id===a});i&&pt(i)}},xt=function(){if(!l||!l.contractText)return _?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:_}):(0,e.jsx)("div",{className:"text-gray-400 text-center py-10",children:"\u6682\u65E0\u5408\u540C\u6587\u672C\u5185\u5BB9"});var t=l.contractText,a=l.risks,n=l.legalBasis,r=[];a.forEach(function(u){r.push({range:u.highlightRange,type:"risk",id:u.id,riskLevel:u.level})}),n.forEach(function(u){r.push({range:u.relatedRange,type:"legal",id:u.id})}),r.sort(function(u,A){return u.range.start-A.range.start});var i=[],o=0;return r.forEach(function(u,A){u.range.start<o||u.range.end>t.length||(u.range.start>o&&i.push((0,e.jsx)("span",{children:t.substring(o,u.range.start)},"text-".concat(A))),i.push((0,e.jsx)("mark",{className:"highlight ".concat(u.type," ").concat(u.type==="risk"&&u.riskLevel?"risk-".concat(u.riskLevel):""," ").concat(ee===u.id?"active":""),id:u.id,onClick:function(){return yn(u.type,u.id)},children:t.substring(u.range.start,u.range.end)},"highlight-".concat(u.id))),o=u.range.end)}),o<t.length&&i.push((0,e.jsx)("span",{children:t.substring(o)},"text-end")),i},Be=function(){return g!=null?g:(l==null?void 0:l.contractText)||_||""},Me=function(){return(l==null?void 0:l.contractText)||_||""},yt=function(){var t=Be();if(!t){w.ZP.warning("\u6682\u65E0\u53EF\u7F16\u8F91\u7684\u5408\u540C\u6587\u672C");return}fe(t),pe(!0)},bt=function(){pe(!1),w.ZP.success("\u5DF2\u5728\u9875\u9762\u4E2D\u4FDD\u5B58\u4FEE\u6539\uFF08\u672A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF09")},bn=function(){fe(null),pe(!1),Fe([]),Te({}),w.ZP.info("\u5DF2\u64A4\u9500\u4FEE\u6539")},Et=function(t){var a;return(a=ln[t])!==null&&a!==void 0?a:"undecided"},jt=function(t){var a=Me();if(!(!l||!a)){var n=Mn(a,l.suggestions,t),r=n.text,i=n.appliedEdits,o=n.skippedIds,u=n.segments;fe(r),pe(!1),Fe(i),dn(u),o.length&&w.ZP.warning("\u6709 ".concat(o.length," \u6761\u5EFA\u8BAE\u56E0\u8303\u56F4\u91CD\u53E0/\u5F02\u5E38\u672A\u80FD\u5E94\u7528"))}},$e=function(t,a){if(l){if(je){w.ZP.warning("\u8BF7\u5148\u70B9\u51FB\u201C\u5B8C\u6210/\u64A4\u9500\u201D\u9000\u51FA\u624B\u52A8\u7F16\u8F91\uFF0C\u518D\u8FDB\u884C\u5EFA\u8BAE\u91C7\u7EB3");return}var n=Ge()(Ge()({},ln),{},Oe()({},t,a));Te(n);var r=Object.values(n).some(function(i){return i==="accepted"});if(!r){dn([]),fe(null),Fe([]);return}jt(n)}},Ft=function(){var t,a;if(!g)return null;if(!Re.length){var n=Me();if(!n||n===g)return(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:g});for(var r=Math.min(n.length,g.length),i=0;i<r&&n[i]===g[i];)i+=1;for(var o=0;o<r-i&&n[n.length-1-o]===g[g.length-1-o];)o+=1;var u=i,A=g.length-o;return A<=u?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:g}):(0,e.jsxs)("div",{className:"whitespace-pre-wrap",children:[(0,e.jsx)("span",{children:g.slice(0,u)}),(0,e.jsx)("mark",{className:"highlight edit",children:g.slice(u,A)}),(0,e.jsx)("span",{children:g.slice(A)})]})}var f=function(c){var b=ye()(tt),R;try{for(b.s();!(R=b.n()).done;){var E=R.value;if(!(c<E.baseStart||c>E.baseEnd)){if(E.kind!=="copy")return null;var J=c-E.baseStart,Y=E.outStart+J;return Y<E.outStart||Y>E.outEnd?null:Y}}}catch(ce){b.e(ce)}finally{b.f()}return null},I=function(c){var b=f(c.start),R=f(c.end);return b===null||R===null||R<=b?null:{start:b,end:R}},L=function(c,b){return c.start<b.end&&b.start<c.end},P=function(c,b){var R=[],E=c.start,J=ye()(b),Y;try{for(J.s();!(Y=J.n()).done;){var ce=Y.value;if(!(ce.end<=E)){if(ce.start>=c.end)break;if(L({start:E,end:c.end},ce)){var jn=Math.min(ce.start,c.end);if(jn>E&&R.push({start:E,end:jn}),E=Math.max(E,ce.end),E>=c.end)break}}}}catch(we){J.e(we)}finally{J.f()}return E<c.end&&R.push({start:E,end:c.end}),R.filter(function(we){return we.end>we.start})},B=Ae()(Re).map(function(h){return h.range}).filter(function(h){return h.end>h.start}).sort(function(h,c){return h.start-c.start}),F=[];Re.forEach(function(h){h.range.end<=h.range.start||F.push({key:"edit-".concat(h.suggestionId),range:h.range,type:"edit",id:"edit-".concat(h.suggestionId),suggestionId:h.suggestionId})});var ne=(t=l==null?void 0:l.risks)!==null&&t!==void 0?t:[],le=(a=l==null?void 0:l.legalBasis)!==null&&a!==void 0?a:[];ne.forEach(function(h){var c=I(h.highlightRange);if(c){var b=P(c,B);b.forEach(function(R,E){F.push({key:"".concat(h.id,"__").concat(E),range:R,type:"risk",id:h.id,riskLevel:h.level})})}}),le.forEach(function(h){var c=I(h.relatedRange);if(c){var b=P(c,B);b.forEach(function(R,E){F.push({key:"".concat(h.id,"__").concat(E),range:R,type:"legal",id:h.id})})}}),F.sort(function(h,c){return h.range.start!==c.range.start?h.range.start-c.range.start:h.type==="edit"&&c.type!=="edit"?-1:c.type==="edit"&&h.type!=="edit"?1:h.range.end-c.range.end});for(var ue=[],y=0,Le=function(){var c=F[Se];if(c.range.start<y||c.range.end>g.length)return 0;if(c.range.start>y&&ue.push((0,e.jsx)("span",{children:g.slice(y,c.range.start)},"mix-text-".concat(Se))),c.type==="edit"){var b=c.suggestionId;ue.push((0,e.jsx)("mark",{id:"edit-".concat(b),className:"highlight edit ".concat(ee==="edit-".concat(b)?"active":""),onClick:function(){Z("edit-".concat(b));var E=b.replace(/^sug-/,""),J=l==null?void 0:l.risks.find(function(Y){return Y.identifier===E});J&&(Ie(J.identifier).then(function(Y){Y&&Ze(Y)}),xn(J))},children:g.slice(c.range.start,c.range.end)},"mix-edit-".concat(b)))}else ue.push((0,e.jsx)("mark",{className:"highlight ".concat(c.type," ").concat(c.type==="risk"&&c.riskLevel?"risk-".concat(c.riskLevel):""," ").concat(ee===c.id?"active":""),id:c.id,onClick:function(){return yn(c.type,c.id)},children:g.slice(c.range.start,c.range.end)},c.key));y=c.range.end},En,Se=0;Se<F.length;Se+=1)En=Le();return y<g.length&&ue.push((0,e.jsx)("span",{children:g.slice(y)},"mix-text-end")),(0,e.jsx)("div",{className:"whitespace-pre-wrap",children:ue})},Ct=function(){var s=U()(j()().mark(function t(){var a,n,r,i,o,u;return j()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(a=g,a){f.next=4;break}return w.ZP.warning("\u8BF7\u5148\u7F16\u8F91\u6216\u5E94\u7528\u5EFA\u8BAE"),f.abrupt("return");case 4:return f.prev=4,d(!0),r=new FormData,i=new File([a],"edited-".concat(p||"contract",".txt"),{type:"text/plain"}),r.append("file",i),f.next=11,fetch(Rn,{method:"POST",body:r});case 11:if(o=f.sent,o.ok){f.next=14;break}throw new Error("HTTP ".concat(o.status));case 14:return f.next=16,o.json();case 16:if(u=f.sent,!(u!=null&&u.success&&u!==null&&u!==void 0&&(n=u.data)!==null&&n!==void 0&&n.uuid)){f.next=21;break}return w.ZP.success("\u5DF2\u4E0A\u4F20\u4FEE\u6539\u7248\uFF0C\u5F00\u59CB\u91CD\u65B0\u5206\u6790"),Q.history.push("/contract-analysis?fileId=".concat(u.data.uuid)),f.abrupt("return");case 21:d(!1),w.ZP.error((u==null?void 0:u.message)||"\u4E0A\u4F20\u5931\u8D25"),f.next=30;break;case 25:f.prev=25,f.t0=f.catch(4),console.error(f.t0),d(!1),w.ZP.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 30:case"end":return f.stop()}},t,null,[[4,25]])}));return function(){return s.apply(this,arguments)}}(),Bt=function(){if(!l)return[];var t=l.risks,a=l.suggestions,n=l.legalBasis,r=[];return t.forEach(function(i){r.push({range:i.highlightRange,type:"risk",id:i.id})}),a.forEach(function(i){r.push({range:i.highlightRange,type:"suggestion",id:i.id})}),n.forEach(function(i){r.push({range:i.relatedRange,type:"legal",id:i.id})}),r.sort(function(i,o){return i.range.start-o.range.start}),r},St=function(){var t,a,n,r=new Date,i=Be(),o=nn&&!g,u=new Set(_e),A=u.has("contract"),f=u.has("risks"),I=u.has("suggestions"),L=u.has("legal"),P="\u5408\u540C\u5206\u6790\u7ED3\u679C\uFF08\u5BFC\u51FA\uFF09",B="\u5BFC\u51FA\u65F6\u95F4\uFF1A".concat(Ke(r)).concat(p?" \xB7 \u6587\u4EF6ID\uFF1A".concat(D(p)):""),F=f?((t=l==null?void 0:l.risks)!==null&&t!==void 0?t:[]).map(function(y){var Le=y.level==="high"?"\u9AD8\u98CE\u9669":y.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669";return`
              <div class="item">
                <div class="item-title">
                  <span class="badge `.concat(D(y.level),'">').concat(Le,`</span>
                  <span class="item-head">`).concat(D(y.title),`</span>
                </div>
                <div class="item-body">`).concat(D(y.content),`</div>
                `).concat(y.suggestion?'<div class="item-sub"><span class="muted">\u5EFA\u8BAE\uFF1A</span>'.concat(D(y.suggestion),"</div>"):"",`
              </div>
            `)}).join(""):"",ne=I?((a=l==null?void 0:l.suggestions)!==null&&a!==void 0?a:[]).map(function(y){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge info">\u4FEE\u6539\u5EFA\u8BAE</span>
                  <span class="item-head">`.concat(D(y.reason||"\u5EFA\u8BAE"),`</span>
                </div>
                <div class="diff">
                  <div class="diff-row">
                    <div class="diff-label">\u539F\u6587</div>
                    <div class="diff-content original">`).concat(D(y.original),`</div>
                  </div>
                  <div class="diff-row">
                    <div class="diff-label">\u4FEE\u6539\u4E3A</div>
                    <div class="diff-content revised">`).concat(D(y.revised),`</div>
                  </div>
                </div>
              </div>
            `)}).join(""):"",le=L?((n=l==null?void 0:l.legalBasis)!==null&&n!==void 0?n:[]).map(function(y){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge legal">\u6CD5\u5F8B\u4F9D\u636E</span>
                  <span class="item-head">`.concat(D(y.lawName)," ").concat(D(y.article),`</span>
                </div>
                <div class="item-body">`).concat(D(y.content),`</div>
                <div class="item-sub"><span class="muted">\u76F8\u5173\u5EA6\uFF1A</span>`).concat((y.score*100).toFixed(0),`%</div>
              </div>
            `)}).join(""):"",ue=A?o&&l?'<div class="contract-text"><div class="contract-pre">'.concat(Hn(i,Bt()).replace(/\n/g,"<br/>"),"</div></div>"):'<div class="contract-text"><div class="contract-pre">'.concat(D(i).replace(/\n/g,"<br/>"),"</div></div>"):"";return`
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>`.concat(D(P),`</title>
    <style>
      @page { margin: 16mm 14mm; }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
        color: #111827;
        line-height: 1.55;
      }
      .header { margin-bottom: 14px; }
      .title { font-size: 18px; font-weight: 700; margin: 0 0 4px 0; }
      .subtitle { font-size: 12px; color: #6b7280; margin: 0; }
      .section { margin-top: 14px; }
      .section-title { font-size: 13px; font-weight: 700; margin: 0 0 8px 0; }
      .divider { height: 1px; background: #e5e7eb; margin: 10px 0; }
      .item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px 12px; margin: 10px 0; break-inside: avoid; }
      .item-title { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
      .item-head { font-weight: 700; }
      .item-body { font-size: 12px; color: #111827; }
      .item-sub { font-size: 12px; color: #374151; margin-top: 6px; }
      .muted { color: #6b7280; }
      .badge { display: inline-block; font-size: 11px; padding: 2px 8px; border-radius: 999px; border: 1px solid #e5e7eb; background: #f9fafb; color: #111827; }
      .badge.high { background: #fff1f2; border-color: #fecdd3; color: #9f1239; }
      .badge.medium { background: #fff7ed; border-color: #fed7aa; color: #9a3412; }
      .badge.low { background: #f0fdf4; border-color: #bbf7d0; color: #166534; }
      .badge.info { background: #eff6ff; border-color: #bfdbfe; color: #1d4ed8; }
      .badge.legal { background: #f5f3ff; border-color: #ddd6fe; color: #5b21b6; }
      .diff { margin-top: 6px; }
      .diff-row { display: flex; gap: 10px; margin-top: 6px; }
      .diff-label { width: 52px; font-size: 12px; color: #6b7280; flex: 0 0 auto; }
      .diff-content { font-size: 12px; padding: 8px 10px; border-radius: 6px; border: 1px solid #e5e7eb; width: 100%; }
      .diff-content.original { background: #fff1f2; border-color: #fecdd3; }
      .diff-content.revised { background: #f0fdf4; border-color: #bbf7d0; }
      .contract-text { margin-top: 8px; }
      .contract-pre { font-size: 12px; white-space: normal; word-break: break-word; }
      mark.hl { padding: 0 2px; border-radius: 3px; }
      mark.hl.risk { background: #ffe4e6; }
      mark.hl.suggestion { background: #dbeafe; }
      mark.hl.legal { background: #ede9fe; }
      .print-hint { font-size: 12px; color: #6b7280; margin-top: 10px; }
      .footer { position: fixed; bottom: 0; left: 0; right: 0; font-size: 10px; color: #9ca3af; }
      .footer-inner { display: flex; justify-content: space-between; }
      @media print {
        .no-print { display: none !important; }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="title">`).concat(D(P),`</div>
      <p class="subtitle">`).concat(B,`</p>
      <div class="print-hint no-print">\u63D0\u793A\uFF1A\u5728\u6253\u5370\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002</div>
      <div class="divider"></div>
    </div>

    `).concat(f?'<div class="section"><div class="section-title">\u98CE\u9669\u6458\u8981</div>'.concat(F||'<div class="muted">\u6682\u65E0\u98CE\u9669</div>',"</div>"):"",`
    `).concat(I?'<div class="section"><div class="section-title">\u4FEE\u6539\u5EFA\u8BAE</div>'.concat(ne||'<div class="muted">\u6682\u65E0\u4FEE\u6539\u5EFA\u8BAE</div>',"</div>"):"",`
    `).concat(L?'<div class="section"><div class="section-title">\u6CD5\u5F8B\u4F9D\u636E</div>'.concat(le||'<div class="muted">\u6682\u65E0\u6CD5\u5F8B\u4F9D\u636E</div>',"</div>"):"",`
    `).concat(A?'<div class="section"><div class="section-title">\u5408\u540C\u6B63\u6587</div>'.concat(ue||'<div class="muted">\u6682\u65E0\u6B63\u6587</div>',"</div>"):"",`

    <div class="footer">
      <div class="footer-inner">
        <span>LegalRag</span>
        <span>`).concat(Ke(r),`</span>
      </div>
    </div>
  </body>
</html>
    `).trim()},wt=function(){var t,a=Be();if(!a){w.ZP.error("\u6682\u65E0\u53EF\u5BFC\u51FA\u7684\u5408\u540C\u6587\u672C");return}var n=St(),r=document.createElement("iframe");r.style.position="fixed",r.style.right="0",r.style.bottom="0",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);var i=r.contentDocument||((t=r.contentWindow)===null||t===void 0?void 0:t.document);if(!i){w.ZP.error("\u65E0\u6CD5\u521B\u5EFA\u6253\u5370\u6587\u6863"),document.body.removeChild(r);return}i.open(),i.write(n),i.close(),r.onload=function(){setTimeout(function(){try{if(!r.contentWindow)return;r.contentWindow.focus(),r.contentWindow.print()}catch(o){console.error("Print error:",o),w.ZP.error("\u6253\u5370\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}finally{setTimeout(function(){document.body.contains(r)&&document.body.removeChild(r)},1e3)}},300)}},At=function(){if(!Ee)return null;if(me==="risk"){var t,a,n=Ee,r=(t=n.legalBasis)!==null&&t!==void 0?t:[],i=r.length>0,o="sug-".concat(n.identifier),u=l==null||(a=l.suggestions)===null||a===void 0?void 0:a.find(function(B){return B.id===o}),A=(N==null?void 0:N.identifier)===n.identifier&&N!==null&&N!==void 0&&N.suggested_revision?{id:o,original:function(){var B=Me(),F=n.highlightRange||{start:0,end:0},ne=F.start,le=F.end;return B&&ne>=0&&le>ne&&le<=B.length?B.slice(ne,le):""}(),revised:N.suggested_revision,reason:"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(n.title),highlightRange:n.highlightRange}:null,f=A!=null?A:u,I=f?Et(f.id):"undecided";return(0,e.jsxs)("div",{className:"detail-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(Ue.Z,{color:n.level==="high"?"red":n.level==="medium"?"orange":"green",children:n.level==="high"?"\u9AD8\u98CE\u9669":n.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u98CE\u9669\u63CF\u8FF0"}),(0,e.jsx)("div",{className:"section-content",children:n.content})]}),n.suggestion&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u5EFA\u8BAE\u63AA\u65BD"}),(0,e.jsx)("div",{className:"section-content",children:n.suggestion})]}),f?(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u5177\u4F53\u4FEE\u6539\u65B9\u6848"}),(0,e.jsxs)("div",{className:"diff-display",style:{marginBottom:10},children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original",children:f.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised",children:f.revised})]})]}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:(0,e.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,e.jsx)(K.ZP,{size:"middle",className:I==="accepted"?"!h-9 !rounded-lg !bg-brand-600 hover:!bg-brand-700 !text-white !border-brand-600":"!h-9 !rounded-lg !bg-white hover:!bg-slate-50 !text-slate-700 !border-slate-200",onClick:function(){$e(f.id,I==="accepted"?"undecided":"accepted")},children:"\u91C7\u7EB3"}),(0,e.jsx)(K.ZP,{size:"middle",className:I==="rejected"?"!h-9 !rounded-lg !bg-slate-800 hover:!bg-slate-900 !text-white !border-slate-800":"!h-9 !rounded-lg !bg-white hover:!bg-slate-50 !text-slate-700 !border-slate-200",onClick:function(){$e(f.id,I==="rejected"?"undecided":"rejected")},children:"\u4E0D\u91C7\u7EB3"}),(0,e.jsx)(K.ZP,{size:"middle",className:"!h-9 !rounded-lg",onClick:function(){$e(f.id,"undecided")},children:"\u6E05\u9664\u9009\u62E9"})]})})]}):null,i&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content",children:r.map(function(B){return(0,e.jsxs)("div",{style:{marginBottom:8},children:[(0,e.jsxs)("div",{style:{fontWeight:600},children:[B.lawName," ",B.article]}),(0,e.jsx)("div",{style:{margin:"6px 0",fontSize:12,color:"#666"},children:B.content}),(0,e.jsxs)("div",{className:"legal-score",children:[(0,e.jsx)(Ne.Z,{disabled:!0,allowHalf:!0,value:B.score*5,style:{fontSize:12}}),(0,e.jsxs)("span",{style:{marginLeft:8,fontSize:12},children:["\u76F8\u5173\u5EA6: ",(B.score*100).toFixed(0),"%"]})]})]},B.id)})})]})]})}if(me==="suggestion"){var L=Ee;return(0,e.jsxs)("div",{className:"detail-modal",children:[(0,e.jsxs)("div",{className:"diff-display",children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original",children:L.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised",children:L.revised})]})]}),L.reason&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u4FEE\u6539\u7406\u7531"}),(0,e.jsx)("div",{className:"section-content",children:L.reason})]})]})}if(me==="legal"){var P=Ee;return(0,e.jsxs)("div",{className:"detail-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u6CD5\u5F8B\u540D\u79F0"}),(0,e.jsx)("div",{className:"section-content",children:P.lawName})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u6761\u6B3E"}),(0,e.jsx)("div",{className:"section-content",children:P.article})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u6CD5\u6761\u5185\u5BB9"}),(0,e.jsx)("div",{className:"section-content",children:P.content})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u76F8\u5173\u5EA6\u8BC4\u5206"}),(0,e.jsxs)("div",{className:"legal-score",children:[(0,e.jsx)(Ne.Z,{disabled:!0,allowHalf:!0,value:P.score*5}),(0,e.jsxs)("span",{style:{marginLeft:8},children:[(P.score*100).toFixed(0),"%"]})]})]}),P.explanation&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u9002\u7528\u8BF4\u660E"}),(0,e.jsx)("div",{className:"section-content",children:P.explanation})]})]})}},Nt=function(){return me==="risk"?"\u98CE\u9669\u8BE6\u60C5":me==="suggestion"?"\u4FEE\u6539\u5EFA\u8BAE\u8BE6\u60C5":"\u6CD5\u5F8B\u4F9D\u636E\u8BE6\u60C5"};return k?(0,e.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white flex items-center justify-center px-4",children:(0,e.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white border border-slate-100 shadow-xl px-8 py-10 text-center space-y-4",children:[(0,e.jsx)("div",{className:"bg-gradient-to-r from-brand-600 to-blue-500 inline-flex items-center justify-center rounded-full px-4 py-1 text-xs font-medium text-white",children:re==="analyzing"?"\u5408\u540C\u667A\u80FD\u5206\u6790\u8FDB\u884C\u4E2D\u2026":"\u6B63\u5728\u51C6\u5907\u5206\u6790..."}),(0,e.jsx)("p",{className:"text-sm text-slate-500",children:"\u6211\u4EEC\u6B63\u5728\u4E3A\u60A8\u89E3\u6790\u5408\u540C\u6761\u6B3E\u5E76\u751F\u6210\u98CE\u9669\u63D0\u793A\u3001\u4FEE\u6539\u610F\u89C1\u4E0E\u6CD5\u5F8B\u4F9D\u636E\uFF0C\u8BF7\u7A0D\u5019\u3002"}),(0,e.jsx)("div",{className:"flex justify-center pt-2",children:(0,e.jsx)(kn.Z,{size:"large",tip:re==="analyzing"?"\u6B63\u5728\u5206\u6790\u5408\u540C...":"\u6B63\u5728\u52A0\u8F7D..."})})]})}):(0,e.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white px-4 py-6",children:(0,e.jsxs)("div",{className:"mx-auto max-w-7xl rounded-2xl bg-white border border-slate-100 shadow-xl overflow-hidden",children:[(0,e.jsxs)("div",{className:"bg-gradient-to-r from-brand-600 to-blue-500 px-6 py-4 flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-xs font-semibold tracking-wide text-brand-50/80 uppercase",children:"LegalRag"}),(0,e.jsx)("p",{className:"text-sm text-brand-50",children:"\u5408\u540C\u5206\u6790\u7ED3\u679C"})]}),(0,e.jsx)("span",{className:"rounded-full border border-white/30 bg-white/10 px-3 py-1 text-xs text-brand-50",children:"\u98CE\u9669\u63D0\u793A \xB7 \u4FEE\u6539\u610F\u89C1 \xB7 \u6CD5\u5F8B\u4F9D\u636E"})]}),(0,e.jsx)("div",{className:"contract-analysis px-4 pb-4 pt-2",children:(0,e.jsxs)(Dn._z,{header:{title:"\u5408\u540C\u5206\u6790\u7ED3\u679C",onBack:gt,extra:[(0,e.jsx)(K.ZP,{type:"default",style:{background:"#ffffff",borderColor:"#d9d9d9",color:"#1677ff",fontWeight:600},onClick:function(){return ze(!0)},children:"\u5BFC\u51FA PDF"},"exportPdf"),(0,e.jsx)(K.ZP,{onClick:ht,children:"\u91CD\u65B0\u5206\u6790"},"reanalyze")]},children:[l&&(0,e.jsx)("div",{className:"analysis-content",children:(0,e.jsxs)("div",{className:"split-grid",ref:on,style:Oe()({},"--left-pane","".concat(He,"%")),children:[(0,e.jsx)("div",{className:"split-left",children:(0,e.jsx)(ve.Z,{title:"\u5408\u540C\u6587\u672C",bordered:!1,extra:(0,e.jsxs)(Ve.Z,{children:[je?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(K.ZP,{size:"small",type:"primary",onClick:bt,children:"\u5B8C\u6210"}),(0,e.jsx)(K.ZP,{size:"small",onClick:bn,children:"\u64A4\u9500"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(K.ZP,{size:"small",onClick:yt,children:"\u7F16\u8F91"}),g?(0,e.jsx)(K.ZP,{size:"small",onClick:bn,children:"\u64A4\u9500\u4FEE\u6539\u7248"}):null]}),g&&!je?(0,e.jsx)(K.ZP,{size:"small",onClick:Ct,children:"\u7528\u4FEE\u6539\u7248\u91CD\u65B0\u5206\u6790"}):null]}),children:(0,e.jsx)("div",{className:"contract-text-panel",ref:it,children:je?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-xs text-slate-500",children:"\u63D0\u793A\uFF1A\u7F16\u8F91/\u5E94\u7528\u5EFA\u8BAE\u540E\uFF0C\u672C\u9875\u9AD8\u4EAE\u5B9A\u4F4D\u5C06\u4E0D\u518D\u51C6\u786E\u3002"}),(0,e.jsx)(Pn.Z.TextArea,{value:g!=null?g:Be(),onChange:function(t){return fe(t.target.value)},autoSize:{minRows:18,maxRows:28}})]}):g?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-xs text-slate-500",children:"\u5DF2\u751F\u6210\u4FEE\u6539\u7248\u6B63\u6587\uFF08\u7EFF\u8272\u9AD8\u4EAE\u4E3A\u5DF2\u91C7\u7EB3\u7684\u4FEE\u6539\u5185\u5BB9\uFF09\u3002"}),Ft()]}):xt()})})}),(0,e.jsx)("div",{className:"split-resizer",role:"separator","aria-orientation":"vertical","aria-label":"\u8C03\u6574\u5408\u540C\u6587\u672C\u533A\u57DF\u5BBD\u5EA6",onPointerDown:st,onPointerMove:lt,onPointerUp:gn,onPointerCancel:gn}),(0,e.jsx)("div",{className:"split-right",children:(0,e.jsx)("div",{className:"analysis-panel",children:(0,e.jsx)(ve.Z,{title:"\u98CE\u9669\u8BE6\u60C5",bordered:!1,style:{marginBottom:16},bodyStyle:{padding:"20px"},children:N?(0,e.jsxs)("div",{className:"detail-container",children:[(0,e.jsxs)("div",{className:"modal-section",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,e.jsx)("span",{style:{fontSize:16,fontWeight:600},children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(Ue.Z,{color:N.level==="high"?"#f5222d":N.level==="medium"?"#fa8c16":"#52c41a",style:{padding:"4px 16px",fontSize:14,borderRadius:12,marginRight:0},children:N.level==="high"?"\u9AD8\u98CE\u9669":N.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsx)(ve.Z,{type:"inner",title:(0,e.jsx)("span",{style:{color:"#cf1322"},children:"\u{1F6A8} \u98CE\u9669\u63CF\u8FF0"}),size:"small",style:{marginBottom:16,backgroundColor:"#fff1f0",borderColor:"#ffa39e"},children:(0,e.jsx)("div",{style:{lineHeight:"1.6",color:"#333"},children:N.detected_issue})}),N.suggestions&&(0,e.jsx)(ve.Z,{type:"inner",title:(0,e.jsx)("span",{style:{color:"#d48806"},children:"\u{1F4A1} \u5EFA\u8BAE\u63AA\u65BD"}),size:"small",style:{marginBottom:16,backgroundColor:"#feffe6",borderColor:"#fffb8f"},children:(0,e.jsx)("div",{style:{lineHeight:"1.6",color:"#333"},children:N.suggestions})}),N.legal_basis&&N.legal_basis.length>0&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-title",style:{fontSize:15,fontWeight:600,marginBottom:12,marginTop:24},children:"\u2696\uFE0F \u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content",children:N.legal_basis.map(function(s,t){return(0,e.jsxs)(ve.Z,{size:"small",hoverable:!0,className:"legal-card",style:{marginBottom:12,borderRadius:6,borderLeft:"4px solid #1890ff"},children:[(0,e.jsxs)("div",{style:{fontWeight:600,color:"#262626",marginBottom:4},children:[s.law_name," ",s.order]}),(0,e.jsx)("div",{style:{fontSize:13,color:"#666",marginBottom:8,lineHeight:"1.5"},children:s.content}),(0,e.jsxs)("div",{className:"legal-score",style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Ne.Z,{disabled:!0,allowHalf:!0,value:(s.relevance_score||0)*5,style:{fontSize:12}}),(0,e.jsxs)("span",{style:{marginLeft:8,fontSize:12,color:"#8c8c8c"},children:["\u76F8\u5173\u5EA6:"," ",((s.relevance_score||0)*100).toFixed(0),"%"]})]})]},t)})})]})]}):(0,e.jsxs)("div",{className:"text-gray-400 text-center py-12",children:[(0,e.jsx)("div",{style:{fontSize:40,marginBottom:16},children:"\u{1F4CB}"}),(0,e.jsx)("div",{children:"\u6682\u65E0\u98CE\u9669\u8BE6\u60C5"}),(0,e.jsx)("div",{style:{fontSize:12,marginTop:8},children:"\u70B9\u51FB\u5DE6\u4FA7\u5408\u540C\u5185\u5BB9\u7684\u6807\u8BB0\u5904\u67E5\u770B"})]})})})})]})}),(0,e.jsx)(Ye.Z,{title:Nt(),open:De,onCancel:function(){return be(!1)},footer:null,width:700,children:At()}),(0,e.jsxs)(Ye.Z,{title:"\u5BFC\u51FA PDF",open:Un,onCancel:function(){return ze(!1)},okText:"\u5F00\u59CB\u5BFC\u51FA",cancelText:"\u53D6\u6D88",okButtonProps:{style:{backgroundColor:"#fff",color:"#1677ff",border:"1px solid #d9d9d9"}},onOk:function(){ze(!1),wt()},children:[(0,e.jsx)(zn.Z.Paragraph,{style:{marginBottom:10,color:"#6b7280"},children:"\u70B9\u51FB\u201C\u5F00\u59CB\u5BFC\u51FA\u201D\u540E\u5C06\u81EA\u52A8\u5F39\u51FA\u6253\u5370\u5BF9\u8BDD\u6846\uFF0C\u5728\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002"}),(0,e.jsx)(Zn.Z,{style:{margin:"12px 0"}}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsx)("div",{style:{fontWeight:600,marginBottom:8},children:"\u5BFC\u51FA\u5185\u5BB9"}),(0,e.jsx)(he.Z.Group,{value:_e,onChange:function(t){var a=t;a.includes("contract")||a.push("contract"),Yn(Array.from(new Set(a)))},children:(0,e.jsxs)(Ve.Z,{wrap:!0,children:[(0,e.jsx)(he.Z,{value:"contract",children:"\u5408\u540C\u6B63\u6587"}),(0,e.jsx)(he.Z,{value:"risks",children:"\u98CE\u9669\u6458\u8981"}),(0,e.jsx)(he.Z,{value:"suggestions",children:"\u4FEE\u6539\u5EFA\u8BAE"}),(0,e.jsx)(he.Z,{value:"legal",children:"\u6CD5\u5F8B\u4F9D\u636E"})]})})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,e.jsx)("div",{style:{fontWeight:600},children:"\u6B63\u6587\u5305\u542B\u9AD8\u4EAE"}),(0,e.jsx)(Tn.Z,{checked:g?!1:nn,disabled:!!g,onChange:Xn}),(0,e.jsx)("span",{style:{color:"#6b7280",fontSize:12},children:g?"\u5DF2\u4FEE\u6539\u6B63\u6587\uFF1A\u9AD8\u4EAE\u4F1A\u56E0\u4F4D\u7F6E\u504F\u79FB\u800C\u5931\u6548":"\u98CE\u9669/\u5EFA\u8BAE/\u6CD5\u6761\u4F1A\u4EE5\u4E0D\u540C\u5E95\u8272\u6807\u8BB0"})]})]})]})})]})})},Ln=$n}}]);
