"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[519],{4315:function(Mt,He,g){g.d(He,{Z:function(){return Qe}});var Ce=g(75271),je=g(52676);function Qe(Q){var qe=Q.className,Be=Q.gap,q=Be===void 0?24:Be,Ae=Q.radius,$e=Ae===void 0?1.5:Ae,y=Q.color,Le=y===void 0?"rgba(255,255,255,0.02)":y,L=Q.glowColor,De=L===void 0?"rgba(255, 255, 255, 0.15)":L,w=Q.speedScale,Se=w===void 0?.5:w,X=(0,Ce.useRef)(null),D=(0,Ce.useRef)(null);return(0,Ce.useEffect)(function(){var ne=X.current,te=D.current;if(!(!ne||!te)){var F=ne.getContext("2d");if(F){var ve=0,we=window.devicePixelRatio||1,Oe=function(){var x=te.getBoundingClientRect(),W=x.width,ue=x.height;ne.width=W*we,ne.height=ue*we,ne.style.width="".concat(W,"px"),ne.style.height="".concat(ue,"px"),F.scale(we,we)},ke=new ResizeObserver(Oe);ke.observe(te),Oe();var Pe=[],Re=function(){Pe=[];for(var x=te.getBoundingClientRect(),W=x.width,ue=x.height,fe=-q;fe<W+q;fe+=q)for(var de=-q;de<ue+q;de+=q){var ce=fe+(Math.floor(de/q)%2===0?0:q*.5);Pe.push({x:ce,y:de,phase:Math.random()*Math.PI*2,speed:.5+Math.random()*.5})}};Re(),window.addEventListener("resize",Re);var he=function Ze(x){var W=te.getBoundingClientRect(),ue=W.width,fe=W.height;F.clearRect(0,0,ue,fe);var de=x/1e3*Se;Pe.forEach(function(ce){var ze=(Math.sin(de*ce.speed+ce.phase)+1)/2;F.beginPath(),F.arc(ce.x,ce.y,$e,0,Math.PI*2),ze>.8?(F.fillStyle=De,F.shadowColor=De,F.shadowBlur=15):(F.fillStyle=Le,F.shadowBlur=0),F.fill()}),ve=requestAnimationFrame(Ze)};return ve=requestAnimationFrame(he),function(){cancelAnimationFrame(ve),window.removeEventListener("resize",Re),ke.disconnect()}}}},[q,$e,Le,De,Se]),(0,je.jsx)("div",{ref:D,className:qe,style:{position:"absolute",inset:0,zIndex:0,pointerEvents:"none"},children:(0,je.jsx)("canvas",{ref:X,style:{display:"block"}})})}},85166:function(Mt,He,g){g.r(He),g.d(He,{default:function(){return Gt}});var Ce=g(15558),je=g.n(Ce),Qe=g(335),Q=g.n(Qe),qe=g(82092),Be=g.n(qe),q=g(26068),Ae=g.n(q),$e=g(90228),y=g.n($e),Le=g(87999),L=g.n(Le),De=g(48305),w=g.n(De),Se=g(4315),X=g(43953),D=g(31707),ne=g(58979),te=g(49598),F=g(97150),ve=g(74139),we=g(45011),Oe=g(27374),ke=g(34991),Pe=g(96988),Re=g(71392),he=g(82290),Ze=g(14774),x=g(75271),W="http://api.legalrag.studio",ue="".concat(W,"/api/v1/upload"),fe=function(){var z=L()(y()().mark(function h(m){return y()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,X.request)("".concat(W,"/api/v1/documents/").concat(m,"/risks/status"),{method:"GET"});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Fetch status error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},h,null,[[0,6]])}));return function(m){return z.apply(this,arguments)}}(),de=function(){var z=L()(y()().mark(function h(m){var N;return y()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.prev=0,E.next=3,(0,X.request)("".concat(W,"/api/v1/documents/").concat(m,"/content"),{method:"GET"});case 3:return N=E.sent,E.abrupt("return",N);case 7:return E.prev=7,E.t0=E.catch(0),console.error("Fetch document content error:",E.t0),E.abrupt("return",null);case 11:case"end":return E.stop()}},h,null,[[0,7]])}));return function(m){return z.apply(this,arguments)}}(),ce=function(){var z=L()(y()().mark(function h(m){return y()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,X.request)("".concat(W,"/api/v1/documents/").concat(m,"/risks"),{method:"GET"});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Fetch risks error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},h,null,[[0,6]])}));return function(m){return z.apply(this,arguments)}}(),ze=function(){var z=L()(y()().mark(function h(m,N){var n;return y()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(m){v.next=2;break}return v.abrupt("return",null);case 2:return v.prev=2,v.next=5,(0,X.request)("".concat(W,"/api/v1/documents/").concat(m,"/risks/").concat(N),{method:"GET"});case 5:return n=v.sent,v.abrupt("return",n);case 9:return v.prev=9,v.t0=v.catch(2),console.error("Fetch risk detail error:",v.t0),v.abrupt("return",null);case 13:case"end":return v.stop()}},h,null,[[2,9]])}));return function(m,N){return z.apply(this,arguments)}}(),ct=function(){var z=L()(y()().mark(function h(m){return y()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,X.request)("".concat(W,"/api/v1/documents/").concat(m,"/risks/analyze"),{method:"POST",data:{top_k:1}});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Trigger analysis error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},h,null,[[0,6]])}));return function(m){return z.apply(this,arguments)}}(),Ht=function(){var z=L()(y()().mark(function h(m){var N,n;return y()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return N=new FormData,N.append("file",m),v.next=4,fetch(ue,{method:"POST",body:N});case 4:if(n=v.sent,n.ok){v.next=7;break}throw new Error("HTTP ".concat(n.status));case 7:return v.next=9,n.json();case 9:return v.abrupt("return",v.sent);case 10:case"end":return v.stop()}},h)}));return function(m){return z.apply(this,arguments)}}(),Z=function(h){return h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},ot=function(h){var m=function(n){return String(n).padStart(2,"0")};return"".concat(h.getFullYear(),"-").concat(m(h.getMonth()+1),"-").concat(m(h.getDate())," ").concat(m(h.getHours()),":").concat(m(h.getMinutes()))},$t=function(h,m){var N=je()(m).sort(function(U,K){return U.range.start-K.range.start}),n="",E=0,v=Q()(N),T;try{for(v.s();!(T=v.n()).done;){var o=T.value;o.range.start<E||o.range.start<0||o.range.end>h.length||o.range.end<=o.range.start||(n+=Z(h.substring(E,o.range.start)),n+='<mark class="hl '.concat(o.type,'">').concat(Z(h.substring(o.range.start,o.range.end)),"</mark>"),E=o.range.end)}}catch(U){v.e(U)}finally{v.f()}return n+=Z(h.substring(E)),n},Lt=function(h,m){var N,n=[],E=[],v=[],T=(N=m!=null?m:h.raw_content)!==null&&N!==void 0?N:"";return h.risks.forEach(function(o){var U,K,ge="risk-".concat(o.identifier),O=o.detected_issue||"",me=O.match(/^(.{0,25})/),ae=me?me[1]+(O.length>25?"...":""):"\u98CE\u9669\u63D0\u793A",l=o.legal_basis.map(function(M,oe){return{id:"legal-".concat(o.identifier,"-").concat(oe),lawName:M.law_name,article:M.order,content:M.content,score:M.relevance_score,explanation:void 0,relatedRange:o.highlight_range}});l.forEach(function(M){E.find(function(oe){return oe.lawName===M.lawName&&oe.article===M.article})||E.push(M)});var Fe={id:ge,identifier:o.identifier,level:o.level,title:ae,content:O,suggestion:o.suggestions,highlightRange:o.highlight_range,legalBasis:l};n.push(Fe);var Y=(U=o==null?void 0:o.suggested_revision)!==null&&U!==void 0?U:o==null?void 0:o.revised_text,_=o==null?void 0:o.original_text,se=(K=o==null?void 0:o.revision_rationale)!==null&&K!==void 0?K:o==null?void 0:o.suggestion_reason;if(Y){var J="";if(T&&o.highlight_range){var pe=o.highlight_range,xe=pe.start,ie=pe.end;xe>=0&&ie<=T.length&&(J=T.substring(xe,ie))}_&&(J=_),J?J.length>100&&(J=J.substring(0,100)+"..."):J=O.substring(0,50)+(O.length>50?"...":""),v.push({id:"sug-".concat(o.identifier),original:J,revised:Y,reason:se||"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(ae),highlightRange:o.highlight_range})}}),{contractText:T||void 0,risks:n,suggestions:v,legalBasis:E}},Ot=function(h,m,N){var n=(m!=null?m:[]).filter(function(H){return N[H.id]==="accepted"}),E=je()(n).filter(function(H){return(H==null?void 0:H.highlightRange)&&Number.isFinite(H.highlightRange.start)&&Number.isFinite(H.highlightRange.end)&&H.highlightRange.end>H.highlightRange.start}).sort(function(H,_e){return H.highlightRange.start-_e.highlightRange.start}),v="",T=0,o=[],U=[],K=[],ge=-1,O=Q()(E),me;try{for(O.s();!(me=O.n()).done;){var ae,l=me.value,Fe=l.highlightRange,Y=Fe.start,_=Fe.end;if(Y<0||_>h.length||_<=Y){U.push(l.id);continue}if(Y<ge){U.push(l.id);continue}if(Y>T){var se=v.length;v+=h.slice(T,Y);var J=v.length;K.push({kind:"copy",baseStart:T,baseEnd:Y,outStart:se,outEnd:J})}var pe=v.length,xe=(ae=l.revised)!==null&&ae!==void 0?ae:"";v+=xe;var ie=v.length;K.push({kind:"replace",suggestionId:l.id,baseStart:Y,baseEnd:_,outStart:pe,outEnd:ie}),o.push({suggestionId:l.id,range:{start:pe,end:ie}}),T=_,ge=_}}catch(H){O.e(H)}finally{O.f()}if(T<h.length){var M=v.length;v+=h.slice(T);var oe=v.length;K.push({kind:"copy",baseStart:T,baseEnd:h.length,outStart:M,outEnd:oe})}return{text:v,appliedEdits:o,skippedIds:U,segments:K}},e=g(52676),Wt=function(){var h=(0,X.useSearchParams)(),m=w()(h,1),N=m[0],n=N.get("fileId"),E=(0,x.useState)(!0),v=w()(E,2),T=v[0],o=v[1],U=(0,x.useState)("init"),K=w()(U,2),ge=K[0],O=K[1],me=(0,x.useState)(null),ae=w()(me,2),l=ae[0],Fe=ae[1],Y=(0,x.useState)(""),_=w()(Y,2),se=_[0],J=_[1],pe=(0,x.useState)(""),xe=w()(pe,2),ie=xe[0],M=xe[1],oe=(0,x.useState)(!1),H=w()(oe,2),_e=H[0],We=H[1],Ut=(0,x.useState)(null),vt=w()(Ut,2),Ge=vt[0],et=vt[1],Kt=(0,x.useState)("risk"),ht=w()(Kt,2),Te=ht[0],tt=ht[1],Vt=(0,x.useState)(!1),ft=w()(Vt,2),Xt=ft[0],rt=ft[1],Yt=(0,x.useState)(["risks","suggestions","contract"]),gt=w()(Yt,2),mt=gt[0],Jt=gt[1],Qt=(0,x.useState)(!0),pt=w()(Qt,2),xt=pt[0],qt=pt[1],_t=(0,x.useState)(null),bt=w()(_t,2),P=bt[0],nt=bt[1],er=(0,x.useState)(null),yt=w()(er,2),b=yt[0],Ne=yt[1],tr=(0,x.useState)(!1),Et=w()(tr,2),Ue=Et[0],Ie=Et[1],rr=(0,x.useState)({}),jt=w()(rr,2),wt=jt[0],at=jt[1],nr=(0,x.useState)([]),Ft=w()(nr,2),st=Ft[0],Ke=Ft[1],ar=(0,x.useState)([]),Nt=w()(ar,2),sr=Nt[0],Ct=Nt[1],Bt=(0,x.useRef)(null),At="contractAnalysis:leftPanePercent",Dt=function(r,s,a){return Math.min(a,Math.max(s,r))},ir=(0,x.useState)(function(){try{var d=localStorage.getItem(At),r=d?Number(d):NaN;if(Number.isFinite(r))return Dt(r,25,75)}catch(s){}return 50}),St=w()(ir,2),it=St[0],lr=St[1],Ve=(0,x.useRef)(null);(0,x.useEffect)(function(){try{localStorage.setItem(At,String(it))}catch(d){}},[it]);var ur=(0,x.useRef)(null),Me=(0,x.useRef)(null),dr=function(r){if(!(r.pointerType==="mouse"&&r.button!==0)){Ve.current={dragging:!0};try{r.currentTarget.setPointerCapture(r.pointerId)}catch(s){}document.body.style.cursor="col-resize",document.body.style.userSelect="none"}},cr=function(r){var s;if((s=Ve.current)!==null&&s!==void 0&&s.dragging){var a=Bt.current;if(a){var t=a.getBoundingClientRect();if(t.width){var i=(r.clientX-t.left)/t.width*100;lr(Dt(i,25,75))}}}},kt=function(){var r;(r=Ve.current)!==null&&r!==void 0&&r.dragging&&(Ve.current=null,document.body.style.cursor="",document.body.style.userSelect="")},or=function(){var d=L()(y()().mark(function r(){var s,a,t,i,f,u,R,k,G,V,I;return y()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(n){j.next=2;break}return j.abrupt("return");case 2:return j.next=4,Promise.all([de(n),ce(n)]);case 4:if(s=j.sent,a=w()(s,2),t=a[0],i=a[1],t!=null&&t.raw_content&&J(t.raw_content),!(i&&i.status==="success")){j.next=20;break}if(u=Lt(i,(f=t==null?void 0:t.raw_content)!==null&&f!==void 0?f:se),Fe(u),!(i.risks&&i.risks.length>0)){j.next=18;break}return k=(R=i.risks.find(function(le){return le.identifier==="0"}))!==null&&R!==void 0?R:i.risks[0],j.next=16,ze(n,k.identifier);case 16:G=j.sent,G&&(nt(G),V="risk-".concat(k.identifier),M(V),I=document.getElementById(V),I&&I.scrollIntoView({behavior:"smooth",block:"center"}));case 18:j.next=21;break;case 20:D.ZP.error("\u83B7\u53D6\u5206\u6790\u7ED3\u679C\u5931\u8D25");case 21:o(!1);case 22:case"end":return j.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),vr=function d(){Me.current&&clearTimeout(Me.current),n&&(Me.current=setTimeout(L()(y()().mark(function r(){var s;return y()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fe(n);case 2:if(s=t.sent,s){t.next=6;break}return d(),t.abrupt("return");case 6:if(s.status!=="success"){t.next=13;break}return O("success"),D.ZP.success("\u5206\u6790\u5B8C\u6210\uFF01"),t.next=11,or();case 11:t.next=14;break;case 13:s.status==="failed"?(O("failed"),o(!1),D.ZP.error(s.error||"\u5206\u6790\u5931\u8D25")):d();case 14:case"end":return t.stop()}},r)})),2e3))},Pt=function(){var d=L()(y()().mark(function r(){var s;return y()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:return O("analyzing"),t.next=5,ct(n);case 5:if(s=t.sent,s){t.next=13;break}return console.log("First analysis trigger failed, retrying in 1s..."),t.next=10,new Promise(function(i){setTimeout(i,1e3)});case 10:return t.next=12,ct(n);case 12:s=t.sent;case 13:s&&s.status==="analyzing"?(D.ZP.info("\u5F00\u59CB\u667A\u80FD\u5206\u6790..."),vr()):(O("failed"),o(!1),D.ZP.error("\u89E6\u53D1\u5206\u6790\u5931\u8D25\uFF0C\u53EF\u80FD\u662F\u6587\u6863\u5C1A\u672A\u51C6\u5907\u597D\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"));case 14:case"end":return t.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),hr=function(){var d=L()(y()().mark(function r(){return y()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o(!0),a.next=3,Pt();case 3:case"end":return a.stop()}},r)}));return function(){return d.apply(this,arguments)}}();(0,x.useEffect)(function(){if(!n){D.ZP.error("\u7F3A\u5C11\u6587\u4EF6ID\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"),X.history.push("/");return}return Ne(null),Ie(!1),at({}),Ke([]),hr(),function(){Me.current&&clearTimeout(Me.current)}},[n]);var fr=function(){var d=L()(y()().mark(function r(){return y()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n){a.next=2;break}return a.abrupt("return");case 2:return o(!0),a.next=5,Pt();case 5:case"end":return a.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),gr=function(){X.history.push("/")},Rt=function(r){tt("risk"),et(r),We(!0)},mr=function(r){tt("suggestion"),et(r),We(!0)},pr=function(r){tt("legal"),et(r),We(!0)},Zt=function(r,s){if(n){if(r==="risk"){var a=l==null?void 0:l.risks.find(function(f){return f.id===s});a&&(M(s),ze(n,a.identifier).then(function(f){f&&nt(f)}),Rt(a))}else if(r==="suggestion"){M(s);var t=l==null?void 0:l.suggestions.find(function(f){return f.id===s});t&&mr(t)}else if(r==="legal"){M(s);var i=l==null?void 0:l.legalBasis.find(function(f){return f.id===s});i&&pr(i)}}},xr=function(){if(!l||!l.contractText)return se?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:se}):(0,e.jsx)("div",{className:"text-gray-400 text-center py-10",children:"\u6682\u65E0\u5408\u540C\u6587\u672C\u5185\u5BB9"});var r=l.contractText,s=l.risks,a=l.legalBasis,t=[];s.forEach(function(u){t.push({range:u.highlightRange,type:"risk",id:u.id,riskLevel:u.level})}),a.forEach(function(u){t.push({range:u.relatedRange,type:"legal",id:u.id})}),t.sort(function(u,R){return u.range.start-R.range.start});var i=[],f=0;return t.forEach(function(u,R){u.range.start<f||u.range.end>r.length||(u.range.start>f&&i.push((0,e.jsx)("span",{children:r.substring(f,u.range.start)},"text-".concat(R))),i.push((0,e.jsx)("mark",{className:"highlight ".concat(u.type," ").concat(u.type==="risk"&&u.riskLevel?"risk-".concat(u.riskLevel):""," ").concat(ie===u.id?"active":""),id:u.id,onClick:function(){return Zt(u.type,u.id)},children:r.substring(u.range.start,u.range.end)},"highlight-".concat(u.id))),f=u.range.end)}),f<r.length&&i.push((0,e.jsx)("span",{children:r.substring(f)},"text-end")),i},Xe=function(){return b!=null?b:(l==null?void 0:l.contractText)||se||""},lt=function(){return(l==null?void 0:l.contractText)||se||""},br=function(){var r=Xe();if(!r){D.ZP.warning("\u6682\u65E0\u53EF\u7F16\u8F91\u7684\u5408\u540C\u6587\u672C");return}Ne(r),Ie(!0)},yr=function(){Ie(!1),D.ZP.success("\u5DF2\u5728\u9875\u9762\u4E2D\u4FDD\u5B58\u4FEE\u6539\uFF08\u672A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF09")},zt=function(){Ne(null),Ie(!1),Ke([]),at({}),D.ZP.info("\u5DF2\u64A4\u9500\u4FEE\u6539")},Er=function(r){var s;return(s=wt[r])!==null&&s!==void 0?s:"undecided"},jr=function(r){var s=lt();if(!(!l||!s)){var a=Ot(s,l.suggestions,r),t=a.text,i=a.appliedEdits,f=a.skippedIds,u=a.segments;Ne(t),Ie(!1),Ke(i),Ct(u),f.length&&D.ZP.warning("\u6709 ".concat(f.length," \u6761\u5EFA\u8BAE\u56E0\u8303\u56F4\u91CD\u53E0/\u5F02\u5E38\u672A\u80FD\u5E94\u7528"))}},ut=function(r,s){if(l){if(Ue){D.ZP.warning("\u8BF7\u5148\u70B9\u51FB\u201C\u5B8C\u6210/\u64A4\u9500\u201D\u9000\u51FA\u624B\u52A8\u7F16\u8F91\uFF0C\u518D\u8FDB\u884C\u5EFA\u8BAE\u91C7\u7EB3");return}var a=Ae()(Ae()({},wt),{},Be()({},r,s));at(a);var t=Object.values(a).some(function(i){return i==="accepted"});if(!t){Ct([]),Ne(null),Ke([]);return}jr(a)}},wr=function(){var r,s;if(!b)return null;if(!st.length){var a=lt();if(!a||a===b)return(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:b});for(var t=Math.min(a.length,b.length),i=0;i<t&&a[i]===b[i];)i+=1;for(var f=0;f<t-i&&a[a.length-1-f]===b[b.length-1-f];)f+=1;var u=i,R=b.length-f;return R<=u?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:b}):(0,e.jsxs)("div",{className:"whitespace-pre-wrap",children:[(0,e.jsx)("span",{children:b.slice(0,u)}),(0,e.jsx)("mark",{className:"highlight edit",children:b.slice(u,R)}),(0,e.jsx)("span",{children:b.slice(R)})]})}var k=function(c){var B=Q()(sr),$;try{for(B.s();!($=B.n()).done;){var A=$.value;if(!(c<A.baseStart||c>A.baseEnd)){if(A.kind!=="copy")return null;var re=c-A.baseStart,ee=A.outStart+re;return ee<A.outStart||ee>A.outEnd?null:ee}}}catch(Ee){B.e(Ee)}finally{B.f()}return null},G=function(c){var B=k(c.start),$=k(c.end);return B===null||$===null||$<=B?null:{start:B,end:$}},V=function(c,B){return c.start<B.end&&B.start<c.end},I=function(c,B){var $=[],A=c.start,re=Q()(B),ee;try{for(re.s();!(ee=re.n()).done;){var Ee=ee.value;if(!(Ee.end<=A)){if(Ee.start>=c.end)break;if(V({start:A,end:c.end},Ee)){var It=Math.min(Ee.start,c.end);if(It>A&&$.push({start:A,end:It}),A=Math.max(A,Ee.end),A>=c.end)break}}}}catch(Je){re.e(Je)}finally{re.f()}return A<c.end&&$.push({start:A,end:c.end}),$.filter(function(Je){return Je.end>Je.start})},S=je()(st).map(function(p){return p.range}).filter(function(p){return p.end>p.start}).sort(function(p,c){return p.start-c.start}),j=[];st.forEach(function(p){p.range.end<=p.range.start||j.push({key:"edit-".concat(p.suggestionId),range:p.range,type:"edit",id:"edit-".concat(p.suggestionId),suggestionId:p.suggestionId})});var le=(r=l==null?void 0:l.risks)!==null&&r!==void 0?r:[],be=(s=l==null?void 0:l.legalBasis)!==null&&s!==void 0?s:[];le.forEach(function(p){var c=G(p.highlightRange);if(c){var B=I(c,S);B.forEach(function($,A){j.push({key:"".concat(p.id,"__").concat(A),range:$,type:"risk",id:p.id,riskLevel:p.level})})}}),be.forEach(function(p){var c=G(p.relatedRange);if(c){var B=I(c,S);B.forEach(function($,A){j.push({key:"".concat(p.id,"__").concat(A),range:$,type:"legal",id:p.id})})}}),j.sort(function(p,c){return p.range.start!==c.range.start?p.range.start-c.range.start:p.type==="edit"&&c.type!=="edit"?-1:c.type==="edit"&&p.type!=="edit"?1:p.range.end-c.range.end});for(var ye=[],C=0,dt=function(){var c=j[Ye];if(c.range.start<C||c.range.end>b.length)return 0;if(c.range.start>C&&ye.push((0,e.jsx)("span",{children:b.slice(C,c.range.start)},"mix-text-".concat(Ye))),c.type==="edit"){var B=c.suggestionId;ye.push((0,e.jsx)("mark",{id:"edit-".concat(B),className:"highlight edit ".concat(ie==="edit-".concat(B)?"active":""),onClick:function(){M("edit-".concat(B));var A=B.replace(/^sug-/,""),re=l==null?void 0:l.risks.find(function(ee){return ee.identifier===A});re&&(ze(n||"",re.identifier).then(function(ee){ee&&nt(ee)}),Rt(re))},children:b.slice(c.range.start,c.range.end)},"mix-edit-".concat(B)))}else ye.push((0,e.jsx)("mark",{className:"highlight ".concat(c.type," ").concat(c.type==="risk"&&c.riskLevel?"risk-".concat(c.riskLevel):""," ").concat(ie===c.id?"active":""),id:c.id,onClick:function(){return Zt(c.type,c.id)},children:b.slice(c.range.start,c.range.end)},c.key));C=c.range.end},Tt,Ye=0;Ye<j.length;Ye+=1)Tt=dt();return C<b.length&&ye.push((0,e.jsx)("span",{children:b.slice(C)},"mix-text-end")),(0,e.jsx)("div",{className:"whitespace-pre-wrap",children:ye})},Fr=function(){var d=L()(y()().mark(function r(){var s,a,t,i;return y()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(s=b,s){u.next=4;break}return D.ZP.warning("\u8BF7\u5148\u7F16\u8F91\u6216\u5E94\u7528\u5EFA\u8BAE"),u.abrupt("return");case 4:return u.prev=4,o(!0),t=new File([s],"edited-".concat(n||"contract",".txt"),{type:"text/plain"}),u.next=9,Ht(t);case 9:if(i=u.sent,!(i!=null&&i.success&&i!==null&&i!==void 0&&(a=i.data)!==null&&a!==void 0&&a.uuid)){u.next=14;break}return D.ZP.success("\u5DF2\u4E0A\u4F20\u4FEE\u6539\u7248\uFF0C\u5F00\u59CB\u91CD\u65B0\u5206\u6790"),X.history.push("/contract-analysis?fileId=".concat(i.data.uuid)),u.abrupt("return");case 14:o(!1),D.ZP.error((i==null?void 0:i.message)||"\u4E0A\u4F20\u5931\u8D25"),u.next=23;break;case 18:u.prev=18,u.t0=u.catch(4),console.error(u.t0),o(!1),D.ZP.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 23:case"end":return u.stop()}},r,null,[[4,18]])}));return function(){return d.apply(this,arguments)}}(),Nr=function(){if(!l)return[];var r=l.risks,s=l.suggestions,a=l.legalBasis,t=[];return r.forEach(function(i){t.push({range:i.highlightRange,type:"risk",id:i.id})}),s.forEach(function(i){t.push({range:i.highlightRange,type:"suggestion",id:i.id})}),a.forEach(function(i){t.push({range:i.relatedRange,type:"legal",id:i.id})}),t.sort(function(i,f){return i.range.start-f.range.start}),t},Cr=function(){var r,s,a,t=new Date,i=Xe(),f=xt&&!b,u=new Set(mt),R=u.has("contract"),k=u.has("risks"),G=u.has("suggestions"),V=u.has("legal"),I="\u5408\u540C\u5206\u6790\u7ED3\u679C\uFF08\u5BFC\u51FA\uFF09",S="\u5BFC\u51FA\u65F6\u95F4\uFF1A".concat(ot(t)).concat(n?" \xB7 \u6587\u4EF6ID\uFF1A".concat(Z(n)):""),j=k?((r=l==null?void 0:l.risks)!==null&&r!==void 0?r:[]).map(function(C){var dt=C.level==="high"?"\u9AD8\u98CE\u9669":C.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669";return`
              <div class="item">
                <div class="item-title">
                  <span class="badge `.concat(Z(C.level),'">').concat(dt,`</span>
                  <span class="item-head">`).concat(Z(C.title),`</span>
                </div>
                <div class="item-body">`).concat(Z(C.content),`</div>
                `).concat(C.suggestion?'<div class="item-sub"><span class="muted">\u5EFA\u8BAE\uFF1A</span>'.concat(Z(C.suggestion),"</div>"):"",`
              </div>
            `)}).join(""):"",le=G?((s=l==null?void 0:l.suggestions)!==null&&s!==void 0?s:[]).map(function(C){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge info">\u4FEE\u6539\u5EFA\u8BAE</span>
                  <span class="item-head">`.concat(Z(C.reason||"\u5EFA\u8BAE"),`</span>
                </div>
                <div class="diff">
                  <div class="diff-row">
                    <div class="diff-label">\u539F\u6587</div>
                    <div class="diff-content original">`).concat(Z(C.original),`</div>
                  </div>
                  <div class="diff-row">
                    <div class="diff-label">\u4FEE\u6539\u4E3A</div>
                    <div class="diff-content revised">`).concat(Z(C.revised),`</div>
                  </div>
                </div>
              </div>
            `)}).join(""):"",be=V?((a=l==null?void 0:l.legalBasis)!==null&&a!==void 0?a:[]).map(function(C){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge legal">\u6CD5\u5F8B\u4F9D\u636E</span>
                  <span class="item-head">`.concat(Z(C.lawName)," ").concat(Z(C.article),`</span>
                </div>
                <div class="item-body">`).concat(Z(C.content),`</div>
                <div class="item-sub"><span class="muted">\u76F8\u5173\u5EA6\uFF1A</span>`).concat((C.score*100).toFixed(0),`%</div>
              </div>
            `)}).join(""):"",ye=R?f&&l?'<div class="contract-text"><div class="contract-pre">'.concat($t(i,Nr()).replace(/\n/g,"<br/>"),"</div></div>"):'<div class="contract-text"><div class="contract-pre">'.concat(Z(i).replace(/\n/g,"<br/>"),"</div></div>"):"";return`
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>`.concat(Z(I),`</title>
    <style>
      @page { margin: 16mm 14mm; }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
        color: #111827;
        line-height: 1.55;
      }
      .header { margin-bottom: 14px; }
      .title { font-size: 18px; font-weight: 700; margin: 0 0 4px 0; }
      .subtitle { font-size: 12px; color: #6b7280; margin: 0; }
      .section { margin-top: 14px; }
      .section-title { font-size: 13px; font-weight: 700; margin: 0 0 8px 0; }
      .divider { height: 1px; background: #e5e7eb; margin: 10px 0; }
      .item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px 12px; margin: 10px 0; break-inside: avoid; }
      .item-title { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
      .item-head { font-weight: 700; }
      .item-body { font-size: 12px; color: #111827; }
      .item-sub { font-size: 12px; color: #374151; margin-top: 6px; }
      .muted { color: #6b7280; }
      .badge { display: inline-block; font-size: 11px; padding: 2px 8px; border-radius: 999px; border: 1px solid #e5e7eb; background: #f9fafb; color: #111827; }
      .badge.high { background: #fff1f2; border-color: #fecdd3; color: #9f1239; }
      .badge.medium { background: #fff7ed; border-color: #fed7aa; color: #9a3412; }
      .badge.low { background: #f0fdf4; border-color: #bbf7d0; color: #166534; }
      .badge.info { background: #eff6ff; border-color: #bfdbfe; color: #1d4ed8; }
      .badge.legal { background: #f5f3ff; border-color: #ddd6fe; color: #5b21b6; }
      .diff { margin-top: 6px; }
      .diff-row { display: flex; gap: 10px; margin-top: 6px; }
      .diff-label { width: 52px; font-size: 12px; color: #6b7280; flex: 0 0 auto; }
      .diff-content { font-size: 12px; padding: 8px 10px; border-radius: 6px; border: 1px solid #e5e7eb; width: 100%; }
      .diff-content.original { background: #fff1f2; border-color: #fecdd3; }
      .diff-content.revised { background: #f0fdf4; border-color: #bbf7d0; }
      .contract-text { margin-top: 8px; }
      .contract-pre { font-size: 12px; white-space: normal; word-break: break-word; }
      mark.hl { padding: 0 2px; border-radius: 3px; }
      mark.hl.risk { background: #ffe4e6; }
      mark.hl.suggestion { background: #dbeafe; }
      mark.hl.legal { background: #ede9fe; }
      .print-hint { font-size: 12px; color: #6b7280; margin-top: 10px; }
      .footer { position: fixed; bottom: 0; left: 0; right: 0; font-size: 10px; color: #9ca3af; }
      .footer-inner { display: flex; justify-content: space-between; }
      @media print {
        .no-print { display: none !important; }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="title">`).concat(Z(I),`</div>
      <p class="subtitle">`).concat(S,`</p>
      <div class="print-hint no-print">\u63D0\u793A\uFF1A\u5728\u6253\u5370\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002</div>
      <div class="divider"></div>
    </div>

    `).concat(k?'<div class="section"><div class="section-title">\u98CE\u9669\u6458\u8981</div>'.concat(j||'<div class="muted">\u6682\u65E0\u98CE\u9669</div>',"</div>"):"",`
    `).concat(G?'<div class="section"><div class="section-title">\u4FEE\u6539\u5EFA\u8BAE</div>'.concat(le||'<div class="muted">\u6682\u65E0\u4FEE\u6539\u5EFA\u8BAE</div>',"</div>"):"",`
    `).concat(V?'<div class="section"><div class="section-title">\u6CD5\u5F8B\u4F9D\u636E</div>'.concat(be||'<div class="muted">\u6682\u65E0\u6CD5\u5F8B\u4F9D\u636E</div>',"</div>"):"",`
    `).concat(R?'<div class="section"><div class="section-title">\u5408\u540C\u6B63\u6587</div>'.concat(ye||'<div class="muted">\u6682\u65E0\u6B63\u6587</div>',"</div>"):"",`

    <div class="footer">
      <div class="footer-inner">
        <span>LegalRag</span>
        <span>`).concat(ot(t),`</span>
      </div>
    </div>
  </body>
</html>
    `).trim()},Br=function(){var r,s=Xe();if(!s){D.ZP.error("\u6682\u65E0\u53EF\u5BFC\u51FA\u7684\u5408\u540C\u6587\u672C");return}var a=Cr(),t=document.createElement("iframe");t.style.position="fixed",t.style.right="0",t.style.bottom="0",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);var i=t.contentDocument||((r=t.contentWindow)===null||r===void 0?void 0:r.document);if(!i){D.ZP.error("\u65E0\u6CD5\u521B\u5EFA\u6253\u5370\u6587\u6863"),document.body.removeChild(t);return}i.open(),i.write(a),i.close(),t.onload=function(){setTimeout(function(){try{if(!t.contentWindow)return;t.contentWindow.focus(),t.contentWindow.print()}catch(f){console.error("Print error:",f),D.ZP.error("\u6253\u5370\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}finally{setTimeout(function(){document.body.contains(t)&&document.body.removeChild(t)},1e3)}},300)}},Ar=function(){if(!Ge)return null;if(Te==="risk"){var r,s,a=Ge,t=(r=a.legalBasis)!==null&&r!==void 0?r:[],i=t.length>0,f="sug-".concat(a.identifier),u=l==null||(s=l.suggestions)===null||s===void 0?void 0:s.find(function(S){return S.id===f}),R=(P==null?void 0:P.identifier)===a.identifier&&P!==null&&P!==void 0&&P.suggested_revision?{id:f,original:function(){var S=lt(),j=a.highlightRange||{start:0,end:0},le=j.start,be=j.end;return S&&le>=0&&be>le&&be<=S.length?S.slice(le,be):""}(),revised:P.suggested_revision,reason:"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(a.title),highlightRange:a.highlightRange}:null,k=R!=null?R:u,G=k?Er(k.id):"undecided";return(0,e.jsxs)("div",{className:"detail-modal dark-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(ne.Z,{className:"!border-none !px-4 !py-1 !rounded-full",color:a.level==="high"?"#f5222d":a.level==="medium"?"#fa8c16":"#52c41a",children:a.level==="high"?"\u9AD8\u98CE\u9669":a.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u98CE\u9669\u63CF\u8FF0"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:a.content})]}),a.suggestion&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u5EFA\u8BAE\u63AA\u65BD"}),(0,e.jsx)("div",{className:"section-content !bg-brand-500/10 !text-brand-100 !border-brand-500/20 !rounded-xl !p-4",children:a.suggestion})]}),k?(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u5177\u4F53\u4FEE\u6539\u65B9\u6848"}),(0,e.jsxs)("div",{className:"diff-display",style:{marginBottom:16},children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original !bg-red-500/10 !text-red-200 !border-red-500/20 !rounded-lg",children:k.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised !bg-green-500/10 !text-green-200 !border-green-500/20 !rounded-lg",children:k.revised})]})]}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:(0,e.jsxs)(te.Z,{wrap:!0,children:[(0,e.jsx)(F.ZP,{size:"middle",className:G==="accepted"?"!h-10 !px-6 !rounded-xl !bg-brand-600 !text-white !border-none shadow-lg shadow-brand-600/20":"!h-10 !px-6 !rounded-xl !bg-white/5 !text-slate-300 !border-white/10 hover:!bg-white/10 hover:!border-brand-500/50",onClick:function(){ut(k.id,G==="accepted"?"undecided":"accepted")},children:"\u91C7\u7EB3\u5EFA\u8BAE"}),(0,e.jsx)(F.ZP,{size:"middle",className:G==="rejected"?"!h-10 !px-6 !rounded-xl !bg-slate-700 !text-white !border-none":"!h-10 !px-6 !rounded-xl !bg-white/5 !text-slate-300 !border-white/10 hover:!bg-white/10 hover:!border-red-500/50",onClick:function(){ut(k.id,G==="rejected"?"undecided":"rejected")},children:"\u4E0D\u91C7\u7EB3"}),(0,e.jsx)(F.ZP,{size:"middle",ghost:!0,className:"!h-10 !px-6 !rounded-xl !text-slate-500 !border-white/5 hover:!text-slate-300",onClick:function(){ut(k.id,"undecided")},children:"\u6E05\u9664\u9009\u62E9"})]})})]}):null,i&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content space-y-3 !bg-transparent !p-0",children:t.map(function(S){return(0,e.jsxs)("div",{className:"!bg-white/5 !border !border-white/10 !rounded-xl !p-4",children:[(0,e.jsxs)("div",{className:"text-slate-200 font-semibold mb-2",children:[S.lawName," ",S.article]}),(0,e.jsx)("div",{className:"text-slate-400 text-sm leading-relaxed mb-3",children:S.content}),(0,e.jsxs)("div",{className:"legal-score flex items-center",children:[(0,e.jsx)(ve.Z,{disabled:!0,allowHalf:!0,value:S.score*5,style:{fontSize:12,color:"#fadb14"}}),(0,e.jsxs)("span",{className:"ml-3 text-xs text-slate-500",children:["\u76F8\u5173\u5EA6: ",(S.score*100).toFixed(0),"%"]})]})]},S.id)})})]})]})}if(Te==="suggestion"){var V=Ge;return(0,e.jsxs)("div",{className:"detail-modal dark-modal",children:[(0,e.jsxs)("div",{className:"diff-display",children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original !bg-red-500/10 !text-red-200 !border-red-500/20 !rounded-lg",children:V.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label !text-slate-400",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised !bg-green-500/10 !text-green-200 !border-green-500/20 !rounded-lg",children:V.revised})]})]}),V.reason&&(0,e.jsxs)("div",{className:"modal-section mt-4",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u4FEE\u6539\u7406\u7531"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:V.reason})]})]})}if(Te==="legal"){var I=Ge;return(0,e.jsxs)("div",{className:"detail-modal dark-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u6CD5\u5F8B\u540D\u79F0"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:I.lawName})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u6761\u6B3E"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:I.article})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u6CD5\u6761\u5185\u5BB9"}),(0,e.jsx)("div",{className:"section-content !bg-white/5 !text-slate-200 !border-white/10 !rounded-xl !p-4",children:I.content})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u76F8\u5173\u5EA6\u8BC4\u5206"}),(0,e.jsxs)("div",{className:"legal-score flex items-center p-2",children:[(0,e.jsx)(ve.Z,{disabled:!0,allowHalf:!0,value:I.score*5,style:{color:"#fadb14"}}),(0,e.jsxs)("span",{className:"ml-4 text-slate-400",children:[(I.score*100).toFixed(0),"%"]})]})]}),I.explanation&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label !text-brand-300",children:"\u9002\u7528\u8BF4\u660E"}),(0,e.jsx)("div",{className:"section-content !bg-brand-500/10 !text-brand-100 !border-brand-500/20 !rounded-xl !p-4",children:I.explanation})]})]})}},Dr=function(){return Te==="risk"?"\u98CE\u9669\u8BE6\u60C5":Te==="suggestion"?"\u4FEE\u6539\u5EFA\u8BAE\u8BE6\u60C5":"\u6CD5\u5F8B\u4F9D\u636E\u8BE6\u60C5"};return T?(0,e.jsxs)("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:[(0,e.jsx)(Se.Z,{}),(0,e.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-2xl bg-white/5 border border-white/10 shadow-2xl px-8 py-10 text-center space-y-4 backdrop-blur-xl",children:[(0,e.jsx)("div",{className:"bg-brand-600/20 border border-brand-500/30 inline-flex items-center justify-center rounded-full px-4 py-1 text-xs font-medium text-brand-300",children:ge==="analyzing"?"\u5408\u540C\u667A\u80FD\u5206\u6790\u8FDB\u884C\u4E2D\u2026":"\u6B63\u5728\u51C6\u5907\u5206\u6790..."}),(0,e.jsx)("p",{className:"text-sm text-slate-400",children:"\u6211\u4EEC\u6B63\u5728\u4E3A\u60A8\u89E3\u6790\u5408\u540C\u6761\u6B3E\u5E76\u751F\u6210\u98CE\u9669\u63D0\u793A\u3001\u4FEE\u6539\u610F\u89C1\u4E0E\u6CD5\u5F8B\u4F9D\u636E\uFF0C\u8BF7\u7A0D\u5019\u3002"}),(0,e.jsx)("div",{className:"flex justify-center pt-2",children:(0,e.jsx)(we.Z,{size:"large",tip:(0,e.jsx)("span",{className:"text-slate-400 mt-2 block",children:ge==="analyzing"?"\u6B63\u5728\u5206\u6790\u5408\u540C...":"\u6B63\u5728\u52A0\u8F7D..."})})})]})]}):(0,e.jsxs)("div",{style:{position:"relative",width:"100vw",minHeight:"100vh",background:"#09090b",overflowX:"hidden"},children:[(0,e.jsx)(Se.Z,{}),(0,e.jsx)("div",{style:{position:"relative",zIndex:1,padding:"24px 24px 48px"},children:(0,e.jsxs)("div",{className:"mx-auto max-w-7xl",children:[(0,e.jsxs)("div",{className:"sexy-card mb-6 px-6 py-4 flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-xs font-semibold tracking-wide text-brand-200/80 uppercase",children:"LegalRag"}),(0,e.jsx)("p",{className:"text-xl font-bold text-white tracking-tight",children:"\u5408\u540C\u5206\u6790\u7ED3\u679C"})]}),(0,e.jsxs)(te.Z,{children:[(0,e.jsx)("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-brand-100 backdrop-blur-md",children:"\u98CE\u9669\u63D0\u793A \xB7 \u4FEE\u6539\u610F\u89C1 \xB7 \u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)(F.ZP,{ghost:!0,size:"small",onClick:gr,style:{color:"rgba(255,255,255,0.8)",borderColor:"rgba(255,255,255,0.3)"},children:"\u8FD4\u56DE"})]})]}),(0,e.jsx)("div",{className:"contract-analysis",children:(0,e.jsxs)("div",{className:"analysis-content !p-0",children:[(0,e.jsxs)("div",{className:"flex justify-end mb-4 gap-3",children:[(0,e.jsx)(F.ZP,{className:"sexy-card !border-white/20 !text-white hover:!bg-white/10 hover:!border-white/40 !h-9 !px-4 !bg-transparent",onClick:function(){return rt(!0)},children:"\u5BFC\u51FA PDF"}),(0,e.jsx)(F.ZP,{type:"primary",className:"!bg-brand-600 hover:!bg-brand-500 !border-none !h-9 !px-4 !rounded-lg",onClick:fr,children:"\u91CD\u65B0\u5206\u6790"})]}),l&&(0,e.jsx)("div",{className:"analysis-content-inner",children:(0,e.jsxs)("div",{className:"split-grid",ref:Bt,style:Be()({},"--left-pane","".concat(it,"%")),children:[(0,e.jsx)("div",{className:"split-left",children:(0,e.jsxs)("div",{className:"sexy-card h-full flex flex-col overflow-hidden",children:[(0,e.jsxs)("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-white/5",children:[(0,e.jsx)("span",{className:"text-white font-semibold",children:"\u5408\u540C\u6587\u672C"}),(0,e.jsxs)(te.Z,{children:[Ue?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.ZP,{size:"small",type:"primary",onClick:yr,className:"!bg-brand-600",children:"\u5B8C\u6210"}),(0,e.jsx)(F.ZP,{size:"small",ghost:!0,onClick:zt,className:"!text-white/80 !border-white/20",children:"\u64A4\u9500"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.ZP,{size:"small",ghost:!0,onClick:br,className:"!text-white/80 !border-white/20 hover:!border-brand-400 hover:!text-brand-400",children:"\u7F16\u8F91"}),b?(0,e.jsx)(F.ZP,{size:"small",danger:!0,ghost:!0,onClick:zt,className:"!border-red-500/30 hover:!bg-red-500/10",children:"\u64A4\u9500\u4FEE\u6539\u7248"}):null]}),b&&!Ue?(0,e.jsx)(F.ZP,{size:"small",type:"primary",ghost:!0,onClick:Fr,children:"\u7528\u4FEE\u6539\u7248\u91CD\u65B0\u5206\u6790"}):null]})]}),(0,e.jsx)("div",{className:"contract-text-panel flex-1",ref:ur,children:Ue?(0,e.jsxs)("div",{className:"space-y-2 h-full flex flex-col",children:[(0,e.jsx)("div",{className:"text-xs text-slate-400",children:"\u63D0\u793A\uFF1A\u7F16\u8F91/\u5E94\u7528\u5EFA\u8BAE\u540E\uFF0C\u672C\u9875\u9AD8\u4EAE\u5B9A\u4F4D\u5C06\u4E0D\u518D\u51C6\u786E\u3002"}),(0,e.jsx)(Oe.Z.TextArea,{className:"!bg-black/20 !text-slate-200 !border-white/10 placeholder:!text-slate-600 flex-1",value:b!=null?b:Xe(),onChange:function(r){return Ne(r.target.value)},style:{resize:"none",height:"100%"}})]}):b?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-xs text-slate-400",children:"\u5DF2\u751F\u6210\u4FEE\u6539\u7248\u6B63\u6587\uFF08\u7EFF\u8272\u9AD8\u4EAE\u4E3A\u5DF2\u91C7\u7EB3\u7684\u4FEE\u6539\u5185\u5BB9\uFF09\u3002"}),wr()]}):xr()})]})}),(0,e.jsx)("div",{className:"split-resizer",role:"separator","aria-orientation":"vertical","aria-label":"\u8C03\u6574\u5408\u540C\u6587\u672C\u533A\u57DF\u5BBD\u5EA6",onPointerDown:dr,onPointerMove:cr,onPointerUp:kt,onPointerCancel:kt}),(0,e.jsx)("div",{className:"split-right",children:(0,e.jsx)("div",{className:"analysis-panel h-full",children:(0,e.jsxs)("div",{className:"sexy-card h-full flex flex-col overflow-hidden",children:[(0,e.jsx)("div",{className:"p-4 border-b border-white/10 bg-white/5",children:(0,e.jsx)("span",{className:"text-white font-semibold",children:"\u98CE\u9669\u8BE6\u60C5"})}),(0,e.jsx)("div",{className:"p-5 flex-1 overflow-y-auto",children:P?(0,e.jsxs)("div",{className:"detail-container",children:[(0,e.jsxs)("div",{className:"modal-section",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,e.jsx)("span",{className:"text-white text-lg font-semibold",children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(ne.Z,{className:"!border-none",color:P.level==="high"?"#f5222d":P.level==="medium"?"#fa8c16":"#52c41a",style:{padding:"4px 16px",fontSize:14,borderRadius:12,marginRight:0},children:P.level==="high"?"\u9AD8\u98CE\u9669":P.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsxs)("div",{className:"mb-4 rounded-lg bg-red-500/10 border border-red-500/20 overflow-hidden",children:[(0,e.jsx)("div",{className:"px-3 py-2 bg-red-500/20 border-b border-red-500/20 text-red-300 text-sm font-semibold flex items-center gap-2",children:(0,e.jsx)("span",{children:"\u{1F6A8} \u98CE\u9669\u63CF\u8FF0"})}),(0,e.jsx)("div",{className:"p-3 text-slate-200 text-sm leading-relaxed",children:P.detected_issue})]}),P.suggestions&&(0,e.jsxs)("div",{className:"mb-4 rounded-lg bg-yellow-500/10 border border-yellow-500/20 overflow-hidden",children:[(0,e.jsx)("div",{className:"px-3 py-2 bg-yellow-500/20 border-b border-yellow-500/20 text-yellow-300 text-sm font-semibold flex items-center gap-2",children:(0,e.jsx)("span",{children:"\u{1F4A1} \u5EFA\u8BAE\u63AA\u65BD"})}),(0,e.jsx)("div",{className:"p-3 text-slate-200 text-sm leading-relaxed",children:P.suggestions})]}),P.legal_basis&&P.legal_basis.length>0&&(0,e.jsxs)("div",{className:"modal-section mt-6",children:[(0,e.jsx)("div",{className:"section-title text-white mb-3 font-semibold",children:"\u2696\uFE0F \u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content space-y-3",children:P.legal_basis.map(function(d,r){return(0,e.jsxs)("div",{className:"rounded-lg bg-white/5 border border-white/10 p-3 hover:bg-white/10 transition-colors",children:[(0,e.jsxs)("div",{className:"text-slate-200 font-medium mb-1",children:[d.law_name," ",d.order]}),(0,e.jsx)("div",{className:"text-slate-400 text-sm mb-2 leading-relaxed",children:d.content}),(0,e.jsxs)("div",{className:"legal-score flex items-center",children:[(0,e.jsx)(ve.Z,{disabled:!0,allowHalf:!0,value:(d.relevance_score||0)*5,style:{fontSize:12,color:"#fadb14"}}),(0,e.jsxs)("span",{className:"ml-2 text-xs text-slate-500",children:["\u76F8\u5173\u5EA6:"," ",((d.relevance_score||0)*100).toFixed(0),"%"]})]})]},r)})})]})]}):(0,e.jsxs)("div",{className:"text-slate-500 text-center py-12 flex flex-col items-center justify-center h-full",children:[(0,e.jsx)("div",{className:"text-4xl mb-4 opacity-50",children:"\u{1F4CB}"}),(0,e.jsx)("div",{className:"text-lg",children:"\u6682\u65E0\u98CE\u9669\u8BE6\u60C5"}),(0,e.jsx)("div",{className:"text-sm mt-2 opacity-60",children:"\u70B9\u51FB\u5DE6\u4FA7\u5408\u540C\u5185\u5BB9\u7684\u6807\u8BB0\u5904\u67E5\u770B"})]})})]})})})]})})]})}),(0,e.jsx)(ke.Z,{title:Dr(),open:_e,onCancel:function(){return We(!1)},footer:null,width:700,className:"dark-modal",children:Ar()}),(0,e.jsxs)(ke.Z,{title:"\u5BFC\u51FA PDF",open:Xt,onCancel:function(){return rt(!1)},okText:"\u5F00\u59CB\u5BFC\u51FA",cancelText:"\u53D6\u6D88",className:"dark-modal",onOk:function(){rt(!1),Br()},children:[(0,e.jsx)(Pe.Z.Paragraph,{style:{marginBottom:10,color:"rgba(255,255,255,0.5)"},children:"\u70B9\u51FB\u201C\u5F00\u59CB\u5BFC\u51FA\u201D\u540E\u5C06\u81EA\u52A8\u5F39\u51FA\u6253\u5370\u5BF9\u8BDD\u6846\uFF0C\u5728\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002"}),(0,e.jsx)(Re.Z,{style:{margin:"12px 0",borderColor:"rgba(255,255,255,0.1)"}}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsx)("div",{style:{fontWeight:600,marginBottom:8,color:"#fff"},children:"\u5BFC\u51FA\u5185\u5BB9"}),(0,e.jsx)(he.Z.Group,{value:mt,onChange:function(r){var s=r;s.includes("contract")||s.push("contract"),Jt(Array.from(new Set(s)))},children:(0,e.jsxs)(te.Z,{wrap:!0,children:[(0,e.jsx)(he.Z,{value:"contract",className:"!text-slate-300",children:"\u5408\u540C\u6B63\u6587"}),(0,e.jsx)(he.Z,{value:"risks",className:"!text-slate-300",children:"\u98CE\u9669\u6458\u8981"}),(0,e.jsx)(he.Z,{value:"suggestions",className:"!text-slate-300",children:"\u4FEE\u6539\u5EFA\u8BAE"}),(0,e.jsx)(he.Z,{value:"legal",className:"!text-slate-300",children:"\u6CD5\u5F8B\u4F9D\u636E"})]})})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,e.jsx)("div",{style:{fontWeight:600,color:"#fff"},children:"\u6B63\u6587\u5305\u542B\u9AD8\u4EAE"}),(0,e.jsx)(Ze.Z,{checked:b?!1:xt,disabled:!!b,onChange:qt}),(0,e.jsx)("span",{style:{color:"rgba(255,255,255,0.4)",fontSize:12},children:b?"\u5DF2\u4FEE\u6539\u6B63\u6587\uFF1A\u9AD8\u4EAE\u4F1A\u56E0\u4F4D\u7F6E\u504F\u79FB\u800C\u5931\u6548":"\u98CE\u9669/\u5EFA\u8BAE/\u6CD5\u6761\u4F1A\u4EE5\u4E0D\u540C\u5E95\u8272\u6807\u8BB0"})]})]})]})})]})},Gt=Wt}}]);
