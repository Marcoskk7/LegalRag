"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[519],{82194:function(wt,$e,f){f.r($e),f.d($e,{default:function(){return On}});var Fn=f(82092),We=f.n(Fn),Cn=f(26068),Ge=f.n(Cn),Bn=f(90228),j=f.n(Bn),An=f(87999),U=f.n(An),Sn=f(48305),S=f.n(Sn),Nn=f(335),ye=f.n(Nn),Dn=f(15558),Ne=f.n(Dn),wn=f(86980),Q=f(43953),N=f(31707),Ue=f(58979),K=f(97150),De=f(74139),kn=f(45011),fe=f(15572),Ve=f(49598),Pn=f(27374),Ye=f(34991),zn=f(96988),Tn=f(71392),he=f(82290),Zn=f(14774),p=f(75271),e=f(52676),de={NODE_ENV:"production",PUBLIC_PATH:"/"}.UMI_APP_API_BASE_URL||"",Rn="".concat(de,"/api/v1/upload"),w=function(x){return x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},Ke=function(x){var z=function(m){return String(m).padStart(2,"0")};return"".concat(x.getFullYear(),"-").concat(z(x.getMonth()+1),"-").concat(z(x.getDate())," ").concat(z(x.getHours()),":").concat(z(x.getMinutes()))},Hn=function(x,z){var X=Ne()(z).sort(function(M,L){return M.range.start-L.range.start}),m="",$=0,B=ye()(X),k;try{for(B.s();!(k=B.n()).done;){var d=k.value;d.range.start<$||d.range.start<0||d.range.end>x.length||d.range.end<=d.range.start||(m+=w(x.substring($,d.range.start)),m+='<mark class="hl '.concat(d.type,'">').concat(w(x.substring(d.range.start,d.range.end)),"</mark>"),$=d.range.end)}}catch(M){B.e(M)}finally{B.f()}return m+=w(x.substring($)),m},In=function(x,z){var X,m=[],$=[],B=[],k=(X=z!=null?z:x.raw_content)!==null&&X!==void 0?X:"";return x.risks.forEach(function(d){var M,L,re="risk-".concat(d.identifier),H=d.detected_issue||"",ae=H.match(/^(.{0,25})/),q=ae?ae[1]+(H.length>25?"...":""):"\u98CE\u9669\u63D0\u793A",u=d.legal_basis.map(function(T,te){return{id:"legal-".concat(d.identifier,"-").concat(te),lawName:T.law_name,article:T.order,content:T.content,score:T.relevance_score,explanation:void 0,relatedRange:d.highlight_range}});u.forEach(function(T){$.find(function(te){return te.lawName===T.lawName&&te.article===T.article})||$.push(T)});var oe={id:re,identifier:d.identifier,level:d.level,title:q,content:H,suggestion:d.suggestions,highlightRange:d.highlight_range,legalBasis:u};m.push(oe);var W=(M=d==null?void 0:d.suggested_revision)!==null&&M!==void 0?M:d==null?void 0:d.revised_text,V=d==null?void 0:d.original_text,_=(L=d==null?void 0:d.revision_rationale)!==null&&L!==void 0?L:d==null?void 0:d.suggestion_reason;if(W){var G="";if(k&&d.highlight_range){var se=d.highlight_range,ie=se.start,ee=se.end;ie>=0&&ee<=k.length&&(G=k.substring(ie,ee))}V&&(G=V),G?G.length>100&&(G=G.substring(0,100)+"..."):G=H.substring(0,50)+(H.length>50?"...":""),B.push({id:"sug-".concat(d.identifier),original:G,revised:W,reason:_||"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(q),highlightRange:d.highlight_range})}}),{contractText:k||void 0,risks:m,suggestions:B,legalBasis:$}},Mn=function(x,z,X){var m=(z!=null?z:[]).filter(function(Z){return X[Z.id]==="accepted"}),$=Ne()(m).filter(function(Z){return(Z==null?void 0:Z.highlightRange)&&Number.isFinite(Z.highlightRange.start)&&Number.isFinite(Z.highlightRange.end)&&Z.highlightRange.end>Z.highlightRange.start}).sort(function(Z,we){return Z.highlightRange.start-we.highlightRange.start}),B="",k=0,d=[],M=[],L=[],re=-1,H=ye()($),ae;try{for(H.s();!(ae=H.n()).done;){var q,u=ae.value,oe=u.highlightRange,W=oe.start,V=oe.end;if(W<0||V>x.length||V<=W){M.push(u.id);continue}if(W<re){M.push(u.id);continue}if(W>k){var _=B.length;B+=x.slice(k,W);var G=B.length;L.push({kind:"copy",baseStart:k,baseEnd:W,outStart:_,outEnd:G})}var se=B.length,ie=(q=u.revised)!==null&&q!==void 0?q:"";B+=ie;var ee=B.length;L.push({kind:"replace",suggestionId:u.id,baseStart:W,baseEnd:V,outStart:se,outEnd:ee}),d.push({suggestionId:u.id,range:{start:se,end:ee}}),k=V,re=V}}catch(Z){H.e(Z)}finally{H.f()}if(k<x.length){var T=B.length;B+=x.slice(k);var te=B.length;L.push({kind:"copy",baseStart:k,baseEnd:x.length,outStart:T,outEnd:te})}return{text:B,appliedEdits:d,skippedIds:M,segments:L}},Ln=function(){var x=(0,Q.useSearchParams)(),z=S()(x,1),X=z[0],m=X.get("fileId"),$=(0,p.useState)(!0),B=S()($,2),k=B[0],d=B[1],M=(0,p.useState)("init"),L=S()(M,2),re=L[0],H=L[1],ae=(0,p.useState)(null),q=S()(ae,2),u=q[0],oe=q[1],W=(0,p.useState)(""),V=S()(W,2),_=V[0],G=V[1],se=(0,p.useState)(""),ie=S()(se,2),ee=ie[0],T=ie[1],te=(0,p.useState)(!1),Z=S()(te,2),we=Z[0],Ee=Z[1],$n=(0,p.useState)(null),Xe=S()($n,2),be=Xe[0],ke=Xe[1],Wn=(0,p.useState)("risk"),Je=S()(Wn,2),pe=Je[0],Pe=Je[1],Gn=(0,p.useState)(!1),Qe=S()(Gn,2),Un=Qe[0],ze=Qe[1],Vn=(0,p.useState)(["risks","suggestions","contract"]),qe=S()(Vn,2),_e=qe[0],Yn=qe[1],Kn=(0,p.useState)(!0),en=S()(Kn,2),nn=en[0],Xn=en[1],Jn=(0,p.useState)(null),tn=S()(Jn,2),D=tn[0],Te=tn[1],Qn=(0,p.useState)(null),rn=S()(Qn,2),g=rn[0],ve=rn[1],qn=(0,p.useState)(!1),an=S()(qn,2),je=an[0],me=an[1],_n=(0,p.useState)({}),sn=S()(_n,2),ln=sn[0],Ze=sn[1],et=(0,p.useState)([]),un=S()(et,2),Re=un[0],Fe=un[1],nt=(0,p.useState)([]),cn=S()(nt,2),tt=cn[0],dn=cn[1],on=(0,p.useRef)(null),vn="contractAnalysis:leftPanePercent",fn=function(t,a,n){return Math.min(n,Math.max(a,t))},rt=(0,p.useState)(function(){try{var i=localStorage.getItem(vn),t=i?Number(i):NaN;if(Number.isFinite(t))return fn(t,25,75)}catch(a){}return 50}),hn=S()(rt,2),He=hn[0],at=hn[1],Ce=(0,p.useRef)(null);(0,p.useEffect)(function(){try{localStorage.setItem(vn,String(He))}catch(i){}},[He]);var st=(0,p.useRef)(null),xe=(0,p.useRef)(null),it=function(t){if(!(t.pointerType==="mouse"&&t.button!==0)){Ce.current={dragging:!0};try{t.currentTarget.setPointerCapture(t.pointerId)}catch(a){}document.body.style.cursor="col-resize",document.body.style.userSelect="none"}},lt=function(t){var a;if((a=Ce.current)!==null&&a!==void 0&&a.dragging){var n=on.current;if(n){var r=n.getBoundingClientRect();if(r.width){var s=(t.clientX-r.left)/r.width*100;at(fn(s,25,75))}}}},gn=function(){var t;(t=Ce.current)!==null&&t!==void 0&&t.dragging&&(Ce.current=null,document.body.style.cursor="",document.body.style.userSelect="")},ut=function(){var i=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(m,"/risks/status"),{method:"GET"});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Fetch status error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},t,null,[[0,6]])}));return function(){return i.apply(this,arguments)}}(),ct=function(){var i=U()(j()().mark(function t(){var a;return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(m,"/content"),{method:"GET"});case 3:return a=r.sent,a!=null&&a.raw_content&&G(a.raw_content),r.abrupt("return",a);case 8:return r.prev=8,r.t0=r.catch(0),console.error("Fetch document content error:",r.t0),r.abrupt("return",null);case 12:case"end":return r.stop()}},t,null,[[0,8]])}));return function(){return i.apply(this,arguments)}}(),dt=function(){var i=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(m,"/risks"),{method:"GET"});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Fetch risks error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},t,null,[[0,6]])}));return function(){return i.apply(this,arguments)}}(),Ie=function(){var i=U()(j()().mark(function t(a){var n;return j()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(m){s.next=2;break}return s.abrupt("return",null);case 2:return s.prev=2,s.next=5,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(m,"/risks/").concat(a),{method:"GET"});case 5:return n=s.sent,s.abrupt("return",n);case 9:return s.prev=9,s.t0=s.catch(2),console.error("Fetch risk detail error:",s.t0),N.ZP.error("\u83B7\u53D6\u98CE\u9669\u8BE6\u60C5\u5931\u8D25"),s.abrupt("return",null);case 14:case"end":return s.stop()}},t,null,[[2,9]])}));return function(a){return i.apply(this,arguments)}}(),pn=function(){var i=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,Q.request)("".concat(de,"/api/v1/documents/").concat(m,"/risks/analyze"),{method:"POST",data:{top_k:1}});case 3:return n.abrupt("return",n.sent);case 6:return n.prev=6,n.t0=n.catch(0),console.error("Trigger analysis error:",n.t0),n.abrupt("return",null);case 10:case"end":return n.stop()}},t,null,[[0,6]])}));return function(){return i.apply(this,arguments)}}(),ot=function(){var i=U()(j()().mark(function t(){var a,n,r,s,o,l,F,v,I,O,P;return j()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Promise.all([ct(),dt()]);case 2:if(a=C.sent,n=S()(a,2),r=n[0],s=n[1],!(s&&s.status==="success")){C.next=17;break}if(l=In(s,(o=r==null?void 0:r.raw_content)!==null&&o!==void 0?o:_),oe(l),!(s.risks&&s.risks.length>0)){C.next=15;break}return v=(F=s.risks.find(function(ne){return ne.identifier==="0"}))!==null&&F!==void 0?F:s.risks[0],C.next=13,Ie(v.identifier);case 13:I=C.sent,I&&(Te(I),O="risk-".concat(v.identifier),T(O),P=document.getElementById(O),P&&P.scrollIntoView({behavior:"smooth",block:"center"}));case 15:C.next=18;break;case 17:N.ZP.error("\u83B7\u53D6\u5206\u6790\u7ED3\u679C\u5931\u8D25");case 18:d(!1);case 19:case"end":return C.stop()}},t)}));return function(){return i.apply(this,arguments)}}(),vt=function i(){xe.current&&clearTimeout(xe.current),xe.current=setTimeout(U()(j()().mark(function t(){var a;return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ut();case 2:if(a=r.sent,a){r.next=6;break}return i(),r.abrupt("return");case 6:if(a.status!=="success"){r.next=13;break}return H("success"),N.ZP.success("\u5206\u6790\u5B8C\u6210\uFF01"),r.next=11,ot();case 11:r.next=14;break;case 13:a.status==="failed"?(H("failed"),d(!1),N.ZP.error(a.error||"\u5206\u6790\u5931\u8D25")):i();case 14:case"end":return r.stop()}},t)})),2e3)},mn=function(){var i=U()(j()().mark(function t(){var a;return j()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return H("analyzing"),r.next=3,pn();case 3:if(a=r.sent,a){r.next=11;break}return console.log("First analysis trigger failed, retrying in 1s..."),r.next=8,new Promise(function(s){setTimeout(s,1e3)});case 8:return r.next=10,pn();case 10:a=r.sent;case 11:a&&a.status==="analyzing"?(N.ZP.info("\u5F00\u59CB\u667A\u80FD\u5206\u6790..."),vt()):(H("failed"),d(!1),N.ZP.error("\u89E6\u53D1\u5206\u6790\u5931\u8D25\uFF0C\u53EF\u80FD\u662F\u6587\u6863\u5C1A\u672A\u51C6\u5907\u597D\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"));case 12:case"end":return r.stop()}},t)}));return function(){return i.apply(this,arguments)}}(),ft=function(){var i=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return d(!0),n.next=3,mn();case 3:case"end":return n.stop()}},t)}));return function(){return i.apply(this,arguments)}}();(0,p.useEffect)(function(){if(!m){N.ZP.error("\u7F3A\u5C11\u6587\u4EF6ID\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"),Q.history.push("/");return}return ve(null),me(!1),Ze({}),Fe([]),ft(),function(){xe.current&&clearTimeout(xe.current)}},[m]);var ht=function(){var i=U()(j()().mark(function t(){return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(m){n.next=2;break}return n.abrupt("return");case 2:return d(!0),n.next=5,mn();case 5:case"end":return n.stop()}},t)}));return function(){return i.apply(this,arguments)}}(),gt=function(){Q.history.push("/")},xn=function(t){Pe("risk"),ke(t),Ee(!0)},pt=function(t){Pe("suggestion"),ke(t),Ee(!0)},mt=function(t){Pe("legal"),ke(t),Ee(!0)},yn=function(t,a){if(t==="risk"){var n=u==null?void 0:u.risks.find(function(o){return o.id===a});n&&(T(a),Ie(n.identifier).then(function(o){o&&Te(o)}),xn(n))}else if(t==="suggestion"){T(a);var r=u==null?void 0:u.suggestions.find(function(o){return o.id===a});r&&pt(r)}else if(t==="legal"){T(a);var s=u==null?void 0:u.legalBasis.find(function(o){return o.id===a});s&&mt(s)}},xt=function(){if(!u||!u.contractText)return _?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:_}):(0,e.jsx)("div",{className:"text-gray-400 text-center py-10",children:"\u6682\u65E0\u5408\u540C\u6587\u672C\u5185\u5BB9"});var t=u.contractText,a=u.risks,n=u.legalBasis,r=[];a.forEach(function(l){r.push({range:l.highlightRange,type:"risk",id:l.id,riskLevel:l.level})}),n.forEach(function(l){r.push({range:l.relatedRange,type:"legal",id:l.id})}),r.sort(function(l,F){return l.range.start-F.range.start});var s=[],o=0;return r.forEach(function(l,F){l.range.start<o||l.range.end>t.length||(l.range.start>o&&s.push((0,e.jsx)("span",{children:t.substring(o,l.range.start)},"text-".concat(F))),s.push((0,e.jsx)("mark",{className:"highlight ".concat(l.type," ").concat(l.type==="risk"&&l.riskLevel?"risk-".concat(l.riskLevel):""," ").concat(ee===l.id?"active":""),id:l.id,onClick:function(){return yn(l.type,l.id)},children:t.substring(l.range.start,l.range.end)},"highlight-".concat(l.id))),o=l.range.end)}),o<t.length&&s.push((0,e.jsx)("span",{children:t.substring(o)},"text-end")),s},Be=function(){return g!=null?g:(u==null?void 0:u.contractText)||_||""},Me=function(){return(u==null?void 0:u.contractText)||_||""},yt=function(){var t=Be();if(!t){N.ZP.warning("\u6682\u65E0\u53EF\u7F16\u8F91\u7684\u5408\u540C\u6587\u672C");return}ve(t),me(!0)},Et=function(){me(!1),N.ZP.success("\u5DF2\u5728\u9875\u9762\u4E2D\u4FDD\u5B58\u4FEE\u6539\uFF08\u672A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF09")},En=function(){ve(null),me(!1),Fe([]),Ze({}),N.ZP.info("\u5DF2\u64A4\u9500\u4FEE\u6539")},bt=function(t){var a;return(a=ln[t])!==null&&a!==void 0?a:"undecided"},jt=function(t){var a=Me();if(!(!u||!a)){var n=Mn(a,u.suggestions,t),r=n.text,s=n.appliedEdits,o=n.skippedIds,l=n.segments;ve(r),me(!1),Fe(s),dn(l),o.length&&N.ZP.warning("\u6709 ".concat(o.length," \u6761\u5EFA\u8BAE\u56E0\u8303\u56F4\u91CD\u53E0/\u5F02\u5E38\u672A\u80FD\u5E94\u7528"))}},Le=function(t,a){if(u){if(je){N.ZP.warning("\u8BF7\u5148\u70B9\u51FB\u201C\u5B8C\u6210/\u64A4\u9500\u201D\u9000\u51FA\u624B\u52A8\u7F16\u8F91\uFF0C\u518D\u8FDB\u884C\u5EFA\u8BAE\u91C7\u7EB3");return}var n=Ge()(Ge()({},ln),{},We()({},t,a));Ze(n);var r=Object.values(n).some(function(s){return s==="accepted"});if(!r){dn([]),ve(null),Fe([]);return}jt(n)}},Ft=function(){var t,a;if(!g)return null;if(!Re.length){var n=Me();if(!n||n===g)return(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:g});for(var r=Math.min(n.length,g.length),s=0;s<r&&n[s]===g[s];)s+=1;for(var o=0;o<r-s&&n[n.length-1-o]===g[g.length-1-o];)o+=1;var l=s,F=g.length-o;return F<=l?(0,e.jsx)("pre",{className:"whitespace-pre-wrap",children:g}):(0,e.jsxs)("div",{className:"whitespace-pre-wrap",children:[(0,e.jsx)("span",{children:g.slice(0,l)}),(0,e.jsx)("mark",{className:"highlight edit",children:g.slice(l,F)}),(0,e.jsx)("span",{children:g.slice(F)})]})}var v=function(c){var E=ye()(tt),R;try{for(E.s();!(R=E.n()).done;){var b=R.value;if(!(c<b.baseStart||c>b.baseEnd)){if(b.kind!=="copy")return null;var J=c-b.baseStart,Y=b.outStart+J;return Y<b.outStart||Y>b.outEnd?null:Y}}}catch(ce){E.e(ce)}finally{E.f()}return null},I=function(c){var E=v(c.start),R=v(c.end);return E===null||R===null||R<=E?null:{start:E,end:R}},O=function(c,E){return c.start<E.end&&E.start<c.end},P=function(c,E){var R=[],b=c.start,J=ye()(E),Y;try{for(J.s();!(Y=J.n()).done;){var ce=Y.value;if(!(ce.end<=b)){if(ce.start>=c.end)break;if(O({start:b,end:c.end},ce)){var jn=Math.min(ce.start,c.end);if(jn>b&&R.push({start:b,end:jn}),b=Math.max(b,ce.end),b>=c.end)break}}}}catch(Se){J.e(Se)}finally{J.f()}return b<c.end&&R.push({start:b,end:c.end}),R.filter(function(Se){return Se.end>Se.start})},A=Ne()(Re).map(function(h){return h.range}).filter(function(h){return h.end>h.start}).sort(function(h,c){return h.start-c.start}),C=[];Re.forEach(function(h){h.range.end<=h.range.start||C.push({key:"edit-".concat(h.suggestionId),range:h.range,type:"edit",id:"edit-".concat(h.suggestionId),suggestionId:h.suggestionId})});var ne=(t=u==null?void 0:u.risks)!==null&&t!==void 0?t:[],le=(a=u==null?void 0:u.legalBasis)!==null&&a!==void 0?a:[];ne.forEach(function(h){var c=I(h.highlightRange);if(c){var E=P(c,A);E.forEach(function(R,b){C.push({key:"".concat(h.id,"__").concat(b),range:R,type:"risk",id:h.id,riskLevel:h.level})})}}),le.forEach(function(h){var c=I(h.relatedRange);if(c){var E=P(c,A);E.forEach(function(R,b){C.push({key:"".concat(h.id,"__").concat(b),range:R,type:"legal",id:h.id})})}}),C.sort(function(h,c){return h.range.start!==c.range.start?h.range.start-c.range.start:h.type==="edit"&&c.type!=="edit"?-1:c.type==="edit"&&h.type!=="edit"?1:h.range.end-c.range.end});for(var ue=[],y=0,Oe=function(){var c=C[Ae];if(c.range.start<y||c.range.end>g.length)return 0;if(c.range.start>y&&ue.push((0,e.jsx)("span",{children:g.slice(y,c.range.start)},"mix-text-".concat(Ae))),c.type==="edit"){var E=c.suggestionId;ue.push((0,e.jsx)("mark",{id:"edit-".concat(E),className:"highlight edit ".concat(ee==="edit-".concat(E)?"active":""),onClick:function(){T("edit-".concat(E));var b=E.replace(/^sug-/,""),J=u==null?void 0:u.risks.find(function(Y){return Y.identifier===b});J&&(Ie(J.identifier).then(function(Y){Y&&Te(Y)}),xn(J))},children:g.slice(c.range.start,c.range.end)},"mix-edit-".concat(E)))}else ue.push((0,e.jsx)("mark",{className:"highlight ".concat(c.type," ").concat(c.type==="risk"&&c.riskLevel?"risk-".concat(c.riskLevel):""," ").concat(ee===c.id?"active":""),id:c.id,onClick:function(){return yn(c.type,c.id)},children:g.slice(c.range.start,c.range.end)},c.key));y=c.range.end},bn,Ae=0;Ae<C.length;Ae+=1)bn=Oe();return y<g.length&&ue.push((0,e.jsx)("span",{children:g.slice(y)},"mix-text-end")),(0,e.jsx)("div",{className:"whitespace-pre-wrap",children:ue})},Ct=function(){var i=U()(j()().mark(function t(){var a,n,r,s,o,l;return j()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(a=g,a){v.next=4;break}return N.ZP.warning("\u8BF7\u5148\u7F16\u8F91\u6216\u5E94\u7528\u5EFA\u8BAE"),v.abrupt("return");case 4:return v.prev=4,d(!0),r=new FormData,s=new File([a],"edited-".concat(m||"contract",".txt"),{type:"text/plain"}),r.append("file",s),v.next=11,fetch(Rn,{method:"POST",body:r});case 11:if(o=v.sent,o.ok){v.next=14;break}throw new Error("HTTP ".concat(o.status));case 14:return v.next=16,o.json();case 16:if(l=v.sent,!(l!=null&&l.success&&l!==null&&l!==void 0&&(n=l.data)!==null&&n!==void 0&&n.uuid)){v.next=21;break}return N.ZP.success("\u5DF2\u4E0A\u4F20\u4FEE\u6539\u7248\uFF0C\u5F00\u59CB\u91CD\u65B0\u5206\u6790"),Q.history.push("/contract-analysis?fileId=".concat(l.data.uuid)),v.abrupt("return");case 21:d(!1),N.ZP.error((l==null?void 0:l.message)||"\u4E0A\u4F20\u5931\u8D25"),v.next=30;break;case 25:v.prev=25,v.t0=v.catch(4),console.error(v.t0),d(!1),N.ZP.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 30:case"end":return v.stop()}},t,null,[[4,25]])}));return function(){return i.apply(this,arguments)}}(),Bt=function(){if(!u)return[];var t=u.risks,a=u.suggestions,n=u.legalBasis,r=[];return t.forEach(function(s){r.push({range:s.highlightRange,type:"risk",id:s.id})}),a.forEach(function(s){r.push({range:s.highlightRange,type:"suggestion",id:s.id})}),n.forEach(function(s){r.push({range:s.relatedRange,type:"legal",id:s.id})}),r.sort(function(s,o){return s.range.start-o.range.start}),r},At=function(){var t,a,n,r=new Date,s=Be(),o=nn&&!g,l=new Set(_e),F=l.has("contract"),v=l.has("risks"),I=l.has("suggestions"),O=l.has("legal"),P="\u5408\u540C\u5206\u6790\u7ED3\u679C\uFF08\u5BFC\u51FA\uFF09",A="\u5BFC\u51FA\u65F6\u95F4\uFF1A".concat(Ke(r)).concat(m?" \xB7 \u6587\u4EF6ID\uFF1A".concat(w(m)):""),C=v?((t=u==null?void 0:u.risks)!==null&&t!==void 0?t:[]).map(function(y){var Oe=y.level==="high"?"\u9AD8\u98CE\u9669":y.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669";return`
              <div class="item">
                <div class="item-title">
                  <span class="badge `.concat(w(y.level),'">').concat(Oe,`</span>
                  <span class="item-head">`).concat(w(y.title),`</span>
                </div>
                <div class="item-body">`).concat(w(y.content),`</div>
                `).concat(y.suggestion?'<div class="item-sub"><span class="muted">\u5EFA\u8BAE\uFF1A</span>'.concat(w(y.suggestion),"</div>"):"",`
              </div>
            `)}).join(""):"",ne=I?((a=u==null?void 0:u.suggestions)!==null&&a!==void 0?a:[]).map(function(y){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge info">\u4FEE\u6539\u5EFA\u8BAE</span>
                  <span class="item-head">`.concat(w(y.reason||"\u5EFA\u8BAE"),`</span>
                </div>
                <div class="diff">
                  <div class="diff-row">
                    <div class="diff-label">\u539F\u6587</div>
                    <div class="diff-content original">`).concat(w(y.original),`</div>
                  </div>
                  <div class="diff-row">
                    <div class="diff-label">\u4FEE\u6539\u4E3A</div>
                    <div class="diff-content revised">`).concat(w(y.revised),`</div>
                  </div>
                </div>
              </div>
            `)}).join(""):"",le=O?((n=u==null?void 0:u.legalBasis)!==null&&n!==void 0?n:[]).map(function(y){return`
              <div class="item">
                <div class="item-title">
                  <span class="badge legal">\u6CD5\u5F8B\u4F9D\u636E</span>
                  <span class="item-head">`.concat(w(y.lawName)," ").concat(w(y.article),`</span>
                </div>
                <div class="item-body">`).concat(w(y.content),`</div>
                <div class="item-sub"><span class="muted">\u76F8\u5173\u5EA6\uFF1A</span>`).concat((y.score*100).toFixed(0),`%</div>
              </div>
            `)}).join(""):"",ue=F?o&&u?'<div class="contract-text"><div class="contract-pre">'.concat(Hn(s,Bt()).replace(/\n/g,"<br/>"),"</div></div>"):'<div class="contract-text"><div class="contract-pre">'.concat(w(s).replace(/\n/g,"<br/>"),"</div></div>"):"";return`
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>`.concat(w(P),`</title>
    <style>
      @page { margin: 16mm 14mm; }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
        color: #111827;
        line-height: 1.55;
      }
      .header { margin-bottom: 14px; }
      .title { font-size: 18px; font-weight: 700; margin: 0 0 4px 0; }
      .subtitle { font-size: 12px; color: #6b7280; margin: 0; }
      .section { margin-top: 14px; }
      .section-title { font-size: 13px; font-weight: 700; margin: 0 0 8px 0; }
      .divider { height: 1px; background: #e5e7eb; margin: 10px 0; }
      .item { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px 12px; margin: 10px 0; break-inside: avoid; }
      .item-title { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
      .item-head { font-weight: 700; }
      .item-body { font-size: 12px; color: #111827; }
      .item-sub { font-size: 12px; color: #374151; margin-top: 6px; }
      .muted { color: #6b7280; }
      .badge { display: inline-block; font-size: 11px; padding: 2px 8px; border-radius: 999px; border: 1px solid #e5e7eb; background: #f9fafb; color: #111827; }
      .badge.high { background: #fff1f2; border-color: #fecdd3; color: #9f1239; }
      .badge.medium { background: #fff7ed; border-color: #fed7aa; color: #9a3412; }
      .badge.low { background: #f0fdf4; border-color: #bbf7d0; color: #166534; }
      .badge.info { background: #eff6ff; border-color: #bfdbfe; color: #1d4ed8; }
      .badge.legal { background: #f5f3ff; border-color: #ddd6fe; color: #5b21b6; }
      .diff { margin-top: 6px; }
      .diff-row { display: flex; gap: 10px; margin-top: 6px; }
      .diff-label { width: 52px; font-size: 12px; color: #6b7280; flex: 0 0 auto; }
      .diff-content { font-size: 12px; padding: 8px 10px; border-radius: 6px; border: 1px solid #e5e7eb; width: 100%; }
      .diff-content.original { background: #fff1f2; border-color: #fecdd3; }
      .diff-content.revised { background: #f0fdf4; border-color: #bbf7d0; }
      .contract-text { margin-top: 8px; }
      .contract-pre { font-size: 12px; white-space: normal; word-break: break-word; }
      mark.hl { padding: 0 2px; border-radius: 3px; }
      mark.hl.risk { background: #ffe4e6; }
      mark.hl.suggestion { background: #dbeafe; }
      mark.hl.legal { background: #ede9fe; }
      .print-hint { font-size: 12px; color: #6b7280; margin-top: 10px; }
      .footer { position: fixed; bottom: 0; left: 0; right: 0; font-size: 10px; color: #9ca3af; }
      .footer-inner { display: flex; justify-content: space-between; }
      @media print {
        .no-print { display: none !important; }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="title">`).concat(w(P),`</div>
      <p class="subtitle">`).concat(A,`</p>
      <div class="print-hint no-print">\u63D0\u793A\uFF1A\u5728\u6253\u5370\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002</div>
      <div class="divider"></div>
    </div>

    `).concat(v?'<div class="section"><div class="section-title">\u98CE\u9669\u6458\u8981</div>'.concat(C||'<div class="muted">\u6682\u65E0\u98CE\u9669</div>',"</div>"):"",`
    `).concat(I?'<div class="section"><div class="section-title">\u4FEE\u6539\u5EFA\u8BAE</div>'.concat(ne||'<div class="muted">\u6682\u65E0\u4FEE\u6539\u5EFA\u8BAE</div>',"</div>"):"",`
    `).concat(O?'<div class="section"><div class="section-title">\u6CD5\u5F8B\u4F9D\u636E</div>'.concat(le||'<div class="muted">\u6682\u65E0\u6CD5\u5F8B\u4F9D\u636E</div>',"</div>"):"",`
    `).concat(F?'<div class="section"><div class="section-title">\u5408\u540C\u6B63\u6587</div>'.concat(ue||'<div class="muted">\u6682\u65E0\u6B63\u6587</div>',"</div>"):"",`

    <div class="footer">
      <div class="footer-inner">
        <span>LegalRag</span>
        <span>`).concat(Ke(r),`</span>
      </div>
    </div>
    <script>
      // \u5C3D\u91CF\u81EA\u52A8\u89E6\u53D1\u6253\u5370\uFF08\u7528\u6237\u4ECD\u53EF\u53D6\u6D88\uFF09
      window.addEventListener('load', () => {
        setTimeout(() => window.print(), 250);
      });
    <\/script>
  </body>
</html>
    `).trim()},St=function(){var t,a=Be();if(!a){N.ZP.error("\u6682\u65E0\u53EF\u5BFC\u51FA\u7684\u5408\u540C\u6587\u672C");return}var n=At(),r=document.createElement("iframe");r.style.position="fixed",r.style.right="0",r.style.bottom="0",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);var s=r.contentDocument||((t=r.contentWindow)===null||t===void 0?void 0:t.document);if(!s){N.ZP.error("\u65E0\u6CD5\u521B\u5EFA\u6253\u5370\u6587\u6863"),document.body.removeChild(r);return}s.open(),s.write(n),s.close(),r.onload=function(){setTimeout(function(){try{var o,l;(o=r.contentWindow)===null||o===void 0||o.focus(),(l=r.contentWindow)===null||l===void 0||l.print()}catch(F){console.error("Print error:",F),N.ZP.error("\u6253\u5370\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}setTimeout(function(){document.body.removeChild(r)},1e3)},100)},setTimeout(function(){if(document.body.contains(r)){try{var o,l;(o=r.contentWindow)===null||o===void 0||o.focus(),(l=r.contentWindow)===null||l===void 0||l.print()}catch(F){}setTimeout(function(){document.body.contains(r)&&document.body.removeChild(r)},1e3)}},500)},Nt=function(){if(!be)return null;if(pe==="risk"){var t,a,n=be,r=(t=n.legalBasis)!==null&&t!==void 0?t:[],s=r.length>0,o="sug-".concat(n.identifier),l=u==null||(a=u.suggestions)===null||a===void 0?void 0:a.find(function(A){return A.id===o}),F=(D==null?void 0:D.identifier)===n.identifier&&D!==null&&D!==void 0&&D.suggested_revision?{id:o,original:function(){var A=Me(),C=n.highlightRange||{start:0,end:0},ne=C.start,le=C.end;return A&&ne>=0&&le>ne&&le<=A.length?A.slice(ne,le):""}(),revised:D.suggested_revision,reason:"\u9488\u5BF9\u98CE\u9669\uFF1A".concat(n.title),highlightRange:n.highlightRange}:null,v=F!=null?F:l,I=v?bt(v.id):"undecided";return(0,e.jsxs)("div",{className:"detail-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(Ue.Z,{color:n.level==="high"?"red":n.level==="medium"?"orange":"green",children:n.level==="high"?"\u9AD8\u98CE\u9669":n.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u98CE\u9669\u63CF\u8FF0"}),(0,e.jsx)("div",{className:"section-content",children:n.content})]}),n.suggestion&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u5EFA\u8BAE\u63AA\u65BD"}),(0,e.jsx)("div",{className:"section-content",children:n.suggestion})]}),v?(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u5177\u4F53\u4FEE\u6539\u65B9\u6848"}),(0,e.jsxs)("div",{className:"diff-display",style:{marginBottom:10},children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original",children:v.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised",children:v.revised})]})]}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:(0,e.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,e.jsx)(K.ZP,{size:"middle",className:I==="accepted"?"!h-9 !rounded-lg !bg-brand-600 hover:!bg-brand-700 !text-white !border-brand-600":"!h-9 !rounded-lg !bg-white hover:!bg-slate-50 !text-slate-700 !border-slate-200",onClick:function(){Le(v.id,I==="accepted"?"undecided":"accepted")},children:"\u91C7\u7EB3"}),(0,e.jsx)(K.ZP,{size:"middle",className:I==="rejected"?"!h-9 !rounded-lg !bg-slate-800 hover:!bg-slate-900 !text-white !border-slate-800":"!h-9 !rounded-lg !bg-white hover:!bg-slate-50 !text-slate-700 !border-slate-200",onClick:function(){Le(v.id,I==="rejected"?"undecided":"rejected")},children:"\u4E0D\u91C7\u7EB3"}),(0,e.jsx)(K.ZP,{size:"middle",className:"!h-9 !rounded-lg",onClick:function(){Le(v.id,"undecided")},children:"\u6E05\u9664\u9009\u62E9"})]})})]}):null,s&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content",children:r.map(function(A){return(0,e.jsxs)("div",{style:{marginBottom:8},children:[(0,e.jsxs)("div",{style:{fontWeight:600},children:[A.lawName," ",A.article]}),(0,e.jsx)("div",{style:{margin:"6px 0",fontSize:12,color:"#666"},children:A.content}),(0,e.jsxs)("div",{className:"legal-score",children:[(0,e.jsx)(De.Z,{disabled:!0,allowHalf:!0,value:A.score*5,style:{fontSize:12}}),(0,e.jsxs)("span",{style:{marginLeft:8,fontSize:12},children:["\u76F8\u5173\u5EA6: ",(A.score*100).toFixed(0),"%"]})]})]},A.id)})})]})]})}if(pe==="suggestion"){var O=be;return(0,e.jsxs)("div",{className:"detail-modal",children:[(0,e.jsxs)("div",{className:"diff-display",children:[(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u539F\u6587"}),(0,e.jsx)("div",{className:"diff-content original",children:O.original})]}),(0,e.jsxs)("div",{className:"diff-row",children:[(0,e.jsx)("div",{className:"diff-label",children:"\u4FEE\u6539\u4E3A"}),(0,e.jsx)("div",{className:"diff-content revised",children:O.revised})]})]}),O.reason&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u4FEE\u6539\u7406\u7531"}),(0,e.jsx)("div",{className:"section-content",children:O.reason})]})]})}if(pe==="legal"){var P=be;return(0,e.jsxs)("div",{className:"detail-modal",children:[(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u6CD5\u5F8B\u540D\u79F0"}),(0,e.jsx)("div",{className:"section-content",children:P.lawName})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u6761\u6B3E"}),(0,e.jsx)("div",{className:"section-content",children:P.article})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u6CD5\u6761\u5185\u5BB9"}),(0,e.jsx)("div",{className:"section-content",children:P.content})]}),(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u76F8\u5173\u5EA6\u8BC4\u5206"}),(0,e.jsxs)("div",{className:"legal-score",children:[(0,e.jsx)(De.Z,{disabled:!0,allowHalf:!0,value:P.score*5}),(0,e.jsxs)("span",{style:{marginLeft:8},children:[(P.score*100).toFixed(0),"%"]})]})]}),P.explanation&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-label",children:"\u9002\u7528\u8BF4\u660E"}),(0,e.jsx)("div",{className:"section-content",children:P.explanation})]})]})}},Dt=function(){return pe==="risk"?"\u98CE\u9669\u8BE6\u60C5":pe==="suggestion"?"\u4FEE\u6539\u5EFA\u8BAE\u8BE6\u60C5":"\u6CD5\u5F8B\u4F9D\u636E\u8BE6\u60C5"};return k?(0,e.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white flex items-center justify-center px-4",children:(0,e.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white border border-slate-100 shadow-xl px-8 py-10 text-center space-y-4",children:[(0,e.jsx)("div",{className:"bg-gradient-to-r from-brand-600 to-blue-500 inline-flex items-center justify-center rounded-full px-4 py-1 text-xs font-medium text-white",children:re==="analyzing"?"\u5408\u540C\u667A\u80FD\u5206\u6790\u8FDB\u884C\u4E2D\u2026":"\u6B63\u5728\u51C6\u5907\u5206\u6790..."}),(0,e.jsx)("p",{className:"text-sm text-slate-500",children:"\u6211\u4EEC\u6B63\u5728\u4E3A\u60A8\u89E3\u6790\u5408\u540C\u6761\u6B3E\u5E76\u751F\u6210\u98CE\u9669\u63D0\u793A\u3001\u4FEE\u6539\u610F\u89C1\u4E0E\u6CD5\u5F8B\u4F9D\u636E\uFF0C\u8BF7\u7A0D\u5019\u3002"}),(0,e.jsx)("div",{className:"flex justify-center pt-2",children:(0,e.jsx)(kn.Z,{size:"large",tip:re==="analyzing"?"\u6B63\u5728\u5206\u6790\u5408\u540C...":"\u6B63\u5728\u52A0\u8F7D..."})})]})}):(0,e.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white px-4 py-6",children:(0,e.jsxs)("div",{className:"mx-auto max-w-7xl rounded-2xl bg-white border border-slate-100 shadow-xl overflow-hidden",children:[(0,e.jsxs)("div",{className:"bg-gradient-to-r from-brand-600 to-blue-500 px-6 py-4 flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-xs font-semibold tracking-wide text-brand-50/80 uppercase",children:"LegalRag"}),(0,e.jsx)("p",{className:"text-sm text-brand-50",children:"\u5408\u540C\u5206\u6790\u7ED3\u679C"})]}),(0,e.jsx)("span",{className:"rounded-full border border-white/30 bg-white/10 px-3 py-1 text-xs text-brand-50",children:"\u98CE\u9669\u63D0\u793A \xB7 \u4FEE\u6539\u610F\u89C1 \xB7 \u6CD5\u5F8B\u4F9D\u636E"})]}),(0,e.jsx)("div",{className:"contract-analysis px-4 pb-4 pt-2",children:(0,e.jsxs)(wn._z,{header:{title:"\u5408\u540C\u5206\u6790\u7ED3\u679C",onBack:gt,extra:[(0,e.jsx)(K.ZP,{type:"default",style:{background:"#ffffff",borderColor:"#d9d9d9",color:"#1677ff",fontWeight:600},onClick:function(){return ze(!0)},children:"\u5BFC\u51FA PDF"},"exportPdf"),(0,e.jsx)(K.ZP,{onClick:ht,children:"\u91CD\u65B0\u5206\u6790"},"reanalyze")]},children:[u&&(0,e.jsx)("div",{className:"analysis-content",children:(0,e.jsxs)("div",{className:"split-grid",ref:on,style:We()({},"--left-pane","".concat(He,"%")),children:[(0,e.jsx)("div",{className:"split-left",children:(0,e.jsx)(fe.Z,{title:"\u5408\u540C\u6587\u672C",bordered:!1,extra:(0,e.jsxs)(Ve.Z,{children:[je?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(K.ZP,{size:"small",type:"primary",onClick:Et,children:"\u5B8C\u6210"}),(0,e.jsx)(K.ZP,{size:"small",onClick:En,children:"\u64A4\u9500"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(K.ZP,{size:"small",onClick:yt,children:"\u7F16\u8F91"}),g?(0,e.jsx)(K.ZP,{size:"small",onClick:En,children:"\u64A4\u9500\u4FEE\u6539\u7248"}):null]}),g&&!je?(0,e.jsx)(K.ZP,{size:"small",onClick:Ct,children:"\u7528\u4FEE\u6539\u7248\u91CD\u65B0\u5206\u6790"}):null]}),children:(0,e.jsx)("div",{className:"contract-text-panel",ref:st,children:je?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-xs text-slate-500",children:"\u63D0\u793A\uFF1A\u7F16\u8F91/\u5E94\u7528\u5EFA\u8BAE\u540E\uFF0C\u672C\u9875\u9AD8\u4EAE\u5B9A\u4F4D\u5C06\u4E0D\u518D\u51C6\u786E\u3002"}),(0,e.jsx)(Pn.Z.TextArea,{value:g!=null?g:Be(),onChange:function(t){return ve(t.target.value)},autoSize:{minRows:18,maxRows:28}})]}):g?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-xs text-slate-500",children:"\u5DF2\u751F\u6210\u4FEE\u6539\u7248\u6B63\u6587\uFF08\u7EFF\u8272\u9AD8\u4EAE\u4E3A\u5DF2\u91C7\u7EB3\u7684\u4FEE\u6539\u5185\u5BB9\uFF09\u3002"}),Ft()]}):xt()})})}),(0,e.jsx)("div",{className:"split-resizer",role:"separator","aria-orientation":"vertical","aria-label":"\u8C03\u6574\u5408\u540C\u6587\u672C\u533A\u57DF\u5BBD\u5EA6",onPointerDown:it,onPointerMove:lt,onPointerUp:gn,onPointerCancel:gn}),(0,e.jsx)("div",{className:"split-right",children:(0,e.jsx)("div",{className:"analysis-panel",children:(0,e.jsx)(fe.Z,{title:"\u98CE\u9669\u8BE6\u60C5",bordered:!1,style:{marginBottom:16},bodyStyle:{padding:"20px"},children:D?(0,e.jsxs)("div",{className:"detail-container",children:[(0,e.jsxs)("div",{className:"modal-section",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,e.jsx)("span",{style:{fontSize:16,fontWeight:600},children:"\u98CE\u9669\u7B49\u7EA7"}),(0,e.jsx)(Ue.Z,{color:D.level==="high"?"#f5222d":D.level==="medium"?"#fa8c16":"#52c41a",style:{padding:"4px 16px",fontSize:14,borderRadius:12,marginRight:0},children:D.level==="high"?"\u9AD8\u98CE\u9669":D.level==="medium"?"\u4E2D\u98CE\u9669":"\u4F4E\u98CE\u9669"})]}),(0,e.jsx)(fe.Z,{type:"inner",title:(0,e.jsx)("span",{style:{color:"#cf1322"},children:"\u{1F6A8} \u98CE\u9669\u63CF\u8FF0"}),size:"small",style:{marginBottom:16,backgroundColor:"#fff1f0",borderColor:"#ffa39e"},children:(0,e.jsx)("div",{style:{lineHeight:"1.6",color:"#333"},children:D.detected_issue})}),D.suggestions&&(0,e.jsx)(fe.Z,{type:"inner",title:(0,e.jsx)("span",{style:{color:"#d48806"},children:"\u{1F4A1} \u5EFA\u8BAE\u63AA\u65BD"}),size:"small",style:{marginBottom:16,backgroundColor:"#feffe6",borderColor:"#fffb8f"},children:(0,e.jsx)("div",{style:{lineHeight:"1.6",color:"#333"},children:D.suggestions})}),D.legal_basis&&D.legal_basis.length>0&&(0,e.jsxs)("div",{className:"modal-section",children:[(0,e.jsx)("div",{className:"section-title",style:{fontSize:15,fontWeight:600,marginBottom:12,marginTop:24},children:"\u2696\uFE0F \u76F8\u5173\u6CD5\u5F8B\u4F9D\u636E"}),(0,e.jsx)("div",{className:"section-content",children:D.legal_basis.map(function(i,t){return(0,e.jsxs)(fe.Z,{size:"small",hoverable:!0,className:"legal-card",style:{marginBottom:12,borderRadius:6,borderLeft:"4px solid #1890ff"},children:[(0,e.jsxs)("div",{style:{fontWeight:600,color:"#262626",marginBottom:4},children:[i.law_name," ",i.order]}),(0,e.jsx)("div",{style:{fontSize:13,color:"#666",marginBottom:8,lineHeight:"1.5"},children:i.content}),(0,e.jsxs)("div",{className:"legal-score",style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(De.Z,{disabled:!0,allowHalf:!0,value:(i.relevance_score||0)*5,style:{fontSize:12}}),(0,e.jsxs)("span",{style:{marginLeft:8,fontSize:12,color:"#8c8c8c"},children:["\u76F8\u5173\u5EA6:"," ",((i.relevance_score||0)*100).toFixed(0),"%"]})]})]},t)})})]})]}):(0,e.jsxs)("div",{className:"text-gray-400 text-center py-12",children:[(0,e.jsx)("div",{style:{fontSize:40,marginBottom:16},children:"\u{1F4CB}"}),(0,e.jsx)("div",{children:"\u6682\u65E0\u98CE\u9669\u8BE6\u60C5"}),(0,e.jsx)("div",{style:{fontSize:12,marginTop:8},children:"\u70B9\u51FB\u5DE6\u4FA7\u5408\u540C\u5185\u5BB9\u7684\u6807\u8BB0\u5904\u67E5\u770B"})]})})})})]})}),(0,e.jsx)(Ye.Z,{title:Dt(),open:we,onCancel:function(){return Ee(!1)},footer:null,width:700,children:Nt()}),(0,e.jsxs)(Ye.Z,{title:"\u5BFC\u51FA PDF",open:Un,onCancel:function(){return ze(!1)},okText:"\u5F00\u59CB\u5BFC\u51FA",cancelText:"\u53D6\u6D88",okButtonProps:{style:{backgroundColor:"#fff",color:"#1677ff",border:"1px solid #d9d9d9"}},onOk:function(){ze(!1),St()},children:[(0,e.jsx)(zn.Z.Paragraph,{style:{marginBottom:10,color:"#6b7280"},children:"\u70B9\u51FB\u201C\u5F00\u59CB\u5BFC\u51FA\u201D\u540E\u5C06\u81EA\u52A8\u5F39\u51FA\u6253\u5370\u5BF9\u8BDD\u6846\uFF0C\u5728\u5BF9\u8BDD\u6846\u4E2D\u9009\u62E9\u201C\u4FDD\u5B58\u4E3A PDF\u201D\u5373\u53EF\u5BFC\u51FA\u3002"}),(0,e.jsx)(Tn.Z,{style:{margin:"12px 0"}}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsx)("div",{style:{fontWeight:600,marginBottom:8},children:"\u5BFC\u51FA\u5185\u5BB9"}),(0,e.jsx)(he.Z.Group,{value:_e,onChange:function(t){var a=t;a.includes("contract")||a.push("contract"),Yn(Array.from(new Set(a)))},children:(0,e.jsxs)(Ve.Z,{wrap:!0,children:[(0,e.jsx)(he.Z,{value:"contract",children:"\u5408\u540C\u6B63\u6587"}),(0,e.jsx)(he.Z,{value:"risks",children:"\u98CE\u9669\u6458\u8981"}),(0,e.jsx)(he.Z,{value:"suggestions",children:"\u4FEE\u6539\u5EFA\u8BAE"}),(0,e.jsx)(he.Z,{value:"legal",children:"\u6CD5\u5F8B\u4F9D\u636E"})]})})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,e.jsx)("div",{style:{fontWeight:600},children:"\u6B63\u6587\u5305\u542B\u9AD8\u4EAE"}),(0,e.jsx)(Zn.Z,{checked:g?!1:nn,disabled:!!g,onChange:Xn}),(0,e.jsx)("span",{style:{color:"#6b7280",fontSize:12},children:g?"\u5DF2\u4FEE\u6539\u6B63\u6587\uFF1A\u9AD8\u4EAE\u4F1A\u56E0\u4F4D\u7F6E\u504F\u79FB\u800C\u5931\u6548":"\u98CE\u9669/\u5EFA\u8BAE/\u6CD5\u6761\u4F1A\u4EE5\u4E0D\u540C\u5E95\u8272\u6807\u8BB0"})]})]})]})})]})})},On=Ln}}]);
